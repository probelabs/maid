var fI=Object.create;var gd=Object.defineProperty;var dI=Object.getOwnPropertyDescriptor;var pI=Object.getOwnPropertyNames;var mI=Object.getPrototypeOf,gI=Object.prototype.hasOwnProperty;var bn=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var d=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var xI=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of pI(e))!gI.call(t,i)&&i!==r&&gd(t,i,{get:()=>e[i],enumerable:!(n=dI(e,i))||n.enumerable});return t};var EI=(t,e,r)=>(r=t!=null?fI(mI(t)):{},xI(e||!t||!t.__esModule?gd(r,"default",{value:t,enumerable:!0}):r,t));var Xx=d((sfe,Yx)=>{function A1(){this.__data__=[],this.size=0}Yx.exports=A1});var dn=d((afe,Qx)=>{function L1(t,e){return t===e||t!==t&&e!==e}Qx.exports=L1});var So=d((lfe,Zx)=>{var b1=dn();function v1(t,e){for(var r=t.length;r--;)if(b1(t[r][0],e))return r;return-1}Zx.exports=v1});var eE=d((cfe,Jx)=>{var N1=So(),C1=Array.prototype,I1=C1.splice;function R1(t){var e=this.__data__,r=N1(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():I1.call(e,r,1),--this.size,!0}Jx.exports=R1});var rE=d((ufe,tE)=>{var w1=So();function k1(t){var e=this.__data__,r=w1(e,t);return r<0?void 0:e[r][1]}tE.exports=k1});var iE=d((hfe,nE)=>{var _1=So();function M1(t){return _1(this.__data__,t)>-1}nE.exports=M1});var sE=d((ffe,oE)=>{var U1=So();function P1(t,e){var r=this.__data__,n=U1(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}oE.exports=P1});var Oo=d((dfe,aE)=>{var q1=Xx(),D1=eE(),F1=rE(),B1=iE(),$1=sE();function pi(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}pi.prototype.clear=q1;pi.prototype.delete=D1;pi.prototype.get=F1;pi.prototype.has=B1;pi.prototype.set=$1;aE.exports=pi});var cE=d((pfe,lE)=>{var K1=Oo();function G1(){this.__data__=new K1,this.size=0}lE.exports=G1});var hE=d((mfe,uE)=>{function j1(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}uE.exports=j1});var dE=d((gfe,fE)=>{function W1(t){return this.__data__.get(t)}fE.exports=W1});var mE=d((xfe,pE)=>{function H1(t){return this.__data__.has(t)}pE.exports=H1});var Lh=d((Efe,gE)=>{var z1=typeof global=="object"&&global&&global.Object===Object&&global;gE.exports=z1});var Rt=d((yfe,xE)=>{var V1=Lh(),Y1=typeof self=="object"&&self&&self.Object===Object&&self,X1=V1||Y1||Function("return this")();xE.exports=X1});var pn=d((Tfe,EE)=>{var Q1=Rt(),Z1=Q1.Symbol;EE.exports=Z1});var OE=d((Sfe,SE)=>{var yE=pn(),TE=Object.prototype,J1=TE.hasOwnProperty,eq=TE.toString,Ao=yE?yE.toStringTag:void 0;function tq(t){var e=J1.call(t,Ao),r=t[Ao];try{t[Ao]=void 0;var n=!0}catch{}var i=eq.call(t);return n&&(e?t[Ao]=r:delete t[Ao]),i}SE.exports=tq});var LE=d((Ofe,AE)=>{var rq=Object.prototype,nq=rq.toString;function iq(t){return nq.call(t)}AE.exports=iq});var Wr=d((Afe,NE)=>{var bE=pn(),oq=OE(),sq=LE(),aq="[object Null]",lq="[object Undefined]",vE=bE?bE.toStringTag:void 0;function cq(t){return t==null?t===void 0?lq:aq:vE&&vE in Object(t)?oq(t):sq(t)}NE.exports=cq});var yt=d((Lfe,CE)=>{function uq(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}CE.exports=uq});var mi=d((bfe,IE)=>{var hq=Wr(),fq=yt(),dq="[object AsyncFunction]",pq="[object Function]",mq="[object GeneratorFunction]",gq="[object Proxy]";function xq(t){if(!fq(t))return!1;var e=hq(t);return e==pq||e==mq||e==dq||e==gq}IE.exports=xq});var wE=d((vfe,RE)=>{var Eq=Rt(),yq=Eq["__core-js_shared__"];RE.exports=yq});var ME=d((Nfe,_E)=>{var bh=wE(),kE=(function(){var t=/[^.]+$/.exec(bh&&bh.keys&&bh.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function Tq(t){return!!kE&&kE in t}_E.exports=Tq});var vh=d((Cfe,UE)=>{var Sq=Function.prototype,Oq=Sq.toString;function Aq(t){if(t!=null){try{return Oq.call(t)}catch{}try{return t+""}catch{}}return""}UE.exports=Aq});var qE=d((Ife,PE)=>{var Lq=mi(),bq=ME(),vq=yt(),Nq=vh(),Cq=/[\\^$.*+?()[\]{}|]/g,Iq=/^\[object .+?Constructor\]$/,Rq=Function.prototype,wq=Object.prototype,kq=Rq.toString,_q=wq.hasOwnProperty,Mq=RegExp("^"+kq.call(_q).replace(Cq,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Uq(t){if(!vq(t)||bq(t))return!1;var e=Lq(t)?Mq:Iq;return e.test(Nq(t))}PE.exports=Uq});var FE=d((Rfe,DE)=>{function Pq(t,e){return t?.[e]}DE.exports=Pq});var Hr=d((wfe,BE)=>{var qq=qE(),Dq=FE();function Fq(t,e){var r=Dq(t,e);return qq(r)?r:void 0}BE.exports=Fq});var hl=d((kfe,$E)=>{var Bq=Hr(),$q=Rt(),Kq=Bq($q,"Map");$E.exports=Kq});var Lo=d((_fe,KE)=>{var Gq=Hr(),jq=Gq(Object,"create");KE.exports=jq});var WE=d((Mfe,jE)=>{var GE=Lo();function Wq(){this.__data__=GE?GE(null):{},this.size=0}jE.exports=Wq});var zE=d((Ufe,HE)=>{function Hq(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}HE.exports=Hq});var YE=d((Pfe,VE)=>{var zq=Lo(),Vq="__lodash_hash_undefined__",Yq=Object.prototype,Xq=Yq.hasOwnProperty;function Qq(t){var e=this.__data__;if(zq){var r=e[t];return r===Vq?void 0:r}return Xq.call(e,t)?e[t]:void 0}VE.exports=Qq});var QE=d((qfe,XE)=>{var Zq=Lo(),Jq=Object.prototype,eD=Jq.hasOwnProperty;function tD(t){var e=this.__data__;return Zq?e[t]!==void 0:eD.call(e,t)}XE.exports=tD});var JE=d((Dfe,ZE)=>{var rD=Lo(),nD="__lodash_hash_undefined__";function iD(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=rD&&e===void 0?nD:e,this}ZE.exports=iD});var ty=d((Ffe,ey)=>{var oD=WE(),sD=zE(),aD=YE(),lD=QE(),cD=JE();function gi(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}gi.prototype.clear=oD;gi.prototype.delete=sD;gi.prototype.get=aD;gi.prototype.has=lD;gi.prototype.set=cD;ey.exports=gi});var iy=d((Bfe,ny)=>{var ry=ty(),uD=Oo(),hD=hl();function fD(){this.size=0,this.__data__={hash:new ry,map:new(hD||uD),string:new ry}}ny.exports=fD});var sy=d(($fe,oy)=>{function dD(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}oy.exports=dD});var bo=d((Kfe,ay)=>{var pD=sy();function mD(t,e){var r=t.__data__;return pD(e)?r[typeof e=="string"?"string":"hash"]:r.map}ay.exports=mD});var cy=d((Gfe,ly)=>{var gD=bo();function xD(t){var e=gD(this,t).delete(t);return this.size-=e?1:0,e}ly.exports=xD});var hy=d((jfe,uy)=>{var ED=bo();function yD(t){return ED(this,t).get(t)}uy.exports=yD});var dy=d((Wfe,fy)=>{var TD=bo();function SD(t){return TD(this,t).has(t)}fy.exports=SD});var my=d((Hfe,py)=>{var OD=bo();function AD(t,e){var r=OD(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}py.exports=AD});var fl=d((zfe,gy)=>{var LD=iy(),bD=cy(),vD=hy(),ND=dy(),CD=my();function xi(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}xi.prototype.clear=LD;xi.prototype.delete=bD;xi.prototype.get=vD;xi.prototype.has=ND;xi.prototype.set=CD;gy.exports=xi});var Ey=d((Vfe,xy)=>{var ID=Oo(),RD=hl(),wD=fl(),kD=200;function _D(t,e){var r=this.__data__;if(r instanceof ID){var n=r.__data__;if(!RD||n.length<kD-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new wD(n)}return r.set(t,e),this.size=r.size,this}xy.exports=_D});var vo=d((Yfe,yy)=>{var MD=Oo(),UD=cE(),PD=hE(),qD=dE(),DD=mE(),FD=Ey();function Ei(t){var e=this.__data__=new MD(t);this.size=e.size}Ei.prototype.clear=UD;Ei.prototype.delete=PD;Ei.prototype.get=qD;Ei.prototype.has=DD;Ei.prototype.set=FD;yy.exports=Ei});var dl=d((Xfe,Ty)=>{function BD(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}Ty.exports=BD});var Nh=d((Qfe,Sy)=>{var $D=Hr(),KD=(function(){try{var t=$D(Object,"defineProperty");return t({},"",{}),t}catch{}})();Sy.exports=KD});var No=d((Zfe,Ay)=>{var Oy=Nh();function GD(t,e,r){e=="__proto__"&&Oy?Oy(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}Ay.exports=GD});var Co=d((Jfe,Ly)=>{var jD=No(),WD=dn(),HD=Object.prototype,zD=HD.hasOwnProperty;function VD(t,e,r){var n=t[e];(!(zD.call(t,e)&&WD(n,r))||r===void 0&&!(e in t))&&jD(t,e,r)}Ly.exports=VD});var yi=d((ede,by)=>{var YD=Co(),XD=No();function QD(t,e,r,n){var i=!r;r||(r={});for(var o=-1,s=e.length;++o<s;){var a=e[o],c=n?n(r[a],t[a],a,r,t):void 0;c===void 0&&(c=t[a]),i?XD(r,a,c):YD(r,a,c)}return r}by.exports=QD});var Ny=d((tde,vy)=>{function ZD(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}vy.exports=ZD});var Dt=d((rde,Cy)=>{function JD(t){return t!=null&&typeof t=="object"}Cy.exports=JD});var Ry=d((nde,Iy)=>{var eF=Wr(),tF=Dt(),rF="[object Arguments]";function nF(t){return tF(t)&&eF(t)==rF}Iy.exports=nF});var Ti=d((ide,_y)=>{var wy=Ry(),iF=Dt(),ky=Object.prototype,oF=ky.hasOwnProperty,sF=ky.propertyIsEnumerable,aF=wy((function(){return arguments})())?wy:function(t){return iF(t)&&oF.call(t,"callee")&&!sF.call(t,"callee")};_y.exports=aF});var Me=d((ode,My)=>{var lF=Array.isArray;My.exports=lF});var Py=d((sde,Uy)=>{function cF(){return!1}Uy.exports=cF});var mn=d((Io,Si)=>{var uF=Rt(),hF=Py(),Fy=typeof Io=="object"&&Io&&!Io.nodeType&&Io,qy=Fy&&typeof Si=="object"&&Si&&!Si.nodeType&&Si,fF=qy&&qy.exports===Fy,Dy=fF?uF.Buffer:void 0,dF=Dy?Dy.isBuffer:void 0,pF=dF||hF;Si.exports=pF});var Ro=d((ade,By)=>{var mF=9007199254740991,gF=/^(?:0|[1-9]\d*)$/;function xF(t,e){var r=typeof t;return e=e??mF,!!e&&(r=="number"||r!="symbol"&&gF.test(t))&&t>-1&&t%1==0&&t<e}By.exports=xF});var pl=d((lde,$y)=>{var EF=9007199254740991;function yF(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=EF}$y.exports=yF});var Gy=d((cde,Ky)=>{var TF=Wr(),SF=pl(),OF=Dt(),AF="[object Arguments]",LF="[object Array]",bF="[object Boolean]",vF="[object Date]",NF="[object Error]",CF="[object Function]",IF="[object Map]",RF="[object Number]",wF="[object Object]",kF="[object RegExp]",_F="[object Set]",MF="[object String]",UF="[object WeakMap]",PF="[object ArrayBuffer]",qF="[object DataView]",DF="[object Float32Array]",FF="[object Float64Array]",BF="[object Int8Array]",$F="[object Int16Array]",KF="[object Int32Array]",GF="[object Uint8Array]",jF="[object Uint8ClampedArray]",WF="[object Uint16Array]",HF="[object Uint32Array]",pe={};pe[DF]=pe[FF]=pe[BF]=pe[$F]=pe[KF]=pe[GF]=pe[jF]=pe[WF]=pe[HF]=!0;pe[AF]=pe[LF]=pe[PF]=pe[bF]=pe[qF]=pe[vF]=pe[NF]=pe[CF]=pe[IF]=pe[RF]=pe[wF]=pe[kF]=pe[_F]=pe[MF]=pe[UF]=!1;function zF(t){return OF(t)&&SF(t.length)&&!!pe[TF(t)]}Ky.exports=zF});var wo=d((ude,jy)=>{function VF(t){return function(e){return t(e)}}jy.exports=VF});var ml=d((ko,Oi)=>{var YF=Lh(),Wy=typeof ko=="object"&&ko&&!ko.nodeType&&ko,_o=Wy&&typeof Oi=="object"&&Oi&&!Oi.nodeType&&Oi,XF=_o&&_o.exports===Wy,Ch=XF&&YF.process,QF=(function(){try{var t=_o&&_o.require&&_o.require("util").types;return t||Ch&&Ch.binding&&Ch.binding("util")}catch{}})();Oi.exports=QF});var Ai=d((hde,Vy)=>{var ZF=Gy(),JF=wo(),Hy=ml(),zy=Hy&&Hy.isTypedArray,eB=zy?JF(zy):ZF;Vy.exports=eB});var Ih=d((fde,Yy)=>{var tB=Ny(),rB=Ti(),nB=Me(),iB=mn(),oB=Ro(),sB=Ai(),aB=Object.prototype,lB=aB.hasOwnProperty;function cB(t,e){var r=nB(t),n=!r&&rB(t),i=!r&&!n&&iB(t),o=!r&&!n&&!i&&sB(t),s=r||n||i||o,a=s?tB(t.length,String):[],c=a.length;for(var l in t)(e||lB.call(t,l))&&!(s&&(l=="length"||i&&(l=="offset"||l=="parent")||o&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||oB(l,c)))&&a.push(l);return a}Yy.exports=cB});var Mo=d((dde,Xy)=>{var uB=Object.prototype;function hB(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||uB;return t===r}Xy.exports=hB});var Rh=d((pde,Qy)=>{function fB(t,e){return function(r){return t(e(r))}}Qy.exports=fB});var Jy=d((mde,Zy)=>{var dB=Rh(),pB=dB(Object.keys,Object);Zy.exports=pB});var gl=d((gde,eT)=>{var mB=Mo(),gB=Jy(),xB=Object.prototype,EB=xB.hasOwnProperty;function yB(t){if(!mB(t))return gB(t);var e=[];for(var r in Object(t))EB.call(t,r)&&r!="constructor"&&e.push(r);return e}eT.exports=yB});var nr=d((xde,tT)=>{var TB=mi(),SB=pl();function OB(t){return t!=null&&SB(t.length)&&!TB(t)}tT.exports=OB});var gr=d((Ede,rT)=>{var AB=Ih(),LB=gl(),bB=nr();function vB(t){return bB(t)?AB(t):LB(t)}rT.exports=vB});var iT=d((yde,nT)=>{var NB=yi(),CB=gr();function IB(t,e){return t&&NB(e,CB(e),t)}nT.exports=IB});var sT=d((Tde,oT)=>{function RB(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}oT.exports=RB});var lT=d((Sde,aT)=>{var wB=yt(),kB=Mo(),_B=sT(),MB=Object.prototype,UB=MB.hasOwnProperty;function PB(t){if(!wB(t))return _B(t);var e=kB(t),r=[];for(var n in t)n=="constructor"&&(e||!UB.call(t,n))||r.push(n);return r}aT.exports=PB});var zr=d((Ode,cT)=>{var qB=Ih(),DB=lT(),FB=nr();function BB(t){return FB(t)?qB(t,!0):DB(t)}cT.exports=BB});var hT=d((Ade,uT)=>{var $B=yi(),KB=zr();function GB(t,e){return t&&$B(e,KB(e),t)}uT.exports=GB});var wh=d((Uo,Li)=>{var jB=Rt(),mT=typeof Uo=="object"&&Uo&&!Uo.nodeType&&Uo,fT=mT&&typeof Li=="object"&&Li&&!Li.nodeType&&Li,WB=fT&&fT.exports===mT,dT=WB?jB.Buffer:void 0,pT=dT?dT.allocUnsafe:void 0;function HB(t,e){if(e)return t.slice();var r=t.length,n=pT?pT(r):new t.constructor(r);return t.copy(n),n}Li.exports=HB});var kh=d((Lde,gT)=>{function zB(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}gT.exports=zB});var _h=d((bde,xT)=>{function VB(t,e){for(var r=-1,n=t==null?0:t.length,i=0,o=[];++r<n;){var s=t[r];e(s,r,t)&&(o[i++]=s)}return o}xT.exports=VB});var Mh=d((vde,ET)=>{function YB(){return[]}ET.exports=YB});var xl=d((Nde,TT)=>{var XB=_h(),QB=Mh(),ZB=Object.prototype,JB=ZB.propertyIsEnumerable,yT=Object.getOwnPropertySymbols,e2=yT?function(t){return t==null?[]:(t=Object(t),XB(yT(t),function(e){return JB.call(t,e)}))}:QB;TT.exports=e2});var OT=d((Cde,ST)=>{var t2=yi(),r2=xl();function n2(t,e){return t2(t,r2(t),e)}ST.exports=n2});var El=d((Ide,AT)=>{function i2(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}AT.exports=i2});var Po=d((Rde,LT)=>{var o2=Rh(),s2=o2(Object.getPrototypeOf,Object);LT.exports=s2});var Uh=d((wde,bT)=>{var a2=El(),l2=Po(),c2=xl(),u2=Mh(),h2=Object.getOwnPropertySymbols,f2=h2?function(t){for(var e=[];t;)a2(e,c2(t)),t=l2(t);return e}:u2;bT.exports=f2});var NT=d((kde,vT)=>{var d2=yi(),p2=Uh();function m2(t,e){return d2(t,p2(t),e)}vT.exports=m2});var Ph=d((_de,CT)=>{var g2=El(),x2=Me();function E2(t,e,r){var n=e(t);return x2(t)?n:g2(n,r(t))}CT.exports=E2});var qh=d((Mde,IT)=>{var y2=Ph(),T2=xl(),S2=gr();function O2(t){return y2(t,S2,T2)}IT.exports=O2});var wT=d((Ude,RT)=>{var A2=Ph(),L2=Uh(),b2=zr();function v2(t){return A2(t,b2,L2)}RT.exports=v2});var _T=d((Pde,kT)=>{var N2=Hr(),C2=Rt(),I2=N2(C2,"DataView");kT.exports=I2});var UT=d((qde,MT)=>{var R2=Hr(),w2=Rt(),k2=R2(w2,"Promise");MT.exports=k2});var Dh=d((Dde,PT)=>{var _2=Hr(),M2=Rt(),U2=_2(M2,"Set");PT.exports=U2});var DT=d((Fde,qT)=>{var P2=Hr(),q2=Rt(),D2=P2(q2,"WeakMap");qT.exports=D2});var xn=d((Bde,WT)=>{var Fh=_T(),Bh=hl(),$h=UT(),Kh=Dh(),Gh=DT(),jT=Wr(),bi=vh(),FT="[object Map]",F2="[object Object]",BT="[object Promise]",$T="[object Set]",KT="[object WeakMap]",GT="[object DataView]",B2=bi(Fh),$2=bi(Bh),K2=bi($h),G2=bi(Kh),j2=bi(Gh),gn=jT;(Fh&&gn(new Fh(new ArrayBuffer(1)))!=GT||Bh&&gn(new Bh)!=FT||$h&&gn($h.resolve())!=BT||Kh&&gn(new Kh)!=$T||Gh&&gn(new Gh)!=KT)&&(gn=function(t){var e=jT(t),r=e==F2?t.constructor:void 0,n=r?bi(r):"";if(n)switch(n){case B2:return GT;case $2:return FT;case K2:return BT;case G2:return $T;case j2:return KT}return e});WT.exports=gn});var zT=d(($de,HT)=>{var W2=Object.prototype,H2=W2.hasOwnProperty;function z2(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&H2.call(t,"index")&&(r.index=t.index,r.input=t.input),r}HT.exports=z2});var jh=d((Kde,VT)=>{var V2=Rt(),Y2=V2.Uint8Array;VT.exports=Y2});var yl=d((Gde,XT)=>{var YT=jh();function X2(t){var e=new t.constructor(t.byteLength);return new YT(e).set(new YT(t)),e}XT.exports=X2});var ZT=d((jde,QT)=>{var Q2=yl();function Z2(t,e){var r=e?Q2(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}QT.exports=Z2});var eS=d((Wde,JT)=>{var J2=/\w*$/;function e$(t){var e=new t.constructor(t.source,J2.exec(t));return e.lastIndex=t.lastIndex,e}JT.exports=e$});var oS=d((Hde,iS)=>{var tS=pn(),rS=tS?tS.prototype:void 0,nS=rS?rS.valueOf:void 0;function t$(t){return nS?Object(nS.call(t)):{}}iS.exports=t$});var Wh=d((zde,sS)=>{var r$=yl();function n$(t,e){var r=e?r$(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}sS.exports=n$});var lS=d((Vde,aS)=>{var i$=yl(),o$=ZT(),s$=eS(),a$=oS(),l$=Wh(),c$="[object Boolean]",u$="[object Date]",h$="[object Map]",f$="[object Number]",d$="[object RegExp]",p$="[object Set]",m$="[object String]",g$="[object Symbol]",x$="[object ArrayBuffer]",E$="[object DataView]",y$="[object Float32Array]",T$="[object Float64Array]",S$="[object Int8Array]",O$="[object Int16Array]",A$="[object Int32Array]",L$="[object Uint8Array]",b$="[object Uint8ClampedArray]",v$="[object Uint16Array]",N$="[object Uint32Array]";function C$(t,e,r){var n=t.constructor;switch(e){case x$:return i$(t);case c$:case u$:return new n(+t);case E$:return o$(t,r);case y$:case T$:case S$:case O$:case A$:case L$:case b$:case v$:case N$:return l$(t,r);case h$:return new n;case f$:case m$:return new n(t);case d$:return s$(t);case p$:return new n;case g$:return a$(t)}}aS.exports=C$});var Hh=d((Yde,uS)=>{var I$=yt(),cS=Object.create,R$=(function(){function t(){}return function(e){if(!I$(e))return{};if(cS)return cS(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();uS.exports=R$});var zh=d((Xde,hS)=>{var w$=Hh(),k$=Po(),_$=Mo();function M$(t){return typeof t.constructor=="function"&&!_$(t)?w$(k$(t)):{}}hS.exports=M$});var dS=d((Qde,fS)=>{var U$=xn(),P$=Dt(),q$="[object Map]";function D$(t){return P$(t)&&U$(t)==q$}fS.exports=D$});var xS=d((Zde,gS)=>{var F$=dS(),B$=wo(),pS=ml(),mS=pS&&pS.isMap,$$=mS?B$(mS):F$;gS.exports=$$});var yS=d((Jde,ES)=>{var K$=xn(),G$=Dt(),j$="[object Set]";function W$(t){return G$(t)&&K$(t)==j$}ES.exports=W$});var AS=d((epe,OS)=>{var H$=yS(),z$=wo(),TS=ml(),SS=TS&&TS.isSet,V$=SS?z$(SS):H$;OS.exports=V$});var Vh=d((tpe,NS)=>{var Y$=vo(),X$=dl(),Q$=Co(),Z$=iT(),J$=hT(),eK=wh(),tK=kh(),rK=OT(),nK=NT(),iK=qh(),oK=wT(),sK=xn(),aK=zT(),lK=lS(),cK=zh(),uK=Me(),hK=mn(),fK=xS(),dK=yt(),pK=AS(),mK=gr(),gK=zr(),xK=1,EK=2,yK=4,LS="[object Arguments]",TK="[object Array]",SK="[object Boolean]",OK="[object Date]",AK="[object Error]",bS="[object Function]",LK="[object GeneratorFunction]",bK="[object Map]",vK="[object Number]",vS="[object Object]",NK="[object RegExp]",CK="[object Set]",IK="[object String]",RK="[object Symbol]",wK="[object WeakMap]",kK="[object ArrayBuffer]",_K="[object DataView]",MK="[object Float32Array]",UK="[object Float64Array]",PK="[object Int8Array]",qK="[object Int16Array]",DK="[object Int32Array]",FK="[object Uint8Array]",BK="[object Uint8ClampedArray]",$K="[object Uint16Array]",KK="[object Uint32Array]",he={};he[LS]=he[TK]=he[kK]=he[_K]=he[SK]=he[OK]=he[MK]=he[UK]=he[PK]=he[qK]=he[DK]=he[bK]=he[vK]=he[vS]=he[NK]=he[CK]=he[IK]=he[RK]=he[FK]=he[BK]=he[$K]=he[KK]=!0;he[AK]=he[bS]=he[wK]=!1;function Tl(t,e,r,n,i,o){var s,a=e&xK,c=e&EK,l=e&yK;if(r&&(s=i?r(t,n,i,o):r(t)),s!==void 0)return s;if(!dK(t))return t;var h=uK(t);if(h){if(s=aK(t),!a)return tK(t,s)}else{var u=sK(t),f=u==bS||u==LK;if(hK(t))return eK(t,a);if(u==vS||u==LS||f&&!i){if(s=c||f?{}:cK(t),!a)return c?nK(t,J$(s,t)):rK(t,Z$(s,t))}else{if(!he[u])return i?t:{};s=lK(t,u,a)}}o||(o=new Y$);var m=o.get(t);if(m)return m;o.set(t,s),pK(t)?t.forEach(function(E){s.add(Tl(E,e,r,E,t,o))}):fK(t)&&t.forEach(function(E,x){s.set(x,Tl(E,e,r,x,t,o))});var p=l?c?oK:iK:c?gK:mK,g=h?void 0:p(t);return X$(g||t,function(E,x){g&&(x=E,E=t[x]),Q$(s,x,Tl(E,e,r,x,t,o))}),s}NS.exports=Tl});var IS=d((rpe,CS)=>{var GK=Vh(),jK=4;function WK(t){return GK(t,jK)}CS.exports=WK});var Sl=d((npe,RS)=>{function HK(t){return function(){return t}}RS.exports=HK});var kS=d((ipe,wS)=>{function zK(t){return function(e,r,n){for(var i=-1,o=Object(e),s=n(e),a=s.length;a--;){var c=s[t?a:++i];if(r(o[c],c,o)===!1)break}return e}}wS.exports=zK});var Ol=d((ope,_S)=>{var VK=kS(),YK=VK();_S.exports=YK});var Al=d((spe,MS)=>{var XK=Ol(),QK=gr();function ZK(t,e){return t&&XK(t,e,QK)}MS.exports=ZK});var PS=d((ape,US)=>{var JK=nr();function eG(t,e){return function(r,n){if(r==null)return r;if(!JK(r))return t(r,n);for(var i=r.length,o=e?i:-1,s=Object(r);(e?o--:++o<i)&&n(s[o],o,s)!==!1;);return r}}US.exports=eG});var qo=d((lpe,qS)=>{var tG=Al(),rG=PS(),nG=rG(tG);qS.exports=nG});var Vr=d((cpe,DS)=>{function iG(t){return t}DS.exports=iG});var Yh=d((upe,FS)=>{var oG=Vr();function sG(t){return typeof t=="function"?t:oG}FS.exports=sG});var Xh=d((hpe,BS)=>{var aG=dl(),lG=qo(),cG=Yh(),uG=Me();function hG(t,e){var r=uG(t)?aG:lG;return r(t,cG(e))}BS.exports=hG});var Qh=d((fpe,$S)=>{$S.exports=Xh()});var GS=d((dpe,KS)=>{var fG=qo();function dG(t,e){var r=[];return fG(t,function(n,i,o){e(n,i,o)&&r.push(n)}),r}KS.exports=dG});var WS=d((ppe,jS)=>{var pG="__lodash_hash_undefined__";function mG(t){return this.__data__.set(t,pG),this}jS.exports=mG});var zS=d((mpe,HS)=>{function gG(t){return this.__data__.has(t)}HS.exports=gG});var Zh=d((gpe,VS)=>{var xG=fl(),EG=WS(),yG=zS();function Ll(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new xG;++e<r;)this.add(t[e])}Ll.prototype.add=Ll.prototype.push=EG;Ll.prototype.has=yG;VS.exports=Ll});var XS=d((xpe,YS)=>{function TG(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}YS.exports=TG});var Jh=d((Epe,QS)=>{function SG(t,e){return t.has(e)}QS.exports=SG});var ef=d((ype,ZS)=>{var OG=Zh(),AG=XS(),LG=Jh(),bG=1,vG=2;function NG(t,e,r,n,i,o){var s=r&bG,a=t.length,c=e.length;if(a!=c&&!(s&&c>a))return!1;var l=o.get(t),h=o.get(e);if(l&&h)return l==e&&h==t;var u=-1,f=!0,m=r&vG?new OG:void 0;for(o.set(t,e),o.set(e,t);++u<a;){var p=t[u],g=e[u];if(n)var E=s?n(g,p,u,e,t,o):n(p,g,u,t,e,o);if(E!==void 0){if(E)continue;f=!1;break}if(m){if(!AG(e,function(x,T){if(!LG(m,T)&&(p===x||i(p,x,r,n,o)))return m.push(T)})){f=!1;break}}else if(!(p===g||i(p,g,r,n,o))){f=!1;break}}return o.delete(t),o.delete(e),f}ZS.exports=NG});var eO=d((Tpe,JS)=>{function CG(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}JS.exports=CG});var bl=d((Spe,tO)=>{function IG(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}tO.exports=IG});var sO=d((Ope,oO)=>{var rO=pn(),nO=jh(),RG=dn(),wG=ef(),kG=eO(),_G=bl(),MG=1,UG=2,PG="[object Boolean]",qG="[object Date]",DG="[object Error]",FG="[object Map]",BG="[object Number]",$G="[object RegExp]",KG="[object Set]",GG="[object String]",jG="[object Symbol]",WG="[object ArrayBuffer]",HG="[object DataView]",iO=rO?rO.prototype:void 0,tf=iO?iO.valueOf:void 0;function zG(t,e,r,n,i,o,s){switch(r){case HG:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case WG:return!(t.byteLength!=e.byteLength||!o(new nO(t),new nO(e)));case PG:case qG:case BG:return RG(+t,+e);case DG:return t.name==e.name&&t.message==e.message;case $G:case GG:return t==e+"";case FG:var a=kG;case KG:var c=n&MG;if(a||(a=_G),t.size!=e.size&&!c)return!1;var l=s.get(t);if(l)return l==e;n|=UG,s.set(t,e);var h=wG(a(t),a(e),n,i,o,s);return s.delete(t),h;case jG:if(tf)return tf.call(t)==tf.call(e)}return!1}oO.exports=zG});var cO=d((Ape,lO)=>{var aO=qh(),VG=1,YG=Object.prototype,XG=YG.hasOwnProperty;function QG(t,e,r,n,i,o){var s=r&VG,a=aO(t),c=a.length,l=aO(e),h=l.length;if(c!=h&&!s)return!1;for(var u=c;u--;){var f=a[u];if(!(s?f in e:XG.call(e,f)))return!1}var m=o.get(t),p=o.get(e);if(m&&p)return m==e&&p==t;var g=!0;o.set(t,e),o.set(e,t);for(var E=s;++u<c;){f=a[u];var x=t[f],T=e[f];if(n)var y=s?n(T,x,f,e,t,o):n(x,T,f,t,e,o);if(!(y===void 0?x===T||i(x,T,r,n,o):y)){g=!1;break}E||(E=f=="constructor")}if(g&&!E){var O=t.constructor,A=e.constructor;O!=A&&"constructor"in t&&"constructor"in e&&!(typeof O=="function"&&O instanceof O&&typeof A=="function"&&A instanceof A)&&(g=!1)}return o.delete(t),o.delete(e),g}lO.exports=QG});var xO=d((Lpe,gO)=>{var rf=vo(),ZG=ef(),JG=sO(),ej=cO(),uO=xn(),hO=Me(),fO=mn(),tj=Ai(),rj=1,dO="[object Arguments]",pO="[object Array]",vl="[object Object]",nj=Object.prototype,mO=nj.hasOwnProperty;function ij(t,e,r,n,i,o){var s=hO(t),a=hO(e),c=s?pO:uO(t),l=a?pO:uO(e);c=c==dO?vl:c,l=l==dO?vl:l;var h=c==vl,u=l==vl,f=c==l;if(f&&fO(t)){if(!fO(e))return!1;s=!0,h=!1}if(f&&!h)return o||(o=new rf),s||tj(t)?ZG(t,e,r,n,i,o):JG(t,e,c,r,n,i,o);if(!(r&rj)){var m=h&&mO.call(t,"__wrapped__"),p=u&&mO.call(e,"__wrapped__");if(m||p){var g=m?t.value():t,E=p?e.value():e;return o||(o=new rf),i(g,E,r,n,o)}}return f?(o||(o=new rf),ej(t,e,r,n,i,o)):!1}gO.exports=ij});var nf=d((bpe,TO)=>{var oj=xO(),EO=Dt();function yO(t,e,r,n,i){return t===e?!0:t==null||e==null||!EO(t)&&!EO(e)?t!==t&&e!==e:oj(t,e,r,n,yO,i)}TO.exports=yO});var OO=d((vpe,SO)=>{var sj=vo(),aj=nf(),lj=1,cj=2;function uj(t,e,r,n){var i=r.length,o=i,s=!n;if(t==null)return!o;for(t=Object(t);i--;){var a=r[i];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){a=r[i];var c=a[0],l=t[c],h=a[1];if(s&&a[2]){if(l===void 0&&!(c in t))return!1}else{var u=new sj;if(n)var f=n(l,h,c,t,e,u);if(!(f===void 0?aj(h,l,lj|cj,n,u):f))return!1}}return!0}SO.exports=uj});var of=d((Npe,AO)=>{var hj=yt();function fj(t){return t===t&&!hj(t)}AO.exports=fj});var bO=d((Cpe,LO)=>{var dj=of(),pj=gr();function mj(t){for(var e=pj(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,dj(i)]}return e}LO.exports=mj});var sf=d((Ipe,vO)=>{function gj(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}vO.exports=gj});var CO=d((Rpe,NO)=>{var xj=OO(),Ej=bO(),yj=sf();function Tj(t){var e=Ej(t);return e.length==1&&e[0][2]?yj(e[0][0],e[0][1]):function(r){return r===t||xj(r,t,e)}}NO.exports=Tj});var En=d((wpe,IO)=>{var Sj=Wr(),Oj=Dt(),Aj="[object Symbol]";function Lj(t){return typeof t=="symbol"||Oj(t)&&Sj(t)==Aj}IO.exports=Lj});var Nl=d((kpe,RO)=>{var bj=Me(),vj=En(),Nj=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Cj=/^\w*$/;function Ij(t,e){if(bj(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||vj(t)?!0:Cj.test(t)||!Nj.test(t)||e!=null&&t in Object(e)}RO.exports=Ij});var _O=d((_pe,kO)=>{var wO=fl(),Rj="Expected a function";function af(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Rj);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=t.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(af.Cache||wO),r}af.Cache=wO;kO.exports=af});var UO=d((Mpe,MO)=>{var wj=_O(),kj=500;function _j(t){var e=wj(t,function(n){return r.size===kj&&r.clear(),n}),r=e.cache;return e}MO.exports=_j});var qO=d((Upe,PO)=>{var Mj=UO(),Uj=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pj=/\\(\\)?/g,qj=Mj(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Uj,function(r,n,i,o){e.push(i?o.replace(Pj,"$1"):n||r)}),e});PO.exports=qj});var Do=d((Ppe,DO)=>{function Dj(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}DO.exports=Dj});var jO=d((qpe,GO)=>{var FO=pn(),Fj=Do(),Bj=Me(),$j=En(),Kj=1/0,BO=FO?FO.prototype:void 0,$O=BO?BO.toString:void 0;function KO(t){if(typeof t=="string")return t;if(Bj(t))return Fj(t,KO)+"";if($j(t))return $O?$O.call(t):"";var e=t+"";return e=="0"&&1/t==-Kj?"-0":e}GO.exports=KO});var lf=d((Dpe,WO)=>{var Gj=jO();function jj(t){return t==null?"":Gj(t)}WO.exports=jj});var Fo=d((Fpe,HO)=>{var Wj=Me(),Hj=Nl(),zj=qO(),Vj=lf();function Yj(t,e){return Wj(t)?t:Hj(t,e)?[t]:zj(Vj(t))}HO.exports=Yj});var vi=d((Bpe,zO)=>{var Xj=En(),Qj=1/0;function Zj(t){if(typeof t=="string"||Xj(t))return t;var e=t+"";return e=="0"&&1/t==-Qj?"-0":e}zO.exports=Zj});var Bo=d(($pe,VO)=>{var Jj=Fo(),eW=vi();function tW(t,e){e=Jj(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[eW(e[r++])];return r&&r==n?t:void 0}VO.exports=tW});var XO=d((Kpe,YO)=>{var rW=Bo();function nW(t,e,r){var n=t==null?void 0:rW(t,e);return n===void 0?r:n}YO.exports=nW});var ZO=d((Gpe,QO)=>{function iW(t,e){return t!=null&&e in Object(t)}QO.exports=iW});var cf=d((jpe,JO)=>{var oW=Fo(),sW=Ti(),aW=Me(),lW=Ro(),cW=pl(),uW=vi();function hW(t,e,r){e=oW(e,t);for(var n=-1,i=e.length,o=!1;++n<i;){var s=uW(e[n]);if(!(o=t!=null&&r(t,s)))break;t=t[s]}return o||++n!=i?o:(i=t==null?0:t.length,!!i&&cW(i)&&lW(s,i)&&(aW(t)||sW(t)))}JO.exports=hW});var uf=d((Wpe,eA)=>{var fW=ZO(),dW=cf();function pW(t,e){return t!=null&&dW(t,e,fW)}eA.exports=pW});var rA=d((Hpe,tA)=>{var mW=nf(),gW=XO(),xW=uf(),EW=Nl(),yW=of(),TW=sf(),SW=vi(),OW=1,AW=2;function LW(t,e){return EW(t)&&yW(e)?TW(SW(t),e):function(r){var n=gW(r,t);return n===void 0&&n===e?xW(r,t):mW(e,n,OW|AW)}}tA.exports=LW});var hf=d((zpe,nA)=>{function bW(t){return function(e){return e?.[t]}}nA.exports=bW});var oA=d((Vpe,iA)=>{var vW=Bo();function NW(t){return function(e){return vW(e,t)}}iA.exports=NW});var aA=d((Ype,sA)=>{var CW=hf(),IW=oA(),RW=Nl(),wW=vi();function kW(t){return RW(t)?CW(wW(t)):IW(t)}sA.exports=kW});var ir=d((Xpe,lA)=>{var _W=CO(),MW=rA(),UW=Vr(),PW=Me(),qW=aA();function DW(t){return typeof t=="function"?t:t==null?UW:typeof t=="object"?PW(t)?MW(t[0],t[1]):_W(t):qW(t)}lA.exports=DW});var ff=d((Qpe,cA)=>{var FW=_h(),BW=GS(),$W=ir(),KW=Me();function GW(t,e){var r=KW(t)?FW:BW;return r(t,$W(e,3))}cA.exports=GW});var hA=d((Zpe,uA)=>{var jW=Object.prototype,WW=jW.hasOwnProperty;function HW(t,e){return t!=null&&WW.call(t,e)}uA.exports=HW});var df=d((Jpe,fA)=>{var zW=hA(),VW=cf();function YW(t,e){return t!=null&&VW(t,e,zW)}fA.exports=YW});var pA=d((eme,dA)=>{var XW=gl(),QW=xn(),ZW=Ti(),JW=Me(),eH=nr(),tH=mn(),rH=Mo(),nH=Ai(),iH="[object Map]",oH="[object Set]",sH=Object.prototype,aH=sH.hasOwnProperty;function lH(t){if(t==null)return!0;if(eH(t)&&(JW(t)||typeof t=="string"||typeof t.splice=="function"||tH(t)||nH(t)||ZW(t)))return!t.length;var e=QW(t);if(e==iH||e==oH)return!t.size;if(rH(t))return!XW(t).length;for(var r in t)if(aH.call(t,r))return!1;return!0}dA.exports=lH});var pf=d((tme,mA)=>{function cH(t){return t===void 0}mA.exports=cH});var mf=d((rme,gA)=>{var uH=qo(),hH=nr();function fH(t,e){var r=-1,n=hH(t)?Array(t.length):[];return uH(t,function(i,o,s){n[++r]=e(i,o,s)}),n}gA.exports=fH});var gf=d((nme,xA)=>{var dH=Do(),pH=ir(),mH=mf(),gH=Me();function xH(t,e){var r=gH(t)?dH:mH;return r(t,pH(e,3))}xA.exports=xH});var yA=d((ime,EA)=>{function EH(t,e,r,n){var i=-1,o=t==null?0:t.length;for(n&&o&&(r=t[++i]);++i<o;)r=e(r,t[i],i,t);return r}EA.exports=EH});var SA=d((ome,TA)=>{function yH(t,e,r,n,i){return i(t,function(o,s,a){r=n?(n=!1,o):e(r,o,s,a)}),r}TA.exports=yH});var xf=d((sme,OA)=>{var TH=yA(),SH=qo(),OH=ir(),AH=SA(),LH=Me();function bH(t,e,r){var n=LH(t)?TH:AH,i=arguments.length<3;return n(t,OH(e,4),r,i,SH)}OA.exports=bH});var LA=d((ame,AA)=>{var vH=Wr(),NH=Me(),CH=Dt(),IH="[object String]";function RH(t){return typeof t=="string"||!NH(t)&&CH(t)&&vH(t)==IH}AA.exports=RH});var vA=d((lme,bA)=>{var wH=hf(),kH=wH("length");bA.exports=kH});var CA=d((cme,NA)=>{var _H="\\ud800-\\udfff",MH="\\u0300-\\u036f",UH="\\ufe20-\\ufe2f",PH="\\u20d0-\\u20ff",qH=MH+UH+PH,DH="\\ufe0e\\ufe0f",FH="\\u200d",BH=RegExp("["+FH+_H+qH+DH+"]");function $H(t){return BH.test(t)}NA.exports=$H});var qA=d((ume,PA)=>{var RA="\\ud800-\\udfff",KH="\\u0300-\\u036f",GH="\\ufe20-\\ufe2f",jH="\\u20d0-\\u20ff",WH=KH+GH+jH,HH="\\ufe0e\\ufe0f",zH="["+RA+"]",Ef="["+WH+"]",yf="\\ud83c[\\udffb-\\udfff]",VH="(?:"+Ef+"|"+yf+")",wA="[^"+RA+"]",kA="(?:\\ud83c[\\udde6-\\uddff]){2}",_A="[\\ud800-\\udbff][\\udc00-\\udfff]",YH="\\u200d",MA=VH+"?",UA="["+HH+"]?",XH="(?:"+YH+"(?:"+[wA,kA,_A].join("|")+")"+UA+MA+")*",QH=UA+MA+XH,ZH="(?:"+[wA+Ef+"?",Ef,kA,_A,zH].join("|")+")",IA=RegExp(yf+"(?="+yf+")|"+ZH+QH,"g");function JH(t){for(var e=IA.lastIndex=0;IA.test(t);)++e;return e}PA.exports=JH});var FA=d((hme,DA)=>{var ez=vA(),tz=CA(),rz=qA();function nz(t){return tz(t)?rz(t):ez(t)}DA.exports=nz});var $A=d((fme,BA)=>{var iz=gl(),oz=xn(),sz=nr(),az=LA(),lz=FA(),cz="[object Map]",uz="[object Set]";function hz(t){if(t==null)return 0;if(sz(t))return az(t)?lz(t):t.length;var e=oz(t);return e==cz||e==uz?t.size:iz(t).length}BA.exports=hz});var GA=d((dme,KA)=>{var fz=dl(),dz=Hh(),pz=Al(),mz=ir(),gz=Po(),xz=Me(),Ez=mn(),yz=mi(),Tz=yt(),Sz=Ai();function Oz(t,e,r){var n=xz(t),i=n||Ez(t)||Sz(t);if(e=mz(e,4),r==null){var o=t&&t.constructor;i?r=n?new o:[]:Tz(t)?r=yz(o)?dz(gz(t)):{}:r={}}return(i?fz:pz)(t,function(s,a,c){return e(r,s,a,c)}),r}KA.exports=Oz});var zA=d((pme,HA)=>{var jA=pn(),Az=Ti(),Lz=Me(),WA=jA?jA.isConcatSpreadable:void 0;function bz(t){return Lz(t)||Az(t)||!!(WA&&t&&t[WA])}HA.exports=bz});var Cl=d((mme,YA)=>{var vz=El(),Nz=zA();function VA(t,e,r,n,i){var o=-1,s=t.length;for(r||(r=Nz),i||(i=[]);++o<s;){var a=t[o];e>0&&r(a)?e>1?VA(a,e-1,r,n,i):vz(i,a):n||(i[i.length]=a)}return i}YA.exports=VA});var QA=d((gme,XA)=>{function Cz(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}XA.exports=Cz});var Tf=d((xme,JA)=>{var Iz=QA(),ZA=Math.max;function Rz(t,e,r){return e=ZA(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,o=ZA(n.length-e,0),s=Array(o);++i<o;)s[i]=n[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=n[i];return a[e]=r(s),Iz(t,this,a)}}JA.exports=Rz});var rL=d((Eme,tL)=>{var wz=Sl(),eL=Nh(),kz=Vr(),_z=eL?function(t,e){return eL(t,"toString",{configurable:!0,enumerable:!1,value:wz(e),writable:!0})}:kz;tL.exports=_z});var iL=d((yme,nL)=>{var Mz=800,Uz=16,Pz=Date.now;function qz(t){var e=0,r=0;return function(){var n=Pz(),i=Uz-(n-r);if(r=n,i>0){if(++e>=Mz)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}nL.exports=qz});var Sf=d((Tme,oL)=>{var Dz=rL(),Fz=iL(),Bz=Fz(Dz);oL.exports=Bz});var $o=d((Sme,sL)=>{var $z=Vr(),Kz=Tf(),Gz=Sf();function jz(t,e){return Gz(Kz(t,e,$z),t+"")}sL.exports=jz});var Of=d((Ome,aL)=>{function Wz(t,e,r,n){for(var i=t.length,o=r+(n?1:-1);n?o--:++o<i;)if(e(t[o],o,t))return o;return-1}aL.exports=Wz});var cL=d((Ame,lL)=>{function Hz(t){return t!==t}lL.exports=Hz});var hL=d((Lme,uL)=>{function zz(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}uL.exports=zz});var dL=d((bme,fL)=>{var Vz=Of(),Yz=cL(),Xz=hL();function Qz(t,e,r){return e===e?Xz(t,e,r):Vz(t,Yz,r)}fL.exports=Qz});var mL=d((vme,pL)=>{var Zz=dL();function Jz(t,e){var r=t==null?0:t.length;return!!r&&Zz(t,e,0)>-1}pL.exports=Jz});var xL=d((Nme,gL)=>{function e3(t,e,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}gL.exports=e3});var yL=d((Cme,EL)=>{function t3(){}EL.exports=t3});var SL=d((Ime,TL)=>{var Af=Dh(),r3=yL(),n3=bl(),i3=1/0,o3=Af&&1/n3(new Af([,-0]))[1]==i3?function(t){return new Af(t)}:r3;TL.exports=o3});var AL=d((Rme,OL)=>{var s3=Zh(),a3=mL(),l3=xL(),c3=Jh(),u3=SL(),h3=bl(),f3=200;function d3(t,e,r){var n=-1,i=a3,o=t.length,s=!0,a=[],c=a;if(r)s=!1,i=l3;else if(o>=f3){var l=e?null:u3(t);if(l)return h3(l);s=!1,i=c3,c=new s3}else c=e?[]:a;e:for(;++n<o;){var h=t[n],u=e?e(h):h;if(h=r||h!==0?h:0,s&&u===u){for(var f=c.length;f--;)if(c[f]===u)continue e;e&&c.push(u),a.push(h)}else i(c,u,r)||(c!==a&&c.push(u),a.push(h))}return a}OL.exports=d3});var Lf=d((wme,LL)=>{var p3=nr(),m3=Dt();function g3(t){return m3(t)&&p3(t)}LL.exports=g3});var vL=d((kme,bL)=>{var x3=Cl(),E3=$o(),y3=AL(),T3=Lf(),S3=E3(function(t){return y3(x3(t,1,T3,!0))});bL.exports=S3});var CL=d((_me,NL)=>{var O3=Do();function A3(t,e){return O3(e,function(r){return t[r]})}NL.exports=A3});var bf=d((Mme,IL)=>{var L3=CL(),b3=gr();function v3(t){return t==null?[]:L3(t,b3(t))}IL.exports=v3});var Tt=d((Ume,RL)=>{var Il;if(typeof bn=="function")try{Il={clone:IS(),constant:Sl(),each:Qh(),filter:ff(),has:df(),isArray:Me(),isEmpty:pA(),isFunction:mi(),isUndefined:pf(),keys:gr(),map:gf(),reduce:xf(),size:$A(),transform:GA(),union:vL(),values:bf()}}catch{}Il||(Il=window._);RL.exports=Il});var Rl=d((qme,ML)=>{"use strict";var D=Tt();ML.exports=G;var N3="\0",yn="\0",wL="";function G(t){this._isDirected=D.has(t,"directed")?t.directed:!0,this._isMultigraph=D.has(t,"multigraph")?t.multigraph:!1,this._isCompound=D.has(t,"compound")?t.compound:!1,this._label=void 0,this._defaultNodeLabelFn=D.constant(void 0),this._defaultEdgeLabelFn=D.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[yn]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}G.prototype._nodeCount=0;G.prototype._edgeCount=0;G.prototype.isDirected=function(){return this._isDirected};G.prototype.isMultigraph=function(){return this._isMultigraph};G.prototype.isCompound=function(){return this._isCompound};G.prototype.setGraph=function(t){return this._label=t,this};G.prototype.graph=function(){return this._label};G.prototype.setDefaultNodeLabel=function(t){return D.isFunction(t)||(t=D.constant(t)),this._defaultNodeLabelFn=t,this};G.prototype.nodeCount=function(){return this._nodeCount};G.prototype.nodes=function(){return D.keys(this._nodes)};G.prototype.sources=function(){var t=this;return D.filter(this.nodes(),function(e){return D.isEmpty(t._in[e])})};G.prototype.sinks=function(){var t=this;return D.filter(this.nodes(),function(e){return D.isEmpty(t._out[e])})};G.prototype.setNodes=function(t,e){var r=arguments,n=this;return D.each(t,function(i){r.length>1?n.setNode(i,e):n.setNode(i)}),this};G.prototype.setNode=function(t,e){return D.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=yn,this._children[t]={},this._children[yn][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)};G.prototype.node=function(t){return this._nodes[t]};G.prototype.hasNode=function(t){return D.has(this._nodes,t)};G.prototype.removeNode=function(t){var e=this;if(D.has(this._nodes,t)){var r=function(n){e.removeEdge(e._edgeObjs[n])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],D.each(this.children(t),function(n){e.setParent(n)}),delete this._children[t]),D.each(D.keys(this._in[t]),r),delete this._in[t],delete this._preds[t],D.each(D.keys(this._out[t]),r),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this};G.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(D.isUndefined(e))e=yn;else{e+="";for(var r=e;!D.isUndefined(r);r=this.parent(r))if(r===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this};G.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]};G.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if(e!==yn)return e}};G.prototype.children=function(t){if(D.isUndefined(t)&&(t=yn),this._isCompound){var e=this._children[t];if(e)return D.keys(e)}else{if(t===yn)return this.nodes();if(this.hasNode(t))return[]}};G.prototype.predecessors=function(t){var e=this._preds[t];if(e)return D.keys(e)};G.prototype.successors=function(t){var e=this._sucs[t];if(e)return D.keys(e)};G.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return D.union(e,this.successors(t))};G.prototype.isLeaf=function(t){var e;return this.isDirected()?e=this.successors(t):e=this.neighbors(t),e.length===0};G.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var r=this;D.each(this._nodes,function(o,s){t(s)&&e.setNode(s,o)}),D.each(this._edgeObjs,function(o){e.hasNode(o.v)&&e.hasNode(o.w)&&e.setEdge(o,r.edge(o))});var n={};function i(o){var s=r.parent(o);return s===void 0||e.hasNode(s)?(n[o]=s,s):s in n?n[s]:i(s)}return this._isCompound&&D.each(e.nodes(),function(o){e.setParent(o,i(o))}),e};G.prototype.setDefaultEdgeLabel=function(t){return D.isFunction(t)||(t=D.constant(t)),this._defaultEdgeLabelFn=t,this};G.prototype.edgeCount=function(){return this._edgeCount};G.prototype.edges=function(){return D.values(this._edgeObjs)};G.prototype.setPath=function(t,e){var r=this,n=arguments;return D.reduce(t,function(i,o){return n.length>1?r.setEdge(i,o,e):r.setEdge(i,o),o}),this};G.prototype.setEdge=function(){var t,e,r,n,i=!1,o=arguments[0];typeof o=="object"&&o!==null&&"v"in o?(t=o.v,e=o.w,r=o.name,arguments.length===2&&(n=arguments[1],i=!0)):(t=o,e=arguments[1],r=arguments[3],arguments.length>2&&(n=arguments[2],i=!0)),t=""+t,e=""+e,D.isUndefined(r)||(r=""+r);var s=Ko(this._isDirected,t,e,r);if(D.has(this._edgeLabels,s))return i&&(this._edgeLabels[s]=n),this;if(!D.isUndefined(r)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[s]=i?n:this._defaultEdgeLabelFn(t,e,r);var a=C3(this._isDirected,t,e,r);return t=a.v,e=a.w,Object.freeze(a),this._edgeObjs[s]=a,kL(this._preds[e],t),kL(this._sucs[t],e),this._in[e][s]=a,this._out[t][s]=a,this._edgeCount++,this};G.prototype.edge=function(t,e,r){var n=arguments.length===1?vf(this._isDirected,arguments[0]):Ko(this._isDirected,t,e,r);return this._edgeLabels[n]};G.prototype.hasEdge=function(t,e,r){var n=arguments.length===1?vf(this._isDirected,arguments[0]):Ko(this._isDirected,t,e,r);return D.has(this._edgeLabels,n)};G.prototype.removeEdge=function(t,e,r){var n=arguments.length===1?vf(this._isDirected,arguments[0]):Ko(this._isDirected,t,e,r),i=this._edgeObjs[n];return i&&(t=i.v,e=i.w,delete this._edgeLabels[n],delete this._edgeObjs[n],_L(this._preds[e],t),_L(this._sucs[t],e),delete this._in[e][n],delete this._out[t][n],this._edgeCount--),this};G.prototype.inEdges=function(t,e){var r=this._in[t];if(r){var n=D.values(r);return e?D.filter(n,function(i){return i.v===e}):n}};G.prototype.outEdges=function(t,e){var r=this._out[t];if(r){var n=D.values(r);return e?D.filter(n,function(i){return i.w===e}):n}};G.prototype.nodeEdges=function(t,e){var r=this.inEdges(t,e);if(r)return r.concat(this.outEdges(t,e))};function kL(t,e){t[e]?t[e]++:t[e]=1}function _L(t,e){--t[e]||delete t[e]}function Ko(t,e,r,n){var i=""+e,o=""+r;if(!t&&i>o){var s=i;i=o,o=s}return i+wL+o+wL+(D.isUndefined(n)?N3:n)}function C3(t,e,r,n){var i=""+e,o=""+r;if(!t&&i>o){var s=i;i=o,o=s}var a={v:i,w:o};return n&&(a.name=n),a}function vf(t,e){return Ko(t,e.v,e.w,e.name)}});var PL=d((Dme,UL)=>{UL.exports="2.1.8"});var DL=d((Fme,qL)=>{qL.exports={Graph:Rl(),version:PL()}});var BL=d((Bme,FL)=>{var or=Tt(),I3=Rl();FL.exports={write:R3,read:_3};function R3(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:w3(t),edges:k3(t)};return or.isUndefined(t.graph())||(e.value=or.clone(t.graph())),e}function w3(t){return or.map(t.nodes(),function(e){var r=t.node(e),n=t.parent(e),i={v:e};return or.isUndefined(r)||(i.value=r),or.isUndefined(n)||(i.parent=n),i})}function k3(t){return or.map(t.edges(),function(e){var r=t.edge(e),n={v:e.v,w:e.w};return or.isUndefined(e.name)||(n.name=e.name),or.isUndefined(r)||(n.value=r),n})}function _3(t){var e=new I3(t.options).setGraph(t.value);return or.each(t.nodes,function(r){e.setNode(r.v,r.value),r.parent&&e.setParent(r.v,r.parent)}),or.each(t.edges,function(r){e.setEdge({v:r.v,w:r.w,name:r.name},r.value)}),e}});var KL=d(($me,$L)=>{var wl=Tt();$L.exports=M3;function M3(t){var e={},r=[],n;function i(o){wl.has(e,o)||(e[o]=!0,n.push(o),wl.each(t.successors(o),i),wl.each(t.predecessors(o),i))}return wl.each(t.nodes(),function(o){n=[],i(o),n.length&&r.push(n)}),r}});var Nf=d((Kme,jL)=>{var GL=Tt();jL.exports=wt;function wt(){this._arr=[],this._keyIndices={}}wt.prototype.size=function(){return this._arr.length};wt.prototype.keys=function(){return this._arr.map(function(t){return t.key})};wt.prototype.has=function(t){return GL.has(this._keyIndices,t)};wt.prototype.priority=function(t){var e=this._keyIndices[t];if(e!==void 0)return this._arr[e].priority};wt.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key};wt.prototype.add=function(t,e){var r=this._keyIndices;if(t=String(t),!GL.has(r,t)){var n=this._arr,i=n.length;return r[t]=i,n.push({key:t,priority:e}),this._decrease(i),!0}return!1};wt.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key};wt.prototype.decrease=function(t,e){var r=this._keyIndices[t];if(e>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[r].priority+" New: "+e);this._arr[r].priority=e,this._decrease(r)};wt.prototype._heapify=function(t){var e=this._arr,r=2*t,n=r+1,i=t;r<e.length&&(i=e[r].priority<e[i].priority?r:i,n<e.length&&(i=e[n].priority<e[i].priority?n:i),i!==t&&(this._swap(t,i),this._heapify(i)))};wt.prototype._decrease=function(t){for(var e=this._arr,r=e[t].priority,n;t!==0&&(n=t>>1,!(e[n].priority<r));)this._swap(t,n),t=n};wt.prototype._swap=function(t,e){var r=this._arr,n=this._keyIndices,i=r[t],o=r[e];r[t]=o,r[e]=i,n[o.key]=t,n[i.key]=e}});var Cf=d((Gme,WL)=>{var U3=Tt(),P3=Nf();WL.exports=D3;var q3=U3.constant(1);function D3(t,e,r,n){return F3(t,String(e),r||q3,n||function(i){return t.outEdges(i)})}function F3(t,e,r,n){var i={},o=new P3,s,a,c=function(l){var h=l.v!==s?l.v:l.w,u=i[h],f=r(l),m=a.distance+f;if(f<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+l+" Weight: "+f);m<u.distance&&(u.distance=m,u.predecessor=s,o.decrease(h,m))};for(t.nodes().forEach(function(l){var h=l===e?0:Number.POSITIVE_INFINITY;i[l]={distance:h},o.add(l,h)});o.size()>0&&(s=o.removeMin(),a=i[s],a.distance!==Number.POSITIVE_INFINITY);)n(s).forEach(c);return i}});var zL=d((jme,HL)=>{var B3=Cf(),$3=Tt();HL.exports=K3;function K3(t,e,r){return $3.transform(t.nodes(),function(n,i){n[i]=B3(t,i,e,r)},{})}});var If=d((Wme,YL)=>{var VL=Tt();YL.exports=G3;function G3(t){var e=0,r=[],n={},i=[];function o(s){var a=n[s]={onStack:!0,lowlink:e,index:e++};if(r.push(s),t.successors(s).forEach(function(h){VL.has(n,h)?n[h].onStack&&(a.lowlink=Math.min(a.lowlink,n[h].index)):(o(h),a.lowlink=Math.min(a.lowlink,n[h].lowlink))}),a.lowlink===a.index){var c=[],l;do l=r.pop(),n[l].onStack=!1,c.push(l);while(s!==l);i.push(c)}}return t.nodes().forEach(function(s){VL.has(n,s)||o(s)}),i}});var QL=d((Hme,XL)=>{var j3=Tt(),W3=If();XL.exports=H3;function H3(t){return j3.filter(W3(t),function(e){return e.length>1||e.length===1&&t.hasEdge(e[0],e[0])})}});var JL=d((zme,ZL)=>{var z3=Tt();ZL.exports=Y3;var V3=z3.constant(1);function Y3(t,e,r){return X3(t,e||V3,r||function(n){return t.outEdges(n)})}function X3(t,e,r){var n={},i=t.nodes();return i.forEach(function(o){n[o]={},n[o][o]={distance:0},i.forEach(function(s){o!==s&&(n[o][s]={distance:Number.POSITIVE_INFINITY})}),r(o).forEach(function(s){var a=s.v===o?s.w:s.v,c=e(s);n[o][a]={distance:c,predecessor:o}})}),i.forEach(function(o){var s=n[o];i.forEach(function(a){var c=n[a];i.forEach(function(l){var h=c[o],u=s[l],f=c[l],m=h.distance+u.distance;m<f.distance&&(f.distance=m,f.predecessor=u.predecessor)})})}),n}});var Rf=d((Vme,tb)=>{var Go=Tt();tb.exports=eb;eb.CycleException=kl;function eb(t){var e={},r={},n=[];function i(o){if(Go.has(r,o))throw new kl;Go.has(e,o)||(r[o]=!0,e[o]=!0,Go.each(t.predecessors(o),i),delete r[o],n.push(o))}if(Go.each(t.sinks(),i),Go.size(e)!==t.nodeCount())throw new kl;return n}function kl(){}kl.prototype=new Error});var ib=d((Yme,nb)=>{var rb=Rf();nb.exports=Q3;function Q3(t){try{rb(t)}catch(e){if(e instanceof rb.CycleException)return!1;throw e}return!0}});var wf=d((Xme,sb)=>{var _l=Tt();sb.exports=Z3;function Z3(t,e,r){_l.isArray(e)||(e=[e]);var n=(t.isDirected()?t.successors:t.neighbors).bind(t),i=[],o={};return _l.each(e,function(s){if(!t.hasNode(s))throw new Error("Graph does not have node: "+s);ob(t,s,r==="post",o,n,i)}),i}function ob(t,e,r,n,i,o){_l.has(n,e)||(n[e]=!0,r||o.push(e),_l.each(i(e),function(s){ob(t,s,r,n,i,o)}),r&&o.push(e))}});var lb=d((Qme,ab)=>{var J3=wf();ab.exports=eV;function eV(t,e){return J3(t,e,"post")}});var ub=d((Zme,cb)=>{var tV=wf();cb.exports=rV;function rV(t,e){return tV(t,e,"pre")}});var db=d((Jme,fb)=>{var hb=Tt(),nV=Rl(),iV=Nf();fb.exports=oV;function oV(t,e){var r=new nV,n={},i=new iV,o;function s(c){var l=c.v===o?c.w:c.v,h=i.priority(l);if(h!==void 0){var u=e(c);u<h&&(n[l]=o,i.decrease(l,u))}}if(t.nodeCount()===0)return r;hb.each(t.nodes(),function(c){i.add(c,Number.POSITIVE_INFINITY),r.setNode(c)}),i.decrease(t.nodes()[0],0);for(var a=!1;i.size()>0;){if(o=i.removeMin(),hb.has(n,o))r.setEdge(o,n[o]);else{if(a)throw new Error("Input graph is not connected: "+t);a=!0}t.nodeEdges(o).forEach(s)}return r}});var mb=d((ege,pb)=>{pb.exports={components:KL(),dijkstra:Cf(),dijkstraAll:zL(),findCycles:QL(),floydWarshall:JL(),isAcyclic:ib(),postorder:lb(),preorder:ub(),prim:db(),tarjan:If(),topsort:Rf()}});var Eb=d((tge,xb)=>{var gb=DL();xb.exports={Graph:gb.Graph,json:BL(),alg:mb(),version:gb.version}});var kt=d((rge,yb)=>{var Ml;if(typeof bn=="function")try{Ml=Eb()}catch{}Ml||(Ml=window.graphlib);yb.exports=Ml});var Sb=d((ige,Tb)=>{var sV=Vh(),aV=1,lV=4;function cV(t){return sV(t,aV|lV)}Tb.exports=cV});var jo=d((oge,Ob)=>{var uV=dn(),hV=nr(),fV=Ro(),dV=yt();function pV(t,e,r){if(!dV(r))return!1;var n=typeof e;return(n=="number"?hV(r)&&fV(e,r.length):n=="string"&&e in r)?uV(r[e],t):!1}Ob.exports=pV});var bb=d((sge,Lb)=>{var mV=$o(),gV=dn(),xV=jo(),EV=zr(),Ab=Object.prototype,yV=Ab.hasOwnProperty,TV=mV(function(t,e){t=Object(t);var r=-1,n=e.length,i=n>2?e[2]:void 0;for(i&&xV(e[0],e[1],i)&&(n=1);++r<n;)for(var o=e[r],s=EV(o),a=-1,c=s.length;++a<c;){var l=s[a],h=t[l];(h===void 0||gV(h,Ab[l])&&!yV.call(t,l))&&(t[l]=o[l])}return t});Lb.exports=TV});var Nb=d((age,vb)=>{var SV=ir(),OV=nr(),AV=gr();function LV(t){return function(e,r,n){var i=Object(e);if(!OV(e)){var o=SV(r,3);e=AV(e),r=function(a){return o(i[a],a,i)}}var s=t(e,r,n);return s>-1?i[o?e[s]:s]:void 0}}vb.exports=LV});var Ib=d((lge,Cb)=>{var bV=/\s/;function vV(t){for(var e=t.length;e--&&bV.test(t.charAt(e)););return e}Cb.exports=vV});var wb=d((cge,Rb)=>{var NV=Ib(),CV=/^\s+/;function IV(t){return t&&t.slice(0,NV(t)+1).replace(CV,"")}Rb.exports=IV});var Ub=d((uge,Mb)=>{var RV=wb(),kb=yt(),wV=En(),_b=NaN,kV=/^[-+]0x[0-9a-f]+$/i,_V=/^0b[01]+$/i,MV=/^0o[0-7]+$/i,UV=parseInt;function PV(t){if(typeof t=="number")return t;if(wV(t))return _b;if(kb(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=kb(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=RV(t);var r=_V.test(t);return r||MV.test(t)?UV(t.slice(2),r?2:8):kV.test(t)?_b:+t}Mb.exports=PV});var kf=d((hge,qb)=>{var qV=Ub(),Pb=1/0,DV=17976931348623157e292;function FV(t){if(!t)return t===0?t:0;if(t=qV(t),t===Pb||t===-Pb){var e=t<0?-1:1;return e*DV}return t===t?t:0}qb.exports=FV});var Fb=d((fge,Db)=>{var BV=kf();function $V(t){var e=BV(t),r=e%1;return e===e?r?e-r:e:0}Db.exports=$V});var $b=d((dge,Bb)=>{var KV=Of(),GV=ir(),jV=Fb(),WV=Math.max;function HV(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=r==null?0:jV(r);return i<0&&(i=WV(n+i,0)),KV(t,GV(e,3),i)}Bb.exports=HV});var Gb=d((pge,Kb)=>{var zV=Nb(),VV=$b(),YV=zV(VV);Kb.exports=YV});var _f=d((mge,jb)=>{var XV=Cl();function QV(t){var e=t==null?0:t.length;return e?XV(t,1):[]}jb.exports=QV});var Hb=d((gge,Wb)=>{var ZV=Ol(),JV=Yh(),eY=zr();function tY(t,e){return t==null?t:ZV(t,JV(e),eY)}Wb.exports=tY});var Vb=d((xge,zb)=>{function rY(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}zb.exports=rY});var Xb=d((Ege,Yb)=>{var nY=No(),iY=Al(),oY=ir();function sY(t,e){var r={};return e=oY(e,3),iY(t,function(n,i,o){nY(r,i,e(n,i,o))}),r}Yb.exports=sY});var Ul=d((yge,Qb)=>{var aY=En();function lY(t,e,r){for(var n=-1,i=t.length;++n<i;){var o=t[n],s=e(o);if(s!=null&&(a===void 0?s===s&&!aY(s):r(s,a)))var a=s,c=o}return c}Qb.exports=lY});var Jb=d((Tge,Zb)=>{function cY(t,e){return t>e}Zb.exports=cY});var tv=d((Sge,ev)=>{var uY=Ul(),hY=Jb(),fY=Vr();function dY(t){return t&&t.length?uY(t,fY,hY):void 0}ev.exports=dY});var Mf=d((Oge,rv)=>{var pY=No(),mY=dn();function gY(t,e,r){(r!==void 0&&!mY(t[e],r)||r===void 0&&!(e in t))&&pY(t,e,r)}rv.exports=gY});var ov=d((Age,iv)=>{var xY=Wr(),EY=Po(),yY=Dt(),TY="[object Object]",SY=Function.prototype,OY=Object.prototype,nv=SY.toString,AY=OY.hasOwnProperty,LY=nv.call(Object);function bY(t){if(!yY(t)||xY(t)!=TY)return!1;var e=EY(t);if(e===null)return!0;var r=AY.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&nv.call(r)==LY}iv.exports=bY});var Uf=d((Lge,sv)=>{function vY(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}sv.exports=vY});var lv=d((bge,av)=>{var NY=yi(),CY=zr();function IY(t){return NY(t,CY(t))}av.exports=IY});var pv=d((vge,dv)=>{var cv=Mf(),RY=wh(),wY=Wh(),kY=kh(),_Y=zh(),uv=Ti(),hv=Me(),MY=Lf(),UY=mn(),PY=mi(),qY=yt(),DY=ov(),FY=Ai(),fv=Uf(),BY=lv();function $Y(t,e,r,n,i,o,s){var a=fv(t,r),c=fv(e,r),l=s.get(c);if(l){cv(t,r,l);return}var h=o?o(a,c,r+"",t,e,s):void 0,u=h===void 0;if(u){var f=hv(c),m=!f&&UY(c),p=!f&&!m&&FY(c);h=c,f||m||p?hv(a)?h=a:MY(a)?h=kY(a):m?(u=!1,h=RY(c,!0)):p?(u=!1,h=wY(c,!0)):h=[]:DY(c)||uv(c)?(h=a,uv(a)?h=BY(a):(!qY(a)||PY(a))&&(h=_Y(c))):u=!1}u&&(s.set(c,h),i(h,c,n,o,s),s.delete(c)),cv(t,r,h)}dv.exports=$Y});var xv=d((Nge,gv)=>{var KY=vo(),GY=Mf(),jY=Ol(),WY=pv(),HY=yt(),zY=zr(),VY=Uf();function mv(t,e,r,n,i){t!==e&&jY(e,function(o,s){if(i||(i=new KY),HY(o))WY(t,e,s,r,mv,n,i);else{var a=n?n(VY(t,s),o,s+"",t,e,i):void 0;a===void 0&&(a=o),GY(t,s,a)}},zY)}gv.exports=mv});var yv=d((Cge,Ev)=>{var YY=$o(),XY=jo();function QY(t){return YY(function(e,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(o=t.length>3&&typeof o=="function"?(i--,o):void 0,s&&XY(r[0],r[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++n<i;){var a=r[n];a&&t(e,a,n,o)}return e})}Ev.exports=QY});var Sv=d((Ige,Tv)=>{var ZY=xv(),JY=yv(),eX=JY(function(t,e,r){ZY(t,e,r)});Tv.exports=eX});var Pf=d((Rge,Ov)=>{function tX(t,e){return t<e}Ov.exports=tX});var Lv=d((wge,Av)=>{var rX=Ul(),nX=Pf(),iX=Vr();function oX(t){return t&&t.length?rX(t,iX,nX):void 0}Av.exports=oX});var vv=d((kge,bv)=>{var sX=Ul(),aX=ir(),lX=Pf();function cX(t,e){return t&&t.length?sX(t,aX(e,2),lX):void 0}bv.exports=cX});var Cv=d((_ge,Nv)=>{var uX=Rt(),hX=function(){return uX.Date.now()};Nv.exports=hX});var wv=d((Mge,Rv)=>{var fX=Co(),dX=Fo(),pX=Ro(),Iv=yt(),mX=vi();function gX(t,e,r,n){if(!Iv(t))return t;e=dX(e,t);for(var i=-1,o=e.length,s=o-1,a=t;a!=null&&++i<o;){var c=mX(e[i]),l=r;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(i!=s){var h=a[c];l=n?n(h,c,a):void 0,l===void 0&&(l=Iv(h)?h:pX(e[i+1])?[]:{})}fX(a,c,l),a=a[c]}return t}Rv.exports=gX});var _v=d((Uge,kv)=>{var xX=Bo(),EX=wv(),yX=Fo();function TX(t,e,r){for(var n=-1,i=e.length,o={};++n<i;){var s=e[n],a=xX(t,s);r(a,s)&&EX(o,yX(s,t),a)}return o}kv.exports=TX});var Uv=d((Pge,Mv)=>{var SX=_v(),OX=uf();function AX(t,e){return SX(t,e,function(r,n){return OX(t,n)})}Mv.exports=AX});var qv=d((qge,Pv)=>{var LX=_f(),bX=Tf(),vX=Sf();function NX(t){return vX(bX(t,void 0,LX),t+"")}Pv.exports=NX});var Fv=d((Dge,Dv)=>{var CX=Uv(),IX=qv(),RX=IX(function(t,e){return t==null?{}:CX(t,e)});Dv.exports=RX});var $v=d((Fge,Bv)=>{var wX=Math.ceil,kX=Math.max;function _X(t,e,r,n){for(var i=-1,o=kX(wX((e-t)/(r||1)),0),s=Array(o);o--;)s[n?o:++i]=t,t+=r;return s}Bv.exports=_X});var Gv=d((Bge,Kv)=>{var MX=$v(),UX=jo(),qf=kf();function PX(t){return function(e,r,n){return n&&typeof n!="number"&&UX(e,r,n)&&(r=n=void 0),e=qf(e),r===void 0?(r=e,e=0):r=qf(r),n=n===void 0?e<r?1:-1:qf(n),MX(e,r,n,t)}}Kv.exports=PX});var Wv=d(($ge,jv)=>{var qX=Gv(),DX=qX();jv.exports=DX});var zv=d((Kge,Hv)=>{function FX(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}Hv.exports=FX});var Xv=d((Gge,Yv)=>{var Vv=En();function BX(t,e){if(t!==e){var r=t!==void 0,n=t===null,i=t===t,o=Vv(t),s=e!==void 0,a=e===null,c=e===e,l=Vv(e);if(!a&&!l&&!o&&t>e||o&&s&&c&&!a&&!l||n&&s&&c||!r&&c||!i)return 1;if(!n&&!o&&!l&&t<e||l&&r&&i&&!n&&!o||a&&r&&i||!s&&i||!c)return-1}return 0}Yv.exports=BX});var Zv=d((jge,Qv)=>{var $X=Xv();function KX(t,e,r){for(var n=-1,i=t.criteria,o=e.criteria,s=i.length,a=r.length;++n<s;){var c=$X(i[n],o[n]);if(c){if(n>=a)return c;var l=r[n];return c*(l=="desc"?-1:1)}}return t.index-e.index}Qv.exports=KX});var eN=d((Wge,Jv)=>{var Df=Do(),GX=Bo(),jX=ir(),WX=mf(),HX=zv(),zX=wo(),VX=Zv(),YX=Vr(),XX=Me();function QX(t,e,r){e.length?e=Df(e,function(o){return XX(o)?function(s){return GX(s,o.length===1?o[0]:o)}:o}):e=[YX];var n=-1;e=Df(e,zX(jX));var i=WX(t,function(o,s,a){var c=Df(e,function(l){return l(o)});return{criteria:c,index:++n,value:o}});return HX(i,function(o,s){return VX(o,s,r)})}Jv.exports=QX});var nN=d((Hge,rN)=>{var ZX=Cl(),JX=eN(),e5=$o(),tN=jo(),t5=e5(function(t,e){if(t==null)return[];var r=e.length;return r>1&&tN(t,e[0],e[1])?e=[]:r>2&&tN(e[0],e[1],e[2])&&(e=[e[0]]),JX(t,ZX(e,1),[])});rN.exports=t5});var oN=d((zge,iN)=>{var r5=lf(),n5=0;function i5(t){var e=++n5;return r5(t)+e}iN.exports=i5});var aN=d((Vge,sN)=>{function o5(t,e,r){for(var n=-1,i=t.length,o=e.length,s={};++n<i;){var a=n<o?e[n]:void 0;r(s,t[n],a)}return s}sN.exports=o5});var cN=d((Yge,lN)=>{var s5=Co(),a5=aN();function l5(t,e){return a5(t||[],e||[],s5)}lN.exports=l5});var me=d((Xge,uN)=>{var Pl;if(typeof bn=="function")try{Pl={cloneDeep:Sb(),constant:Sl(),defaults:bb(),each:Qh(),filter:ff(),find:Gb(),flatten:_f(),forEach:Xh(),forIn:Hb(),has:df(),isUndefined:pf(),last:Vb(),map:gf(),mapValues:Xb(),max:tv(),merge:Sv(),min:Lv(),minBy:vv(),now:Cv(),pick:Fv(),range:Wv(),reduce:xf(),sortBy:nN(),uniqueId:oN(),values:bf(),zipObject:cN()}}catch{}Pl||(Pl=window._);uN.exports=Pl});var dN=d((Zge,fN)=>{fN.exports=ql;function ql(){var t={};t._next=t._prev=t,this._sentinel=t}ql.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return hN(e),e};ql.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&hN(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e};ql.prototype.toString=function(){for(var t=[],e=this._sentinel,r=e._prev;r!==e;)t.push(JSON.stringify(r,c5)),r=r._prev;return"["+t.join(", ")+"]"};function hN(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function c5(t,e){if(t!=="_next"&&t!=="_prev")return e}});var mN=d((Jge,pN)=>{var xr=me(),u5=kt().Graph,h5=dN();pN.exports=d5;var f5=xr.constant(1);function d5(t,e){if(t.nodeCount()<=1)return[];var r=m5(t,e||f5),n=p5(r.graph,r.buckets,r.zeroIdx);return xr.flatten(xr.map(n,function(i){return t.outEdges(i.v,i.w)}),!0)}function p5(t,e,r){for(var n=[],i=e[e.length-1],o=e[0],s;t.nodeCount();){for(;s=o.dequeue();)Ff(t,e,r,s);for(;s=i.dequeue();)Ff(t,e,r,s);if(t.nodeCount()){for(var a=e.length-2;a>0;--a)if(s=e[a].dequeue(),s){n=n.concat(Ff(t,e,r,s,!0));break}}}return n}function Ff(t,e,r,n,i){var o=i?[]:void 0;return xr.forEach(t.inEdges(n.v),function(s){var a=t.edge(s),c=t.node(s.v);i&&o.push({v:s.v,w:s.w}),c.out-=a,Bf(e,r,c)}),xr.forEach(t.outEdges(n.v),function(s){var a=t.edge(s),c=s.w,l=t.node(c);l.in-=a,Bf(e,r,l)}),t.removeNode(n.v),o}function m5(t,e){var r=new u5,n=0,i=0;xr.forEach(t.nodes(),function(a){r.setNode(a,{v:a,in:0,out:0})}),xr.forEach(t.edges(),function(a){var c=r.edge(a.v,a.w)||0,l=e(a),h=c+l;r.setEdge(a.v,a.w,h),i=Math.max(i,r.node(a.v).out+=l),n=Math.max(n,r.node(a.w).in+=l)});var o=xr.range(i+n+3).map(function(){return new h5}),s=n+1;return xr.forEach(r.nodes(),function(a){Bf(o,s,r.node(a))}),{graph:r,buckets:o,zeroIdx:s}}function Bf(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)}});var xN=d((exe,gN)=>{"use strict";var Tn=me(),g5=mN();gN.exports={run:x5,undo:y5};function x5(t){var e=t.graph().acyclicer==="greedy"?g5(t,r(t)):E5(t);Tn.forEach(e,function(n){var i=t.edge(n);t.removeEdge(n),i.forwardName=n.name,i.reversed=!0,t.setEdge(n.w,n.v,i,Tn.uniqueId("rev"))});function r(n){return function(i){return n.edge(i).weight}}}function E5(t){var e=[],r={},n={};function i(o){Tn.has(n,o)||(n[o]=!0,r[o]=!0,Tn.forEach(t.outEdges(o),function(s){Tn.has(r,s.w)?e.push(s):i(s.w)}),delete r[o])}return Tn.forEach(t.nodes(),i),e}function y5(t){Tn.forEach(t.edges(),function(e){var r=t.edge(e);if(r.reversed){t.removeEdge(e);var n=r.forwardName;delete r.reversed,delete r.forwardName,t.setEdge(e.w,e.v,r,n)}})}});var ht=d((txe,SN)=>{"use strict";var J=me(),EN=kt().Graph;SN.exports={addDummyNode:yN,simplify:T5,asNonCompoundGraph:S5,successorWeights:O5,predecessorWeights:A5,intersectRect:L5,buildLayerMatrix:b5,normalizeRanks:v5,removeEmptyRanks:N5,addBorderNode:C5,maxRank:TN,partition:I5,time:R5,notime:w5};function yN(t,e,r,n){var i;do i=J.uniqueId(n);while(t.hasNode(i));return r.dummy=e,t.setNode(i,r),i}function T5(t){var e=new EN().setGraph(t.graph());return J.forEach(t.nodes(),function(r){e.setNode(r,t.node(r))}),J.forEach(t.edges(),function(r){var n=e.edge(r.v,r.w)||{weight:0,minlen:1},i=t.edge(r);e.setEdge(r.v,r.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),e}function S5(t){var e=new EN({multigraph:t.isMultigraph()}).setGraph(t.graph());return J.forEach(t.nodes(),function(r){t.children(r).length||e.setNode(r,t.node(r))}),J.forEach(t.edges(),function(r){e.setEdge(r,t.edge(r))}),e}function O5(t){var e=J.map(t.nodes(),function(r){var n={};return J.forEach(t.outEdges(r),function(i){n[i.w]=(n[i.w]||0)+t.edge(i).weight}),n});return J.zipObject(t.nodes(),e)}function A5(t){var e=J.map(t.nodes(),function(r){var n={};return J.forEach(t.inEdges(r),function(i){n[i.v]=(n[i.v]||0)+t.edge(i).weight}),n});return J.zipObject(t.nodes(),e)}function L5(t,e){var r=t.x,n=t.y,i=e.x-r,o=e.y-n,s=t.width/2,a=t.height/2;if(!i&&!o)throw new Error("Not possible to find intersection inside of the rectangle");var c,l;return Math.abs(o)*s>Math.abs(i)*a?(o<0&&(a=-a),c=a*i/o,l=a):(i<0&&(s=-s),c=s,l=s*o/i),{x:r+c,y:n+l}}function b5(t){var e=J.map(J.range(TN(t)+1),function(){return[]});return J.forEach(t.nodes(),function(r){var n=t.node(r),i=n.rank;J.isUndefined(i)||(e[i][n.order]=r)}),e}function v5(t){var e=J.min(J.map(t.nodes(),function(r){return t.node(r).rank}));J.forEach(t.nodes(),function(r){var n=t.node(r);J.has(n,"rank")&&(n.rank-=e)})}function N5(t){var e=J.min(J.map(t.nodes(),function(o){return t.node(o).rank})),r=[];J.forEach(t.nodes(),function(o){var s=t.node(o).rank-e;r[s]||(r[s]=[]),r[s].push(o)});var n=0,i=t.graph().nodeRankFactor;J.forEach(r,function(o,s){J.isUndefined(o)&&s%i!==0?--n:n&&J.forEach(o,function(a){t.node(a).rank+=n})})}function C5(t,e,r,n){var i={width:0,height:0};return arguments.length>=4&&(i.rank=r,i.order=n),yN(t,"border",i,e)}function TN(t){return J.max(J.map(t.nodes(),function(e){var r=t.node(e).rank;if(!J.isUndefined(r))return r}))}function I5(t,e){var r={lhs:[],rhs:[]};return J.forEach(t,function(n){e(n)?r.lhs.push(n):r.rhs.push(n)}),r}function R5(t,e){var r=J.now();try{return e()}finally{console.log(t+" time: "+(J.now()-r)+"ms")}}function w5(t,e){return e()}});var LN=d((rxe,AN)=>{"use strict";var ON=me(),k5=ht();AN.exports={run:_5,undo:U5};function _5(t){t.graph().dummyChains=[],ON.forEach(t.edges(),function(e){M5(t,e)})}function M5(t,e){var r=e.v,n=t.node(r).rank,i=e.w,o=t.node(i).rank,s=e.name,a=t.edge(e),c=a.labelRank;if(o!==n+1){t.removeEdge(e);var l,h,u;for(u=0,++n;n<o;++u,++n)a.points=[],h={width:0,height:0,edgeLabel:a,edgeObj:e,rank:n},l=k5.addDummyNode(t,"edge",h,"_d"),n===c&&(h.width=a.width,h.height=a.height,h.dummy="edge-label",h.labelpos=a.labelpos),t.setEdge(r,l,{weight:a.weight},s),u===0&&t.graph().dummyChains.push(l),r=l;t.setEdge(r,i,{weight:a.weight},s)}}function U5(t){ON.forEach(t.graph().dummyChains,function(e){var r=t.node(e),n=r.edgeLabel,i;for(t.setEdge(r.edgeObj,n);r.dummy;)i=t.successors(e)[0],t.removeNode(e),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),e=i,r=t.node(e)})}});var Wo=d((nxe,bN)=>{"use strict";var Dl=me();bN.exports={longestPath:P5,slack:q5};function P5(t){var e={};function r(n){var i=t.node(n);if(Dl.has(e,n))return i.rank;e[n]=!0;var o=Dl.min(Dl.map(t.outEdges(n),function(s){return r(s.w)-t.edge(s).minlen}));return(o===Number.POSITIVE_INFINITY||o===void 0||o===null)&&(o=0),i.rank=o}Dl.forEach(t.sources(),r)}function q5(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}});var $f=d((ixe,vN)=>{"use strict";var Fl=me(),D5=kt().Graph,Bl=Wo().slack;vN.exports=F5;function F5(t){var e=new D5({directed:!1}),r=t.nodes()[0],n=t.nodeCount();e.setNode(r,{});for(var i,o;B5(e,t)<n;)i=$5(e,t),o=e.hasNode(i.v)?Bl(t,i):-Bl(t,i),K5(e,t,o);return e}function B5(t,e){function r(n){Fl.forEach(e.nodeEdges(n),function(i){var o=i.v,s=n===o?i.w:o;!t.hasNode(s)&&!Bl(e,i)&&(t.setNode(s,{}),t.setEdge(n,s,{}),r(s))})}return Fl.forEach(t.nodes(),r),t.nodeCount()}function $5(t,e){return Fl.minBy(e.edges(),function(r){if(t.hasNode(r.v)!==t.hasNode(r.w))return Bl(e,r)})}function K5(t,e,r){Fl.forEach(t.nodes(),function(n){e.node(n).rank+=r})}});var MN=d((oxe,_N)=>{"use strict";var Er=me(),G5=$f(),j5=Wo().slack,W5=Wo().longestPath,H5=kt().alg.preorder,z5=kt().alg.postorder,V5=ht().simplify;_N.exports=Sn;Sn.initLowLimValues=Gf;Sn.initCutValues=Kf;Sn.calcCutValue=CN;Sn.leaveEdge=RN;Sn.enterEdge=wN;Sn.exchangeEdges=kN;function Sn(t){t=V5(t),W5(t);var e=G5(t);Gf(e),Kf(e,t);for(var r,n;r=RN(e);)n=wN(e,t,r),kN(e,t,r,n)}function Kf(t,e){var r=z5(t,t.nodes());r=r.slice(0,r.length-1),Er.forEach(r,function(n){Y5(t,e,n)})}function Y5(t,e,r){var n=t.node(r),i=n.parent;t.edge(r,i).cutvalue=CN(t,e,r)}function CN(t,e,r){var n=t.node(r),i=n.parent,o=!0,s=e.edge(r,i),a=0;return s||(o=!1,s=e.edge(i,r)),a=s.weight,Er.forEach(e.nodeEdges(r),function(c){var l=c.v===r,h=l?c.w:c.v;if(h!==i){var u=l===o,f=e.edge(c).weight;if(a+=u?f:-f,Q5(t,r,h)){var m=t.edge(r,h).cutvalue;a+=u?-m:m}}}),a}function Gf(t,e){arguments.length<2&&(e=t.nodes()[0]),IN(t,{},1,e)}function IN(t,e,r,n,i){var o=r,s=t.node(n);return e[n]=!0,Er.forEach(t.neighbors(n),function(a){Er.has(e,a)||(r=IN(t,e,r,a,n))}),s.low=o,s.lim=r++,i?s.parent=i:delete s.parent,r}function RN(t){return Er.find(t.edges(),function(e){return t.edge(e).cutvalue<0})}function wN(t,e,r){var n=r.v,i=r.w;e.hasEdge(n,i)||(n=r.w,i=r.v);var o=t.node(n),s=t.node(i),a=o,c=!1;o.lim>s.lim&&(a=s,c=!0);var l=Er.filter(e.edges(),function(h){return c===NN(t,t.node(h.v),a)&&c!==NN(t,t.node(h.w),a)});return Er.minBy(l,function(h){return j5(e,h)})}function kN(t,e,r,n){var i=r.v,o=r.w;t.removeEdge(i,o),t.setEdge(n.v,n.w,{}),Gf(t),Kf(t,e),X5(t,e)}function X5(t,e){var r=Er.find(t.nodes(),function(i){return!e.node(i).parent}),n=H5(t,r);n=n.slice(1),Er.forEach(n,function(i){var o=t.node(i).parent,s=e.edge(i,o),a=!1;s||(s=e.edge(o,i),a=!0),e.node(i).rank=e.node(o).rank+(a?s.minlen:-s.minlen)})}function Q5(t,e,r){return t.hasEdge(e,r)}function NN(t,e,r){return r.low<=e.lim&&e.lim<=r.lim}});var DN=d((sxe,qN)=>{"use strict";var Z5=Wo(),PN=Z5.longestPath,J5=$f(),e6=MN();qN.exports=t6;function t6(t){switch(t.graph().ranker){case"network-simplex":UN(t);break;case"tight-tree":n6(t);break;case"longest-path":r6(t);break;default:UN(t)}}var r6=PN;function n6(t){PN(t),J5(t)}function UN(t){e6(t)}});var BN=d((axe,FN)=>{var jf=me();FN.exports=i6;function i6(t){var e=s6(t);jf.forEach(t.graph().dummyChains,function(r){for(var n=t.node(r),i=n.edgeObj,o=o6(t,e,i.v,i.w),s=o.path,a=o.lca,c=0,l=s[c],h=!0;r!==i.w;){if(n=t.node(r),h){for(;(l=s[c])!==a&&t.node(l).maxRank<n.rank;)c++;l===a&&(h=!1)}if(!h){for(;c<s.length-1&&t.node(l=s[c+1]).minRank<=n.rank;)c++;l=s[c]}t.setParent(r,l),r=t.successors(r)[0]}})}function o6(t,e,r,n){var i=[],o=[],s=Math.min(e[r].low,e[n].low),a=Math.max(e[r].lim,e[n].lim),c,l;c=r;do c=t.parent(c),i.push(c);while(c&&(e[c].low>s||a>e[c].lim));for(l=c,c=n;(c=t.parent(c))!==l;)o.push(c);return{path:i.concat(o.reverse()),lca:l}}function s6(t){var e={},r=0;function n(i){var o=r;jf.forEach(t.children(i),n),e[i]={low:o,lim:r++}}return jf.forEach(t.children(),n),e}});var GN=d((lxe,KN)=>{var yr=me(),Wf=ht();KN.exports={run:a6,cleanup:u6};function a6(t){var e=Wf.addDummyNode(t,"root",{},"_root"),r=l6(t),n=yr.max(yr.values(r))-1,i=2*n+1;t.graph().nestingRoot=e,yr.forEach(t.edges(),function(s){t.edge(s).minlen*=i});var o=c6(t)+1;yr.forEach(t.children(),function(s){$N(t,e,i,o,n,r,s)}),t.graph().nodeRankFactor=i}function $N(t,e,r,n,i,o,s){var a=t.children(s);if(!a.length){s!==e&&t.setEdge(e,s,{weight:0,minlen:r});return}var c=Wf.addBorderNode(t,"_bt"),l=Wf.addBorderNode(t,"_bb"),h=t.node(s);t.setParent(c,s),h.borderTop=c,t.setParent(l,s),h.borderBottom=l,yr.forEach(a,function(u){$N(t,e,r,n,i,o,u);var f=t.node(u),m=f.borderTop?f.borderTop:u,p=f.borderBottom?f.borderBottom:u,g=f.borderTop?n:2*n,E=m!==p?1:i-o[s]+1;t.setEdge(c,m,{weight:g,minlen:E,nestingEdge:!0}),t.setEdge(p,l,{weight:g,minlen:E,nestingEdge:!0})}),t.parent(s)||t.setEdge(e,c,{weight:0,minlen:i+o[s]})}function l6(t){var e={};function r(n,i){var o=t.children(n);o&&o.length&&yr.forEach(o,function(s){r(s,i+1)}),e[n]=i}return yr.forEach(t.children(),function(n){r(n,1)}),e}function c6(t){return yr.reduce(t.edges(),function(e,r){return e+t.edge(r).weight},0)}function u6(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,yr.forEach(t.edges(),function(r){var n=t.edge(r);n.nestingEdge&&t.removeEdge(r)})}});var HN=d((cxe,WN)=>{var Hf=me(),h6=ht();WN.exports=f6;function f6(t){function e(r){var n=t.children(r),i=t.node(r);if(n.length&&Hf.forEach(n,e),Hf.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var o=i.minRank,s=i.maxRank+1;o<s;++o)jN(t,"borderLeft","_bl",r,i,o),jN(t,"borderRight","_br",r,i,o)}}Hf.forEach(t.children(),e)}function jN(t,e,r,n,i,o){var s={width:0,height:0,rank:o,borderType:e},a=i[e][o-1],c=h6.addDummyNode(t,"border",s,r);i[e][o]=c,t.setParent(c,n),a&&t.setEdge(a,c,{weight:1})}});var XN=d((uxe,YN)=>{"use strict";var sr=me();YN.exports={adjust:d6,undo:p6};function d6(t){var e=t.graph().rankdir.toLowerCase();(e==="lr"||e==="rl")&&VN(t)}function p6(t){var e=t.graph().rankdir.toLowerCase();(e==="bt"||e==="rl")&&m6(t),(e==="lr"||e==="rl")&&(g6(t),VN(t))}function VN(t){sr.forEach(t.nodes(),function(e){zN(t.node(e))}),sr.forEach(t.edges(),function(e){zN(t.edge(e))})}function zN(t){var e=t.width;t.width=t.height,t.height=e}function m6(t){sr.forEach(t.nodes(),function(e){zf(t.node(e))}),sr.forEach(t.edges(),function(e){var r=t.edge(e);sr.forEach(r.points,zf),sr.has(r,"y")&&zf(r)})}function zf(t){t.y=-t.y}function g6(t){sr.forEach(t.nodes(),function(e){Vf(t.node(e))}),sr.forEach(t.edges(),function(e){var r=t.edge(e);sr.forEach(r.points,Vf),sr.has(r,"x")&&Vf(r)})}function Vf(t){var e=t.x;t.x=t.y,t.y=e}});var ZN=d((hxe,QN)=>{"use strict";var Tr=me();QN.exports=x6;function x6(t){var e={},r=Tr.filter(t.nodes(),function(a){return!t.children(a).length}),n=Tr.max(Tr.map(r,function(a){return t.node(a).rank})),i=Tr.map(Tr.range(n+1),function(){return[]});function o(a){if(!Tr.has(e,a)){e[a]=!0;var c=t.node(a);i[c.rank].push(a),Tr.forEach(t.successors(a),o)}}var s=Tr.sortBy(r,function(a){return t.node(a).rank});return Tr.forEach(s,o),i}});var eC=d((fxe,JN)=>{"use strict";var Yr=me();JN.exports=E6;function E6(t,e){for(var r=0,n=1;n<e.length;++n)r+=y6(t,e[n-1],e[n]);return r}function y6(t,e,r){for(var n=Yr.zipObject(r,Yr.map(r,function(l,h){return h})),i=Yr.flatten(Yr.map(e,function(l){return Yr.sortBy(Yr.map(t.outEdges(l),function(h){return{pos:n[h.w],weight:t.edge(h).weight}}),"pos")}),!0),o=1;o<r.length;)o<<=1;var s=2*o-1;o-=1;var a=Yr.map(new Array(s),function(){return 0}),c=0;return Yr.forEach(i.forEach(function(l){var h=l.pos+o;a[h]+=l.weight;for(var u=0;h>0;)h%2&&(u+=a[h+1]),h=h-1>>1,a[h]+=l.weight;c+=l.weight*u})),c}});var nC=d((dxe,rC)=>{var tC=me();rC.exports=T6;function T6(t,e){return tC.map(e,function(r){var n=t.inEdges(r);if(n.length){var i=tC.reduce(n,function(o,s){var a=t.edge(s),c=t.node(s.v);return{sum:o.sum+a.weight*c.order,weight:o.weight+a.weight}},{sum:0,weight:0});return{v:r,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:r}})}});var oC=d((pxe,iC)=>{"use strict";var St=me();iC.exports=S6;function S6(t,e){var r={};St.forEach(t,function(i,o){var s=r[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:o};St.isUndefined(i.barycenter)||(s.barycenter=i.barycenter,s.weight=i.weight)}),St.forEach(e.edges(),function(i){var o=r[i.v],s=r[i.w];!St.isUndefined(o)&&!St.isUndefined(s)&&(s.indegree++,o.out.push(r[i.w]))});var n=St.filter(r,function(i){return!i.indegree});return O6(n)}function O6(t){var e=[];function r(o){return function(s){s.merged||(St.isUndefined(s.barycenter)||St.isUndefined(o.barycenter)||s.barycenter>=o.barycenter)&&A6(o,s)}}function n(o){return function(s){s.in.push(o),--s.indegree===0&&t.push(s)}}for(;t.length;){var i=t.pop();e.push(i),St.forEach(i.in.reverse(),r(i)),St.forEach(i.out,n(i))}return St.map(St.filter(e,function(o){return!o.merged}),function(o){return St.pick(o,["vs","i","barycenter","weight"])})}function A6(t,e){var r=0,n=0;t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.vs=e.vs.concat(t.vs),t.barycenter=r/n,t.weight=n,t.i=Math.min(e.i,t.i),e.merged=!0}});var lC=d((mxe,aC)=>{var Ho=me(),L6=ht();aC.exports=b6;function b6(t,e){var r=L6.partition(t,function(h){return Ho.has(h,"barycenter")}),n=r.lhs,i=Ho.sortBy(r.rhs,function(h){return-h.i}),o=[],s=0,a=0,c=0;n.sort(v6(!!e)),c=sC(o,i,c),Ho.forEach(n,function(h){c+=h.vs.length,o.push(h.vs),s+=h.barycenter*h.weight,a+=h.weight,c=sC(o,i,c)});var l={vs:Ho.flatten(o,!0)};return a&&(l.barycenter=s/a,l.weight=a),l}function sC(t,e,r){for(var n;e.length&&(n=Ho.last(e)).i<=r;)e.pop(),t.push(n.vs),r++;return r}function v6(t){return function(e,r){return e.barycenter<r.barycenter?-1:e.barycenter>r.barycenter?1:t?r.i-e.i:e.i-r.i}}});var hC=d((gxe,uC)=>{var Xr=me(),N6=nC(),C6=oC(),I6=lC();uC.exports=cC;function cC(t,e,r,n){var i=t.children(e),o=t.node(e),s=o?o.borderLeft:void 0,a=o?o.borderRight:void 0,c={};s&&(i=Xr.filter(i,function(p){return p!==s&&p!==a}));var l=N6(t,i);Xr.forEach(l,function(p){if(t.children(p.v).length){var g=cC(t,p.v,r,n);c[p.v]=g,Xr.has(g,"barycenter")&&w6(p,g)}});var h=C6(l,r);R6(h,c);var u=I6(h,n);if(s&&(u.vs=Xr.flatten([s,u.vs,a],!0),t.predecessors(s).length)){var f=t.node(t.predecessors(s)[0]),m=t.node(t.predecessors(a)[0]);Xr.has(u,"barycenter")||(u.barycenter=0,u.weight=0),u.barycenter=(u.barycenter*u.weight+f.order+m.order)/(u.weight+2),u.weight+=2}return u}function R6(t,e){Xr.forEach(t,function(r){r.vs=Xr.flatten(r.vs.map(function(n){return e[n]?e[n].vs:n}),!0)})}function w6(t,e){Xr.isUndefined(t.barycenter)?(t.barycenter=e.barycenter,t.weight=e.weight):(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight)}});var dC=d((xxe,fC)=>{var zo=me(),k6=kt().Graph;fC.exports=_6;function _6(t,e,r){var n=M6(t),i=new k6({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(o){return t.node(o)});return zo.forEach(t.nodes(),function(o){var s=t.node(o),a=t.parent(o);(s.rank===e||s.minRank<=e&&e<=s.maxRank)&&(i.setNode(o),i.setParent(o,a||n),zo.forEach(t[r](o),function(c){var l=c.v===o?c.w:c.v,h=i.edge(l,o),u=zo.isUndefined(h)?0:h.weight;i.setEdge(l,o,{weight:t.edge(c).weight+u})}),zo.has(s,"minRank")&&i.setNode(o,{borderLeft:s.borderLeft[e],borderRight:s.borderRight[e]}))}),i}function M6(t){for(var e;t.hasNode(e=zo.uniqueId("_root")););return e}});var mC=d((Exe,pC)=>{var U6=me();pC.exports=P6;function P6(t,e,r){var n={},i;U6.forEach(r,function(o){for(var s=t.parent(o),a,c;s;){if(a=t.parent(s),a?(c=n[a],n[a]=s):(c=i,i=s),c&&c!==s){e.setEdge(c,s);return}s=a}})}});var TC=d((yxe,yC)=>{"use strict";var Qr=me(),q6=ZN(),D6=eC(),F6=hC(),B6=dC(),$6=mC(),K6=kt().Graph,gC=ht();yC.exports=G6;function G6(t){var e=gC.maxRank(t),r=xC(t,Qr.range(1,e+1),"inEdges"),n=xC(t,Qr.range(e-1,-1,-1),"outEdges"),i=q6(t);EC(t,i);for(var o=Number.POSITIVE_INFINITY,s,a=0,c=0;c<4;++a,++c){j6(a%2?r:n,a%4>=2),i=gC.buildLayerMatrix(t);var l=D6(t,i);l<o&&(c=0,s=Qr.cloneDeep(i),o=l)}EC(t,s)}function xC(t,e,r){return Qr.map(e,function(n){return B6(t,n,r)})}function j6(t,e){var r=new K6;Qr.forEach(t,function(n){var i=n.graph().root,o=F6(n,i,r,e);Qr.forEach(o.vs,function(s,a){n.node(s).order=a}),$6(n,r,o.vs)})}function EC(t,e){Qr.forEach(e,function(r){Qr.forEach(r,function(n,i){t.node(n).order=i})})}});var RC=d((Txe,IC)=>{"use strict";var F=me(),W6=kt().Graph,H6=ht();IC.exports={positionX:Y6,findType1Conflicts:SC,findType2Conflicts:OC,addConflict:Yf,hasConflict:AC,verticalAlignment:LC,horizontalCompaction:bC,alignCoordinates:NC,findSmallestWidthAlignment:vC,balance:CC};function SC(t,e){var r={};function n(i,o){var s=0,a=0,c=i.length,l=F.last(o);return F.forEach(o,function(h,u){var f=z6(t,h),m=f?t.node(f).order:c;(f||h===l)&&(F.forEach(o.slice(a,u+1),function(p){F.forEach(t.predecessors(p),function(g){var E=t.node(g),x=E.order;(x<s||m<x)&&!(E.dummy&&t.node(p).dummy)&&Yf(r,g,p)})}),a=u+1,s=m)}),o}return F.reduce(e,n),r}function OC(t,e){var r={};function n(o,s,a,c,l){var h;F.forEach(F.range(s,a),function(u){h=o[u],t.node(h).dummy&&F.forEach(t.predecessors(h),function(f){var m=t.node(f);m.dummy&&(m.order<c||m.order>l)&&Yf(r,f,h)})})}function i(o,s){var a=-1,c,l=0;return F.forEach(s,function(h,u){if(t.node(h).dummy==="border"){var f=t.predecessors(h);f.length&&(c=t.node(f[0]).order,n(s,l,u,a,c),l=u,a=c)}n(s,l,s.length,c,o.length)}),s}return F.reduce(e,i),r}function z6(t,e){if(t.node(e).dummy)return F.find(t.predecessors(e),function(r){return t.node(r).dummy})}function Yf(t,e,r){if(e>r){var n=e;e=r,r=n}var i=t[e];i||(t[e]=i={}),i[r]=!0}function AC(t,e,r){if(e>r){var n=e;e=r,r=n}return F.has(t[e],r)}function LC(t,e,r,n){var i={},o={},s={};return F.forEach(e,function(a){F.forEach(a,function(c,l){i[c]=c,o[c]=c,s[c]=l})}),F.forEach(e,function(a){var c=-1;F.forEach(a,function(l){var h=n(l);if(h.length){h=F.sortBy(h,function(g){return s[g]});for(var u=(h.length-1)/2,f=Math.floor(u),m=Math.ceil(u);f<=m;++f){var p=h[f];o[l]===l&&c<s[p]&&!AC(r,l,p)&&(o[p]=l,o[l]=i[l]=i[p],c=s[p])}}})}),{root:i,align:o}}function bC(t,e,r,n,i){var o={},s=V6(t,e,r,i),a=i?"borderLeft":"borderRight";function c(u,f){for(var m=s.nodes(),p=m.pop(),g={};p;)g[p]?u(p):(g[p]=!0,m.push(p),m=m.concat(f(p))),p=m.pop()}function l(u){o[u]=s.inEdges(u).reduce(function(f,m){return Math.max(f,o[m.v]+s.edge(m))},0)}function h(u){var f=s.outEdges(u).reduce(function(p,g){return Math.min(p,o[g.w]-s.edge(g))},Number.POSITIVE_INFINITY),m=t.node(u);f!==Number.POSITIVE_INFINITY&&m.borderType!==a&&(o[u]=Math.max(o[u],f))}return c(l,s.predecessors.bind(s)),c(h,s.successors.bind(s)),F.forEach(n,function(u){o[u]=o[r[u]]}),o}function V6(t,e,r,n){var i=new W6,o=t.graph(),s=X6(o.nodesep,o.edgesep,n);return F.forEach(e,function(a){var c;F.forEach(a,function(l){var h=r[l];if(i.setNode(h),c){var u=r[c],f=i.edge(u,h);i.setEdge(u,h,Math.max(s(t,l,c),f||0))}c=l})}),i}function vC(t,e){return F.minBy(F.values(e),function(r){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return F.forIn(r,function(o,s){var a=Q6(t,s)/2;n=Math.max(o+a,n),i=Math.min(o-a,i)}),n-i})}function NC(t,e){var r=F.values(e),n=F.min(r),i=F.max(r);F.forEach(["u","d"],function(o){F.forEach(["l","r"],function(s){var a=o+s,c=t[a],l;if(c!==e){var h=F.values(c);l=s==="l"?n-F.min(h):i-F.max(h),l&&(t[a]=F.mapValues(c,function(u){return u+l}))}})})}function CC(t,e){return F.mapValues(t.ul,function(r,n){if(e)return t[e.toLowerCase()][n];var i=F.sortBy(F.map(t,n));return(i[1]+i[2])/2})}function Y6(t){var e=H6.buildLayerMatrix(t),r=F.merge(SC(t,e),OC(t,e)),n={},i;F.forEach(["u","d"],function(s){i=s==="u"?e:F.values(e).reverse(),F.forEach(["l","r"],function(a){a==="r"&&(i=F.map(i,function(u){return F.values(u).reverse()}));var c=(s==="u"?t.predecessors:t.successors).bind(t),l=LC(t,i,r,c),h=bC(t,i,l.root,l.align,a==="r");a==="r"&&(h=F.mapValues(h,function(u){return-u})),n[s+a]=h})});var o=vC(t,n);return NC(n,o),CC(n,t.graph().align)}function X6(t,e,r){return function(n,i,o){var s=n.node(i),a=n.node(o),c=0,l;if(c+=s.width/2,F.has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":l=-s.width/2;break;case"r":l=s.width/2;break}if(l&&(c+=r?l:-l),l=0,c+=(s.dummy?e:t)/2,c+=(a.dummy?e:t)/2,c+=a.width/2,F.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":l=a.width/2;break;case"r":l=-a.width/2;break}return l&&(c+=r?l:-l),l=0,c}}function Q6(t,e){return t.node(e).width}});var _C=d((Sxe,kC)=>{"use strict";var Vo=me(),wC=ht(),Z6=RC().positionX;kC.exports=J6;function J6(t){t=wC.asNonCompoundGraph(t),e8(t),Vo.forEach(Z6(t),function(e,r){t.node(r).x=e})}function e8(t){var e=wC.buildLayerMatrix(t),r=t.graph().ranksep,n=0;Vo.forEach(e,function(i){var o=Vo.max(Vo.map(i,function(s){return t.node(s).height}));Vo.forEach(i,function(s){t.node(s).y=n+o/2}),n+=o+r})}});var FC=d((Oxe,DC)=>{"use strict";var B=me(),MC=xN(),UC=LN(),t8=DN(),r8=ht().normalizeRanks,n8=BN(),i8=ht().removeEmptyRanks,PC=GN(),o8=HN(),qC=XN(),s8=TC(),a8=_C(),Zr=ht(),l8=kt().Graph;DC.exports=c8;function c8(t,e){var r=e&&e.debugTiming?Zr.time:Zr.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return T8(t)});r("  runLayout",function(){u8(n,r)}),r("  updateInputGraph",function(){h8(t,n)})})}function u8(t,e){e("    makeSpaceForEdgeLabels",function(){S8(t)}),e("    removeSelfEdges",function(){R8(t)}),e("    acyclic",function(){MC.run(t)}),e("    nestingGraph.run",function(){PC.run(t)}),e("    rank",function(){t8(Zr.asNonCompoundGraph(t))}),e("    injectEdgeLabelProxies",function(){O8(t)}),e("    removeEmptyRanks",function(){i8(t)}),e("    nestingGraph.cleanup",function(){PC.cleanup(t)}),e("    normalizeRanks",function(){r8(t)}),e("    assignRankMinMax",function(){A8(t)}),e("    removeEdgeLabelProxies",function(){L8(t)}),e("    normalize.run",function(){UC.run(t)}),e("    parentDummyChains",function(){n8(t)}),e("    addBorderSegments",function(){o8(t)}),e("    order",function(){s8(t)}),e("    insertSelfEdges",function(){w8(t)}),e("    adjustCoordinateSystem",function(){qC.adjust(t)}),e("    position",function(){a8(t)}),e("    positionSelfEdges",function(){k8(t)}),e("    removeBorderNodes",function(){I8(t)}),e("    normalize.undo",function(){UC.undo(t)}),e("    fixupEdgeLabelCoords",function(){N8(t)}),e("    undoCoordinateSystem",function(){qC.undo(t)}),e("    translateGraph",function(){b8(t)}),e("    assignNodeIntersects",function(){v8(t)}),e("    reversePoints",function(){C8(t)}),e("    acyclic.undo",function(){MC.undo(t)})}function h8(t,e){B.forEach(t.nodes(),function(r){var n=t.node(r),i=e.node(r);n&&(n.x=i.x,n.y=i.y,e.children(r).length&&(n.width=i.width,n.height=i.height))}),B.forEach(t.edges(),function(r){var n=t.edge(r),i=e.edge(r);n.points=i.points,B.has(i,"x")&&(n.x=i.x,n.y=i.y)}),t.graph().width=e.graph().width,t.graph().height=e.graph().height}var f8=["nodesep","edgesep","ranksep","marginx","marginy"],d8={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},p8=["acyclicer","ranker","rankdir","align"],m8=["width","height"],g8={width:0,height:0},x8=["minlen","weight","width","height","labeloffset"],E8={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},y8=["labelpos"];function T8(t){var e=new l8({multigraph:!0,compound:!0}),r=Qf(t.graph());return e.setGraph(B.merge({},d8,Xf(r,f8),B.pick(r,p8))),B.forEach(t.nodes(),function(n){var i=Qf(t.node(n));e.setNode(n,B.defaults(Xf(i,m8),g8)),e.setParent(n,t.parent(n))}),B.forEach(t.edges(),function(n){var i=Qf(t.edge(n));e.setEdge(n,B.merge({},E8,Xf(i,x8),B.pick(i,y8)))}),e}function S8(t){var e=t.graph();e.ranksep/=2,B.forEach(t.edges(),function(r){var n=t.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(e.rankdir==="TB"||e.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function O8(t){B.forEach(t.edges(),function(e){var r=t.edge(e);if(r.width&&r.height){var n=t.node(e.v),i=t.node(e.w),o={rank:(i.rank-n.rank)/2+n.rank,e};Zr.addDummyNode(t,"edge-proxy",o,"_ep")}})}function A8(t){var e=0;B.forEach(t.nodes(),function(r){var n=t.node(r);n.borderTop&&(n.minRank=t.node(n.borderTop).rank,n.maxRank=t.node(n.borderBottom).rank,e=B.max(e,n.maxRank))}),t.graph().maxRank=e}function L8(t){B.forEach(t.nodes(),function(e){var r=t.node(e);r.dummy==="edge-proxy"&&(t.edge(r.e).labelRank=r.rank,t.removeNode(e))})}function b8(t){var e=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,i=0,o=t.graph(),s=o.marginx||0,a=o.marginy||0;function c(l){var h=l.x,u=l.y,f=l.width,m=l.height;e=Math.min(e,h-f/2),r=Math.max(r,h+f/2),n=Math.min(n,u-m/2),i=Math.max(i,u+m/2)}B.forEach(t.nodes(),function(l){c(t.node(l))}),B.forEach(t.edges(),function(l){var h=t.edge(l);B.has(h,"x")&&c(h)}),e-=s,n-=a,B.forEach(t.nodes(),function(l){var h=t.node(l);h.x-=e,h.y-=n}),B.forEach(t.edges(),function(l){var h=t.edge(l);B.forEach(h.points,function(u){u.x-=e,u.y-=n}),B.has(h,"x")&&(h.x-=e),B.has(h,"y")&&(h.y-=n)}),o.width=r-e+s,o.height=i-n+a}function v8(t){B.forEach(t.edges(),function(e){var r=t.edge(e),n=t.node(e.v),i=t.node(e.w),o,s;r.points?(o=r.points[0],s=r.points[r.points.length-1]):(r.points=[],o=i,s=n),r.points.unshift(Zr.intersectRect(n,o)),r.points.push(Zr.intersectRect(i,s))})}function N8(t){B.forEach(t.edges(),function(e){var r=t.edge(e);if(B.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function C8(t){B.forEach(t.edges(),function(e){var r=t.edge(e);r.reversed&&r.points.reverse()})}function I8(t){B.forEach(t.nodes(),function(e){if(t.children(e).length){var r=t.node(e),n=t.node(r.borderTop),i=t.node(r.borderBottom),o=t.node(B.last(r.borderLeft)),s=t.node(B.last(r.borderRight));r.width=Math.abs(s.x-o.x),r.height=Math.abs(i.y-n.y),r.x=o.x+r.width/2,r.y=n.y+r.height/2}}),B.forEach(t.nodes(),function(e){t.node(e).dummy==="border"&&t.removeNode(e)})}function R8(t){B.forEach(t.edges(),function(e){if(e.v===e.w){var r=t.node(e.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e,label:t.edge(e)}),t.removeEdge(e)}})}function w8(t){var e=Zr.buildLayerMatrix(t);B.forEach(e,function(r){var n=0;B.forEach(r,function(i,o){var s=t.node(i);s.order=o+n,B.forEach(s.selfEdges,function(a){Zr.addDummyNode(t,"selfedge",{width:a.label.width,height:a.label.height,rank:s.rank,order:o+ ++n,e:a.e,label:a.label},"_se")}),delete s.selfEdges})})}function k8(t){B.forEach(t.nodes(),function(e){var r=t.node(e);if(r.dummy==="selfedge"){var n=t.node(r.e.v),i=n.x+n.width/2,o=n.y,s=r.x-i,a=n.height/2;t.setEdge(r.e,r.label),t.removeNode(e),r.label.points=[{x:i+2*s/3,y:o-a},{x:i+5*s/6,y:o-a},{x:i+s,y:o},{x:i+5*s/6,y:o+a},{x:i+2*s/3,y:o+a}],r.label.x=r.x,r.label.y=r.y}})}function Xf(t,e){return B.mapValues(B.pick(t,e),Number)}function Qf(t){var e={};return B.forEach(t,function(r,n){e[n.toLowerCase()]=r}),e}});var $C=d((Axe,BC)=>{var $l=me(),_8=ht(),M8=kt().Graph;BC.exports={debugOrdering:U8};function U8(t){var e=_8.buildLayerMatrix(t),r=new M8({compound:!0,multigraph:!0}).setGraph({});return $l.forEach(t.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+t.node(n).rank)}),$l.forEach(t.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),$l.forEach(e,function(n,i){var o="layer"+i;r.setNode(o,{rank:"same"}),$l.reduce(n,function(s,a){return r.setEdge(s,a,{style:"invis"}),a})}),r}});var GC=d((Lxe,KC)=>{KC.exports="0.8.5"});var WC=d((bxe,jC)=>{jC.exports={graphlib:kt(),layout:FC(),debug:$C(),util:{time:ht().time,notime:ht().notime},version:GC()}});var yI=typeof global=="object"&&global&&global.Object===Object&&global,es=yI;var TI=typeof self=="object"&&self&&self.Object===Object&&self,SI=es||TI||Function("return this")(),qe=SI;var OI=qe.Symbol,ze=OI;var xd=Object.prototype,AI=xd.hasOwnProperty,LI=xd.toString,Ni=ze?ze.toStringTag:void 0;function bI(t){var e=AI.call(t,Ni),r=t[Ni];try{t[Ni]=void 0;var n=!0}catch{}var i=LI.call(t);return n&&(e?t[Ni]=r:delete t[Ni]),i}var Ed=bI;var vI=Object.prototype,NI=vI.toString;function CI(t){return NI.call(t)}var yd=CI;var II="[object Null]",RI="[object Undefined]",Td=ze?ze.toStringTag:void 0;function wI(t){return t==null?t===void 0?RI:II:Td&&Td in Object(t)?Ed(t):yd(t)}var it=wI;function kI(t){return t!=null&&typeof t=="object"}var Re=kI;var _I="[object Symbol]";function MI(t){return typeof t=="symbol"||Re(t)&&it(t)==_I}var Lr=MI;function UI(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var $t=UI;var PI=Array.isArray,R=PI;var qI=1/0,Sd=ze?ze.prototype:void 0,Od=Sd?Sd.toString:void 0;function Ad(t){if(typeof t=="string")return t;if(R(t))return $t(t,Ad)+"";if(Lr(t))return Od?Od.call(t):"";var e=t+"";return e=="0"&&1/t==-qI?"-0":e}var Ld=Ad;var DI=/\s/;function FI(t){for(var e=t.length;e--&&DI.test(t.charAt(e)););return e}var bd=FI;var BI=/^\s+/;function $I(t){return t&&t.slice(0,bd(t)+1).replace(BI,"")}var vd=$I;function KI(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Oe=KI;var Nd=NaN,GI=/^[-+]0x[0-9a-f]+$/i,jI=/^0b[01]+$/i,WI=/^0o[0-7]+$/i,HI=parseInt;function zI(t){if(typeof t=="number")return t;if(Lr(t))return Nd;if(Oe(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Oe(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=vd(t);var r=jI.test(t);return r||WI.test(t)?HI(t.slice(2),r?2:8):GI.test(t)?Nd:+t}var Cd=zI;var Id=1/0,VI=17976931348623157e292;function YI(t){if(!t)return t===0?t:0;if(t=Cd(t),t===Id||t===-Id){var e=t<0?-1:1;return e*VI}return t===t?t:0}var Rd=YI;function XI(t){var e=Rd(t),r=e%1;return e===e?r?e-r:e:0}var Kt=XI;function QI(t){return t}var Lt=QI;var ZI="[object AsyncFunction]",JI="[object Function]",eR="[object GeneratorFunction]",tR="[object Proxy]";function rR(t){if(!Oe(t))return!1;var e=it(t);return e==JI||e==eR||e==ZI||e==tR}var ot=rR;var nR=qe["__core-js_shared__"],ts=nR;var wd=(function(){var t=/[^.]+$/.exec(ts&&ts.keys&&ts.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function iR(t){return!!wd&&wd in t}var kd=iR;var oR=Function.prototype,sR=oR.toString;function aR(t){if(t!=null){try{return sR.call(t)}catch{}try{return t+""}catch{}}return""}var cr=aR;var lR=/[\\^$.*+?()[\]{}|]/g,cR=/^\[object .+?Constructor\]$/,uR=Function.prototype,hR=Object.prototype,fR=uR.toString,dR=hR.hasOwnProperty,pR=RegExp("^"+fR.call(dR).replace(lR,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function mR(t){if(!Oe(t)||kd(t))return!1;var e=ot(t)?pR:cR;return e.test(cr(t))}var _d=mR;function gR(t,e){return t?.[e]}var Md=gR;function xR(t,e){var r=Md(t,e);return _d(r)?r:void 0}var ft=xR;var ER=ft(qe,"WeakMap"),rs=ER;var Ud=Object.create,yR=(function(){function t(){}return function(e){if(!Oe(e))return{};if(Ud)return Ud(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})(),Pd=yR;function TR(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var qd=TR;function SR(){}var Ae=SR;function OR(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var Dd=OR;var AR=800,LR=16,bR=Date.now;function vR(t){var e=0,r=0;return function(){var n=bR(),i=LR-(n-r);if(r=n,i>0){if(++e>=AR)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var Fd=vR;function NR(t){return function(){return t}}var Bd=NR;var CR=(function(){try{var t=ft(Object,"defineProperty");return t({},"",{}),t}catch{}})(),vn=CR;var IR=vn?function(t,e){return vn(t,"toString",{configurable:!0,enumerable:!1,value:Bd(e),writable:!0})}:Lt,$d=IR;var RR=Fd($d),Kd=RR;function wR(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var ns=wR;function kR(t,e,r,n){for(var i=t.length,o=r+(n?1:-1);n?o--:++o<i;)if(e(t[o],o,t))return o;return-1}var is=kR;function _R(t){return t!==t}var Gd=_R;function MR(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}var jd=MR;function UR(t,e,r){return e===e?jd(t,e,r):is(t,Gd,r)}var Nn=UR;function PR(t,e){var r=t==null?0:t.length;return!!r&&Nn(t,e,0)>-1}var os=PR;var qR=9007199254740991,DR=/^(?:0|[1-9]\d*)$/;function FR(t,e){var r=typeof t;return e=e??qR,!!e&&(r=="number"||r!="symbol"&&DR.test(t))&&t>-1&&t%1==0&&t<e}var br=FR;function BR(t,e,r){e=="__proto__"&&vn?vn(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Cn=BR;function $R(t,e){return t===e||t!==t&&e!==e}var Gt=$R;var KR=Object.prototype,GR=KR.hasOwnProperty;function jR(t,e,r){var n=t[e];(!(GR.call(t,e)&&Gt(n,r))||r===void 0&&!(e in t))&&Cn(t,e,r)}var vr=jR;function WR(t,e,r,n){var i=!r;r||(r={});for(var o=-1,s=e.length;++o<s;){var a=e[o],c=n?n(r[a],t[a],a,r,t):void 0;c===void 0&&(c=t[a]),i?Cn(r,a,c):vr(r,a,c)}return r}var jt=WR;var Wd=Math.max;function HR(t,e,r){return e=Wd(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,o=Wd(n.length-e,0),s=Array(o);++i<o;)s[i]=n[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=n[i];return a[e]=r(s),qd(t,this,a)}}var Hd=HR;function zR(t,e){return Kd(Hd(t,e,Lt),t+"")}var In=zR;var VR=9007199254740991;function YR(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=VR}var Rn=YR;function XR(t){return t!=null&&Rn(t.length)&&!ot(t)}var De=XR;function QR(t,e,r){if(!Oe(r))return!1;var n=typeof e;return(n=="number"?De(r)&&br(e,r.length):n=="string"&&e in r)?Gt(r[e],t):!1}var Nr=QR;function ZR(t){return In(function(e,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(o=t.length>3&&typeof o=="function"?(i--,o):void 0,s&&Nr(r[0],r[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++n<i;){var a=r[n];a&&t(e,a,n,o)}return e})}var zd=ZR;var JR=Object.prototype;function ew(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||JR;return t===r}var Wt=ew;function tw(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Vd=tw;var rw="[object Arguments]";function nw(t){return Re(t)&&it(t)==rw}var Hl=nw;var Yd=Object.prototype,iw=Yd.hasOwnProperty,ow=Yd.propertyIsEnumerable,sw=Hl((function(){return arguments})())?Hl:function(t){return Re(t)&&iw.call(t,"callee")&&!ow.call(t,"callee")},Cr=sw;function aw(){return!1}var Xd=aw;var Jd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Qd=Jd&&typeof module=="object"&&module&&!module.nodeType&&module,lw=Qd&&Qd.exports===Jd,Zd=lw?qe.Buffer:void 0,cw=Zd?Zd.isBuffer:void 0,uw=cw||Xd,ur=uw;var hw="[object Arguments]",fw="[object Array]",dw="[object Boolean]",pw="[object Date]",mw="[object Error]",gw="[object Function]",xw="[object Map]",Ew="[object Number]",yw="[object Object]",Tw="[object RegExp]",Sw="[object Set]",Ow="[object String]",Aw="[object WeakMap]",Lw="[object ArrayBuffer]",bw="[object DataView]",vw="[object Float32Array]",Nw="[object Float64Array]",Cw="[object Int8Array]",Iw="[object Int16Array]",Rw="[object Int32Array]",ww="[object Uint8Array]",kw="[object Uint8ClampedArray]",_w="[object Uint16Array]",Mw="[object Uint32Array]",fe={};fe[vw]=fe[Nw]=fe[Cw]=fe[Iw]=fe[Rw]=fe[ww]=fe[kw]=fe[_w]=fe[Mw]=!0;fe[hw]=fe[fw]=fe[Lw]=fe[dw]=fe[bw]=fe[pw]=fe[mw]=fe[gw]=fe[xw]=fe[Ew]=fe[yw]=fe[Tw]=fe[Sw]=fe[Ow]=fe[Aw]=!1;function Uw(t){return Re(t)&&Rn(t.length)&&!!fe[it(t)]}var ep=Uw;function Pw(t){return function(e){return t(e)}}var Ht=Pw;var tp=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ci=tp&&typeof module=="object"&&module&&!module.nodeType&&module,qw=Ci&&Ci.exports===tp,zl=qw&&es.process,Dw=(function(){try{var t=Ci&&Ci.require&&Ci.require("util").types;return t||zl&&zl.binding&&zl.binding("util")}catch{}})(),bt=Dw;var rp=bt&&bt.isTypedArray,Fw=rp?Ht(rp):ep,wn=Fw;var Bw=Object.prototype,$w=Bw.hasOwnProperty;function Kw(t,e){var r=R(t),n=!r&&Cr(t),i=!r&&!n&&ur(t),o=!r&&!n&&!i&&wn(t),s=r||n||i||o,a=s?Vd(t.length,String):[],c=a.length;for(var l in t)(e||$w.call(t,l))&&!(s&&(l=="length"||i&&(l=="offset"||l=="parent")||o&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||br(l,c)))&&a.push(l);return a}var ss=Kw;function Gw(t,e){return function(r){return t(e(r))}}var as=Gw;var jw=as(Object.keys,Object),np=jw;var Ww=Object.prototype,Hw=Ww.hasOwnProperty;function zw(t){if(!Wt(t))return np(t);var e=[];for(var r in Object(t))Hw.call(t,r)&&r!="constructor"&&e.push(r);return e}var ls=zw;function Vw(t){return De(t)?ss(t):ls(t)}var oe=Vw;var Yw=Object.prototype,Xw=Yw.hasOwnProperty,Qw=zd(function(t,e){if(Wt(e)||De(e)){jt(e,oe(e),t);return}for(var r in e)Xw.call(e,r)&&vr(t,r,e[r])}),Qe=Qw;function Zw(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var ip=Zw;var Jw=Object.prototype,ek=Jw.hasOwnProperty;function tk(t){if(!Oe(t))return ip(t);var e=Wt(t),r=[];for(var n in t)n=="constructor"&&(e||!ek.call(t,n))||r.push(n);return r}var op=tk;function rk(t){return De(t)?ss(t,!0):op(t)}var Ir=rk;var nk=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ik=/^\w*$/;function ok(t,e){if(R(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Lr(t)?!0:ik.test(t)||!nk.test(t)||e!=null&&t in Object(e)}var kn=ok;var sk=ft(Object,"create"),hr=sk;function ak(){this.__data__=hr?hr(null):{},this.size=0}var sp=ak;function lk(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var ap=lk;var ck="__lodash_hash_undefined__",uk=Object.prototype,hk=uk.hasOwnProperty;function fk(t){var e=this.__data__;if(hr){var r=e[t];return r===ck?void 0:r}return hk.call(e,t)?e[t]:void 0}var lp=fk;var dk=Object.prototype,pk=dk.hasOwnProperty;function mk(t){var e=this.__data__;return hr?e[t]!==void 0:pk.call(e,t)}var cp=mk;var gk="__lodash_hash_undefined__";function xk(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=hr&&e===void 0?gk:e,this}var up=xk;function _n(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}_n.prototype.clear=sp;_n.prototype.delete=ap;_n.prototype.get=lp;_n.prototype.has=cp;_n.prototype.set=up;var Vl=_n;function Ek(){this.__data__=[],this.size=0}var hp=Ek;function yk(t,e){for(var r=t.length;r--;)if(Gt(t[r][0],e))return r;return-1}var Rr=yk;var Tk=Array.prototype,Sk=Tk.splice;function Ok(t){var e=this.__data__,r=Rr(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Sk.call(e,r,1),--this.size,!0}var fp=Ok;function Ak(t){var e=this.__data__,r=Rr(e,t);return r<0?void 0:e[r][1]}var dp=Ak;function Lk(t){return Rr(this.__data__,t)>-1}var pp=Lk;function bk(t,e){var r=this.__data__,n=Rr(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var mp=bk;function Mn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Mn.prototype.clear=hp;Mn.prototype.delete=fp;Mn.prototype.get=dp;Mn.prototype.has=pp;Mn.prototype.set=mp;var wr=Mn;var vk=ft(qe,"Map"),kr=vk;function Nk(){this.size=0,this.__data__={hash:new Vl,map:new(kr||wr),string:new Vl}}var gp=Nk;function Ck(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var xp=Ck;function Ik(t,e){var r=t.__data__;return xp(e)?r[typeof e=="string"?"string":"hash"]:r.map}var _r=Ik;function Rk(t){var e=_r(this,t).delete(t);return this.size-=e?1:0,e}var Ep=Rk;function wk(t){return _r(this,t).get(t)}var yp=wk;function kk(t){return _r(this,t).has(t)}var Tp=kk;function _k(t,e){var r=_r(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var Sp=_k;function Un(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Un.prototype.clear=gp;Un.prototype.delete=Ep;Un.prototype.get=yp;Un.prototype.has=Tp;Un.prototype.set=Sp;var en=Un;var Mk="Expected a function";function Yl(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Mk);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=t.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(Yl.Cache||en),r}Yl.Cache=en;var Op=Yl;var Uk=500;function Pk(t){var e=Op(t,function(n){return r.size===Uk&&r.clear(),n}),r=e.cache;return e}var Ap=Pk;var qk=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dk=/\\(\\)?/g,Fk=Ap(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(qk,function(r,n,i,o){e.push(i?o.replace(Dk,"$1"):n||r)}),e}),Lp=Fk;function Bk(t){return t==null?"":Ld(t)}var bp=Bk;function $k(t,e){return R(t)?t:kn(t,e)?[t]:Lp(bp(t))}var Mr=$k;var Kk=1/0;function Gk(t){if(typeof t=="string"||Lr(t))return t;var e=t+"";return e=="0"&&1/t==-Kk?"-0":e}var zt=Gk;function jk(t,e){e=Mr(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[zt(e[r++])];return r&&r==n?t:void 0}var Pn=jk;function Wk(t,e,r){var n=t==null?void 0:Pn(t,e);return n===void 0?r:n}var vp=Wk;function Hk(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var qn=Hk;var Np=ze?ze.isConcatSpreadable:void 0;function zk(t){return R(t)||Cr(t)||!!(Np&&t&&t[Np])}var Cp=zk;function Ip(t,e,r,n,i){var o=-1,s=t.length;for(r||(r=Cp),i||(i=[]);++o<s;){var a=t[o];e>0&&r(a)?e>1?Ip(a,e-1,r,n,i):qn(i,a):n||(i[i.length]=a)}return i}var Dn=Ip;function Vk(t){var e=t==null?0:t.length;return e?Dn(t,1):[]}var Ge=Vk;var Yk=as(Object.getPrototypeOf,Object),cs=Yk;function Xk(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),r=r>i?i:r,r<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var o=Array(i);++n<i;)o[n]=t[n+e];return o}var us=Xk;function Qk(t,e,r,n){var i=-1,o=t==null?0:t.length;for(n&&o&&(r=t[++i]);++i<o;)r=e(r,t[i],i,t);return r}var Rp=Qk;function Zk(){this.__data__=new wr,this.size=0}var wp=Zk;function Jk(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var kp=Jk;function e_(t){return this.__data__.get(t)}var _p=e_;function t_(t){return this.__data__.has(t)}var Mp=t_;var r_=200;function n_(t,e){var r=this.__data__;if(r instanceof wr){var n=r.__data__;if(!kr||n.length<r_-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new en(n)}return r.set(t,e),this.size=r.size,this}var Up=n_;function Fn(t){var e=this.__data__=new wr(t);this.size=e.size}Fn.prototype.clear=wp;Fn.prototype.delete=kp;Fn.prototype.get=_p;Fn.prototype.has=Mp;Fn.prototype.set=Up;var Ur=Fn;function i_(t,e){return t&&jt(e,oe(e),t)}var Pp=i_;function o_(t,e){return t&&jt(e,Ir(e),t)}var qp=o_;var $p=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Dp=$p&&typeof module=="object"&&module&&!module.nodeType&&module,s_=Dp&&Dp.exports===$p,Fp=s_?qe.Buffer:void 0,Bp=Fp?Fp.allocUnsafe:void 0;function a_(t,e){if(e)return t.slice();var r=t.length,n=Bp?Bp(r):new t.constructor(r);return t.copy(n),n}var Kp=a_;function l_(t,e){for(var r=-1,n=t==null?0:t.length,i=0,o=[];++r<n;){var s=t[r];e(s,r,t)&&(o[i++]=s)}return o}var Bn=l_;function c_(){return[]}var hs=c_;var u_=Object.prototype,h_=u_.propertyIsEnumerable,Gp=Object.getOwnPropertySymbols,f_=Gp?function(t){return t==null?[]:(t=Object(t),Bn(Gp(t),function(e){return h_.call(t,e)}))}:hs,$n=f_;function d_(t,e){return jt(t,$n(t),e)}var jp=d_;var p_=Object.getOwnPropertySymbols,m_=p_?function(t){for(var e=[];t;)qn(e,$n(t)),t=cs(t);return e}:hs,fs=m_;function g_(t,e){return jt(t,fs(t),e)}var Wp=g_;function x_(t,e,r){var n=e(t);return R(t)?n:qn(n,r(t))}var ds=x_;function E_(t){return ds(t,oe,$n)}var Ii=E_;function y_(t){return ds(t,Ir,fs)}var ps=y_;var T_=ft(qe,"DataView"),ms=T_;var S_=ft(qe,"Promise"),gs=S_;var O_=ft(qe,"Set"),Pr=O_;var Hp="[object Map]",A_="[object Object]",zp="[object Promise]",Vp="[object Set]",Yp="[object WeakMap]",Xp="[object DataView]",L_=cr(ms),b_=cr(kr),v_=cr(gs),N_=cr(Pr),C_=cr(rs),tn=it;(ms&&tn(new ms(new ArrayBuffer(1)))!=Xp||kr&&tn(new kr)!=Hp||gs&&tn(gs.resolve())!=zp||Pr&&tn(new Pr)!=Vp||rs&&tn(new rs)!=Yp)&&(tn=function(t){var e=it(t),r=e==A_?t.constructor:void 0,n=r?cr(r):"";if(n)switch(n){case L_:return Xp;case b_:return Hp;case v_:return zp;case N_:return Vp;case C_:return Yp}return e});var Mt=tn;var I_=Object.prototype,R_=I_.hasOwnProperty;function w_(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&R_.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var Qp=w_;var k_=qe.Uint8Array,Kn=k_;function __(t){var e=new t.constructor(t.byteLength);return new Kn(e).set(new Kn(t)),e}var Gn=__;function M_(t,e){var r=e?Gn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var Zp=M_;var U_=/\w*$/;function P_(t){var e=new t.constructor(t.source,U_.exec(t));return e.lastIndex=t.lastIndex,e}var Jp=P_;var em=ze?ze.prototype:void 0,tm=em?em.valueOf:void 0;function q_(t){return tm?Object(tm.call(t)):{}}var rm=q_;function D_(t,e){var r=e?Gn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var nm=D_;var F_="[object Boolean]",B_="[object Date]",$_="[object Map]",K_="[object Number]",G_="[object RegExp]",j_="[object Set]",W_="[object String]",H_="[object Symbol]",z_="[object ArrayBuffer]",V_="[object DataView]",Y_="[object Float32Array]",X_="[object Float64Array]",Q_="[object Int8Array]",Z_="[object Int16Array]",J_="[object Int32Array]",eM="[object Uint8Array]",tM="[object Uint8ClampedArray]",rM="[object Uint16Array]",nM="[object Uint32Array]";function iM(t,e,r){var n=t.constructor;switch(e){case z_:return Gn(t);case F_:case B_:return new n(+t);case V_:return Zp(t,r);case Y_:case X_:case Q_:case Z_:case J_:case eM:case tM:case rM:case nM:return nm(t,r);case $_:return new n;case K_:case W_:return new n(t);case G_:return Jp(t);case j_:return new n;case H_:return rm(t)}}var im=iM;function oM(t){return typeof t.constructor=="function"&&!Wt(t)?Pd(cs(t)):{}}var om=oM;var sM="[object Map]";function aM(t){return Re(t)&&Mt(t)==sM}var sm=aM;var am=bt&&bt.isMap,lM=am?Ht(am):sm,lm=lM;var cM="[object Set]";function uM(t){return Re(t)&&Mt(t)==cM}var cm=uM;var um=bt&&bt.isSet,hM=um?Ht(um):cm,hm=hM;var fM=1,dM=2,pM=4,fm="[object Arguments]",mM="[object Array]",gM="[object Boolean]",xM="[object Date]",EM="[object Error]",dm="[object Function]",yM="[object GeneratorFunction]",TM="[object Map]",SM="[object Number]",pm="[object Object]",OM="[object RegExp]",AM="[object Set]",LM="[object String]",bM="[object Symbol]",vM="[object WeakMap]",NM="[object ArrayBuffer]",CM="[object DataView]",IM="[object Float32Array]",RM="[object Float64Array]",wM="[object Int8Array]",kM="[object Int16Array]",_M="[object Int32Array]",MM="[object Uint8Array]",UM="[object Uint8ClampedArray]",PM="[object Uint16Array]",qM="[object Uint32Array]",se={};se[fm]=se[mM]=se[NM]=se[CM]=se[gM]=se[xM]=se[IM]=se[RM]=se[wM]=se[kM]=se[_M]=se[TM]=se[SM]=se[pm]=se[OM]=se[AM]=se[LM]=se[bM]=se[MM]=se[UM]=se[PM]=se[qM]=!0;se[EM]=se[dm]=se[vM]=!1;function xs(t,e,r,n,i,o){var s,a=e&fM,c=e&dM,l=e&pM;if(r&&(s=i?r(t,n,i,o):r(t)),s!==void 0)return s;if(!Oe(t))return t;var h=R(t);if(h){if(s=Qp(t),!a)return Dd(t,s)}else{var u=Mt(t),f=u==dm||u==yM;if(ur(t))return Kp(t,a);if(u==pm||u==fm||f&&!i){if(s=c||f?{}:om(t),!a)return c?Wp(t,qp(s,t)):jp(t,Pp(s,t))}else{if(!se[u])return i?t:{};s=im(t,u,a)}}o||(o=new Ur);var m=o.get(t);if(m)return m;o.set(t,s),hm(t)?t.forEach(function(E){s.add(xs(E,e,r,E,t,o))}):lm(t)&&t.forEach(function(E,x){s.set(x,xs(E,e,r,x,t,o))});var p=l?c?ps:Ii:c?Ir:oe,g=h?void 0:p(t);return ns(g||t,function(E,x){g&&(x=E,E=t[x]),vr(s,x,xs(E,e,r,x,t,o))}),s}var mm=xs;var DM=4;function FM(t){return mm(t,DM)}var ae=FM;function BM(t){for(var e=-1,r=t==null?0:t.length,n=0,i=[];++e<r;){var o=t[e];o&&(i[n++]=o)}return i}var Vt=BM;var $M="__lodash_hash_undefined__";function KM(t){return this.__data__.set(t,$M),this}var gm=KM;function GM(t){return this.__data__.has(t)}var xm=GM;function Es(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new en;++e<r;)this.add(t[e])}Es.prototype.add=Es.prototype.push=gm;Es.prototype.has=xm;var jn=Es;function jM(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var ys=jM;function WM(t,e){return t.has(e)}var Wn=WM;var HM=1,zM=2;function VM(t,e,r,n,i,o){var s=r&HM,a=t.length,c=e.length;if(a!=c&&!(s&&c>a))return!1;var l=o.get(t),h=o.get(e);if(l&&h)return l==e&&h==t;var u=-1,f=!0,m=r&zM?new jn:void 0;for(o.set(t,e),o.set(e,t);++u<a;){var p=t[u],g=e[u];if(n)var E=s?n(g,p,u,e,t,o):n(p,g,u,t,e,o);if(E!==void 0){if(E)continue;f=!1;break}if(m){if(!ys(e,function(x,T){if(!Wn(m,T)&&(p===x||i(p,x,r,n,o)))return m.push(T)})){f=!1;break}}else if(!(p===g||i(p,g,r,n,o))){f=!1;break}}return o.delete(t),o.delete(e),f}var Ts=VM;function YM(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}var Em=YM;function XM(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var Hn=XM;var QM=1,ZM=2,JM="[object Boolean]",eU="[object Date]",tU="[object Error]",rU="[object Map]",nU="[object Number]",iU="[object RegExp]",oU="[object Set]",sU="[object String]",aU="[object Symbol]",lU="[object ArrayBuffer]",cU="[object DataView]",ym=ze?ze.prototype:void 0,Xl=ym?ym.valueOf:void 0;function uU(t,e,r,n,i,o,s){switch(r){case cU:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case lU:return!(t.byteLength!=e.byteLength||!o(new Kn(t),new Kn(e)));case JM:case eU:case nU:return Gt(+t,+e);case tU:return t.name==e.name&&t.message==e.message;case iU:case sU:return t==e+"";case rU:var a=Em;case oU:var c=n&QM;if(a||(a=Hn),t.size!=e.size&&!c)return!1;var l=s.get(t);if(l)return l==e;n|=ZM,s.set(t,e);var h=Ts(a(t),a(e),n,i,o,s);return s.delete(t),h;case aU:if(Xl)return Xl.call(t)==Xl.call(e)}return!1}var Tm=uU;var hU=1,fU=Object.prototype,dU=fU.hasOwnProperty;function pU(t,e,r,n,i,o){var s=r&hU,a=Ii(t),c=a.length,l=Ii(e),h=l.length;if(c!=h&&!s)return!1;for(var u=c;u--;){var f=a[u];if(!(s?f in e:dU.call(e,f)))return!1}var m=o.get(t),p=o.get(e);if(m&&p)return m==e&&p==t;var g=!0;o.set(t,e),o.set(e,t);for(var E=s;++u<c;){f=a[u];var x=t[f],T=e[f];if(n)var y=s?n(T,x,f,e,t,o):n(x,T,f,t,e,o);if(!(y===void 0?x===T||i(x,T,r,n,o):y)){g=!1;break}E||(E=f=="constructor")}if(g&&!E){var O=t.constructor,A=e.constructor;O!=A&&"constructor"in t&&"constructor"in e&&!(typeof O=="function"&&O instanceof O&&typeof A=="function"&&A instanceof A)&&(g=!1)}return o.delete(t),o.delete(e),g}var Sm=pU;var mU=1,Om="[object Arguments]",Am="[object Array]",Ss="[object Object]",gU=Object.prototype,Lm=gU.hasOwnProperty;function xU(t,e,r,n,i,o){var s=R(t),a=R(e),c=s?Am:Mt(t),l=a?Am:Mt(e);c=c==Om?Ss:c,l=l==Om?Ss:l;var h=c==Ss,u=l==Ss,f=c==l;if(f&&ur(t)){if(!ur(e))return!1;s=!0,h=!1}if(f&&!h)return o||(o=new Ur),s||wn(t)?Ts(t,e,r,n,i,o):Tm(t,e,c,r,n,i,o);if(!(r&mU)){var m=h&&Lm.call(t,"__wrapped__"),p=u&&Lm.call(e,"__wrapped__");if(m||p){var g=m?t.value():t,E=p?e.value():e;return o||(o=new Ur),i(g,E,r,n,o)}}return f?(o||(o=new Ur),Sm(t,e,r,n,i,o)):!1}var bm=xU;function vm(t,e,r,n,i){return t===e?!0:t==null||e==null||!Re(t)&&!Re(e)?t!==t&&e!==e:bm(t,e,r,n,vm,i)}var Os=vm;var EU=1,yU=2;function TU(t,e,r,n){var i=r.length,o=i,s=!n;if(t==null)return!o;for(t=Object(t);i--;){var a=r[i];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){a=r[i];var c=a[0],l=t[c],h=a[1];if(s&&a[2]){if(l===void 0&&!(c in t))return!1}else{var u=new Ur;if(n)var f=n(l,h,c,t,e,u);if(!(f===void 0?Os(h,l,EU|yU,n,u):f))return!1}}return!0}var Nm=TU;function SU(t){return t===t&&!Oe(t)}var As=SU;function OU(t){for(var e=oe(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,As(i)]}return e}var Cm=OU;function AU(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var Ls=AU;function LU(t){var e=Cm(t);return e.length==1&&e[0][2]?Ls(e[0][0],e[0][1]):function(r){return r===t||Nm(r,t,e)}}var Im=LU;function bU(t,e){return t!=null&&e in Object(t)}var Rm=bU;function vU(t,e,r){e=Mr(e,t);for(var n=-1,i=e.length,o=!1;++n<i;){var s=zt(e[n]);if(!(o=t!=null&&r(t,s)))break;t=t[s]}return o||++n!=i?o:(i=t==null?0:t.length,!!i&&Rn(i)&&br(s,i)&&(R(t)||Cr(t)))}var bs=vU;function NU(t,e){return t!=null&&bs(t,e,Rm)}var wm=NU;var CU=1,IU=2;function RU(t,e){return kn(t)&&As(e)?Ls(zt(t),e):function(r){var n=vp(r,t);return n===void 0&&n===e?wm(r,t):Os(e,n,CU|IU)}}var km=RU;function wU(t){return function(e){return e?.[t]}}var _m=wU;function kU(t){return function(e){return Pn(e,t)}}var Mm=kU;function _U(t){return kn(t)?_m(zt(t)):Mm(t)}var Um=_U;function MU(t){return typeof t=="function"?t:t==null?Lt:typeof t=="object"?R(t)?km(t[0],t[1]):Im(t):Um(t)}var Fe=MU;function UU(t,e,r,n){for(var i=-1,o=t==null?0:t.length;++i<o;){var s=t[i];e(n,s,r(s),t)}return n}var Pm=UU;function PU(t){return function(e,r,n){for(var i=-1,o=Object(e),s=n(e),a=s.length;a--;){var c=s[t?a:++i];if(r(o[c],c,o)===!1)break}return e}}var qm=PU;var qU=qm(),Dm=qU;function DU(t,e){return t&&Dm(t,e,oe)}var Fm=DU;function FU(t,e){return function(r,n){if(r==null)return r;if(!De(r))return t(r,n);for(var i=r.length,o=e?i:-1,s=Object(r);(e?o--:++o<i)&&n(s[o],o,s)!==!1;);return r}}var Bm=FU;var BU=Bm(Fm),dt=BU;function $U(t,e,r,n){return dt(t,function(i,o,s){e(n,i,r(i),s)}),n}var $m=$U;function KU(t,e){return function(r,n){var i=R(r)?Pm:$m,o=e?e():{};return i(r,t,Fe(n,2),o)}}var Km=KU;var Gm=Object.prototype,GU=Gm.hasOwnProperty,jU=In(function(t,e){t=Object(t);var r=-1,n=e.length,i=n>2?e[2]:void 0;for(i&&Nr(e[0],e[1],i)&&(n=1);++r<n;)for(var o=e[r],s=Ir(o),a=-1,c=s.length;++a<c;){var l=s[a],h=t[l];(h===void 0||Gt(h,Gm[l])&&!GU.call(t,l))&&(t[l]=o[l])}return t}),zn=jU;function WU(t){return Re(t)&&De(t)}var Ql=WU;function HU(t,e,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}var vs=HU;var zU=200;function VU(t,e,r,n){var i=-1,o=os,s=!0,a=t.length,c=[],l=e.length;if(!a)return c;r&&(e=$t(e,Ht(r))),n?(o=vs,s=!1):e.length>=zU&&(o=Wn,s=!1,e=new jn(e));e:for(;++i<a;){var h=t[i],u=r==null?h:r(h);if(h=n||h!==0?h:0,s&&u===u){for(var f=l;f--;)if(e[f]===u)continue e;c.push(h)}else o(e,u,n)||c.push(h)}return c}var jm=VU;var YU=In(function(t,e){return Ql(t)?jm(t,Dn(e,1,Ql,!0)):[]}),qr=YU;function XU(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var Yt=XU;function QU(t,e,r){var n=t==null?0:t.length;return n?(e=r||e===void 0?1:Kt(e),us(t,e<0?0:e,n)):[]}var we=QU;function ZU(t,e,r){var n=t==null?0:t.length;return n?(e=r||e===void 0?1:Kt(e),e=n-e,us(t,0,e<0?0:e)):[]}var fr=ZU;function JU(t){return typeof t=="function"?t:Lt}var Wm=JU;function eP(t,e){var r=R(t)?ns:dt;return r(t,Wm(e))}var C=eP;function tP(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}var Hm=tP;function rP(t,e){var r=!0;return dt(t,function(n,i,o){return r=!!e(n,i,o),r}),r}var zm=rP;function nP(t,e,r){var n=R(t)?Hm:zm;return r&&Nr(t,e,r)&&(e=void 0),n(t,Fe(e,3))}var Je=nP;function iP(t,e){var r=[];return dt(t,function(n,i,o){e(n,i,o)&&r.push(n)}),r}var Ns=iP;function oP(t,e){var r=R(t)?Bn:Ns;return r(t,Fe(e,3))}var et=oP;function sP(t){return function(e,r,n){var i=Object(e);if(!De(e)){var o=Fe(r,3);e=oe(e),r=function(a){return o(i[a],a,i)}}var s=t(e,r,n);return s>-1?i[o?e[s]:s]:void 0}}var Vm=sP;var aP=Math.max;function lP(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=r==null?0:Kt(r);return i<0&&(i=aP(n+i,0)),is(t,Fe(e,3),i)}var Ym=lP;var cP=Vm(Ym),Xt=cP;function uP(t){return t&&t.length?t[0]:void 0}var Ve=uP;function hP(t,e){var r=-1,n=De(t)?Array(t.length):[];return dt(t,function(i,o,s){n[++r]=e(i,o,s)}),n}var Xm=hP;function fP(t,e){var r=R(t)?$t:Xm;return r(t,Fe(e,3))}var N=fP;function dP(t,e){return Dn(N(t,e),1)}var st=dP;var pP=Object.prototype,mP=pP.hasOwnProperty,gP=Km(function(t,e,r){mP.call(t,r)?t[r].push(e):Cn(t,r,[e])}),Zl=gP;var xP=Object.prototype,EP=xP.hasOwnProperty;function yP(t,e){return t!=null&&EP.call(t,e)}var Qm=yP;function TP(t,e){return t!=null&&bs(t,e,Qm)}var I=TP;var SP="[object String]";function OP(t){return typeof t=="string"||!R(t)&&Re(t)&&it(t)==SP}var je=OP;function AP(t,e){return $t(e,function(r){return t[r]})}var Zm=AP;function LP(t){return t==null?[]:Zm(t,oe(t))}var ie=LP;var bP=Math.max;function vP(t,e,r,n){t=De(t)?t:ie(t),r=r&&!n?Kt(r):0;var i=t.length;return r<0&&(r=bP(i+r,0)),je(t)?r<=i&&t.indexOf(e,r)>-1:!!i&&Nn(t,e,r)>-1}var ye=vP;var NP=Math.max;function CP(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=r==null?0:Kt(r);return i<0&&(i=NP(n+i,0)),Nn(t,e,i)}var Cs=CP;var IP="[object Map]",RP="[object Set]",wP=Object.prototype,kP=wP.hasOwnProperty;function _P(t){if(t==null)return!0;if(De(t)&&(R(t)||typeof t=="string"||typeof t.splice=="function"||ur(t)||wn(t)||Cr(t)))return!t.length;var e=Mt(t);if(e==IP||e==RP)return!t.size;if(Wt(t))return!ls(t).length;for(var r in t)if(kP.call(t,r))return!1;return!0}var $=_P;var MP="[object RegExp]";function UP(t){return Re(t)&&it(t)==MP}var Jm=UP;var eg=bt&&bt.isRegExp,PP=eg?Ht(eg):Jm,vt=PP;function qP(t){return t===void 0}var tt=qP;var DP="Expected a function";function FP(t){if(typeof t!="function")throw new TypeError(DP);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}var tg=FP;function BP(t,e,r,n){if(!Oe(t))return t;e=Mr(e,t);for(var i=-1,o=e.length,s=o-1,a=t;a!=null&&++i<o;){var c=zt(e[i]),l=r;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(i!=s){var h=a[c];l=n?n(h,c,a):void 0,l===void 0&&(l=Oe(h)?h:br(e[i+1])?[]:{})}vr(a,c,l),a=a[c]}return t}var rg=BP;function $P(t,e,r){for(var n=-1,i=e.length,o={};++n<i;){var s=e[n],a=Pn(t,s);r(a,s)&&rg(o,Mr(s,t),a)}return o}var ng=$P;function KP(t,e){if(t==null)return{};var r=$t(ps(t),function(n){return[n]});return e=Fe(e),ng(t,r,function(n,i){return e(n,i[0])})}var pt=KP;function GP(t,e,r,n,i){return i(t,function(o,s,a){r=n?(n=!1,o):e(r,o,s,a)}),r}var ig=GP;function jP(t,e,r){var n=R(t)?Rp:ig,i=arguments.length<3;return n(t,Fe(e,4),r,i,dt)}var Be=jP;function WP(t,e){var r=R(t)?Bn:Ns;return r(t,tg(Fe(e,3)))}var Dr=WP;function HP(t,e){var r;return dt(t,function(n,i,o){return r=e(n,i,o),!r}),!!r}var og=HP;function zP(t,e,r){var n=R(t)?ys:og;return r&&Nr(t,e,r)&&(e=void 0),n(t,Fe(e,3))}var Ri=zP;var VP=1/0,YP=Pr&&1/Hn(new Pr([,-0]))[1]==VP?function(t){return new Pr(t)}:Ae,sg=YP;var XP=200;function QP(t,e,r){var n=-1,i=os,o=t.length,s=!0,a=[],c=a;if(r)s=!1,i=vs;else if(o>=XP){var l=e?null:sg(t);if(l)return Hn(l);s=!1,i=Wn,c=new jn}else c=e?[]:a;e:for(;++n<o;){var h=t[n],u=e?e(h):h;if(h=r||h!==0?h:0,s&&u===u){for(var f=c.length;f--;)if(c[f]===u)continue e;e&&c.push(u),a.push(h)}else i(c,u,r)||(c!==a&&c.push(u),a.push(h))}return a}var ag=QP;function ZP(t){return t&&t.length?ag(t):[]}var Vn=ZP;function Yn(t){console&&console.error&&console.error(`Error: ${t}`)}function wi(t){console&&console.warn&&console.warn(`Warning: ${t}`)}function ki(t){let e=new Date().getTime(),r=t();return{time:new Date().getTime()-e,value:r}}function _i(t){function e(){}e.prototype=t;let r=new e;function n(){return typeof r.bar}return n(),n(),t;(0,eval)(t)}function JP(t){return e0(t)?t.LABEL:t.name}function e0(t){return je(t.LABEL)&&t.LABEL!==""}var gt=class{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),C(this.definition,r=>{r.accept(e)})}},le=class extends gt{constructor(e){super([]),this.idx=1,Qe(this,pt(e,r=>r!==void 0))}set definition(e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(e){e.visit(this)}},at=class extends gt{constructor(e){super(e.definition),this.orgText="",Qe(this,pt(e,r=>r!==void 0))}},ce=class extends gt{constructor(e){super(e.definition),this.ignoreAmbiguities=!1,Qe(this,pt(e,r=>r!==void 0))}},de=class extends gt{constructor(e){super(e.definition),this.idx=1,Qe(this,pt(e,r=>r!==void 0))}},ke=class extends gt{constructor(e){super(e.definition),this.idx=1,Qe(this,pt(e,r=>r!==void 0))}},_e=class extends gt{constructor(e){super(e.definition),this.idx=1,Qe(this,pt(e,r=>r!==void 0))}},ee=class extends gt{constructor(e){super(e.definition),this.idx=1,Qe(this,pt(e,r=>r!==void 0))}},Ne=class extends gt{constructor(e){super(e.definition),this.idx=1,Qe(this,pt(e,r=>r!==void 0))}},Ce=class extends gt{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,Qe(this,pt(e,r=>r!==void 0))}},H=class{constructor(e){this.idx=1,Qe(this,pt(e,r=>r!==void 0))}accept(e){e.visit(this)}};function Is(t){return N(t,Xn)}function Xn(t){function e(r){return N(r,Xn)}if(t instanceof le){let r={type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};return je(t.label)&&(r.label=t.label),r}else{if(t instanceof ce)return{type:"Alternative",definition:e(t.definition)};if(t instanceof de)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof ke)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof _e)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:Xn(new H({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Ne)return{type:"RepetitionWithSeparator",idx:t.idx,separator:Xn(new H({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof ee)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof Ce)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof H){let r={type:"Terminal",name:t.terminalType.name,label:JP(t.terminalType),idx:t.idx};je(t.label)&&(r.terminalLabel=t.label);let n=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(r.pattern=vt(n)?n.source:n),r}else{if(t instanceof at)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}}var lt=class{visit(e){let r=e;switch(r.constructor){case le:return this.visitNonTerminal(r);case ce:return this.visitAlternative(r);case de:return this.visitOption(r);case ke:return this.visitRepetitionMandatory(r);case _e:return this.visitRepetitionMandatoryWithSeparator(r);case Ne:return this.visitRepetitionWithSeparator(r);case ee:return this.visitRepetition(r);case Ce:return this.visitAlternation(r);case H:return this.visitTerminal(r);case at:return this.visitRule(r);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}};function Jl(t){return t instanceof ce||t instanceof de||t instanceof ee||t instanceof ke||t instanceof _e||t instanceof Ne||t instanceof H||t instanceof at}function rn(t,e=[]){return t instanceof de||t instanceof ee||t instanceof Ne?!0:t instanceof Ce?Ri(t.definition,n=>rn(n,e)):t instanceof le&&ye(e,t)?!1:t instanceof gt?(t instanceof le&&e.push(t),Je(t.definition,n=>rn(n,e))):!1}function ec(t){return t instanceof Ce}function mt(t){if(t instanceof le)return"SUBRULE";if(t instanceof de)return"OPTION";if(t instanceof Ce)return"OR";if(t instanceof ke)return"AT_LEAST_ONE";if(t instanceof _e)return"AT_LEAST_ONE_SEP";if(t instanceof Ne)return"MANY_SEP";if(t instanceof ee)return"MANY";if(t instanceof H)return"CONSUME";throw Error("non exhaustive match")}var dr=class{walk(e,r=[]){C(e.definition,(n,i)=>{let o=we(e.definition,i+1);if(n instanceof le)this.walkProdRef(n,o,r);else if(n instanceof H)this.walkTerminal(n,o,r);else if(n instanceof ce)this.walkFlat(n,o,r);else if(n instanceof de)this.walkOption(n,o,r);else if(n instanceof ke)this.walkAtLeastOne(n,o,r);else if(n instanceof _e)this.walkAtLeastOneSep(n,o,r);else if(n instanceof Ne)this.walkManySep(n,o,r);else if(n instanceof ee)this.walkMany(n,o,r);else if(n instanceof Ce)this.walkOr(n,o,r);else throw Error("non exhaustive match")})}walkTerminal(e,r,n){}walkProdRef(e,r,n){}walkFlat(e,r,n){let i=r.concat(n);this.walk(e,i)}walkOption(e,r,n){let i=r.concat(n);this.walk(e,i)}walkAtLeastOne(e,r,n){let i=[new de({definition:e.definition})].concat(r,n);this.walk(e,i)}walkAtLeastOneSep(e,r,n){let i=lg(e,r,n);this.walk(e,i)}walkMany(e,r,n){let i=[new de({definition:e.definition})].concat(r,n);this.walk(e,i)}walkManySep(e,r,n){let i=lg(e,r,n);this.walk(e,i)}walkOr(e,r,n){let i=r.concat(n);C(e.definition,o=>{let s=new ce({definition:[o]});this.walk(s,i)})}};function lg(t,e,r){return[new de({definition:[new H({terminalType:t.separator})].concat(t.definition)})].concat(e,r)}function nn(t){if(t instanceof le)return nn(t.referencedRule);if(t instanceof H)return n0(t);if(Jl(t))return t0(t);if(ec(t))return r0(t);throw Error("non exhaustive match")}function t0(t){let e=[],r=t.definition,n=0,i=r.length>n,o,s=!0;for(;i&&s;)o=r[n],s=rn(o),e=e.concat(nn(o)),n=n+1,i=r.length>n;return Vn(e)}function r0(t){let e=N(t.definition,r=>nn(r));return Vn(Ge(e))}function n0(t){return[t.terminalType]}var Rs="_~IN~_";var tc=class extends dr{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,r,n){}walkProdRef(e,r,n){let i=i0(e.referencedRule,e.idx)+this.topProd.name,o=r.concat(n),s=new ce({definition:o}),a=nn(s);this.follows[i]=a}};function cg(t){let e={};return C(t,r=>{let n=new tc(r).startWalking();Qe(e,n)}),e}function i0(t,e){return t.name+e+Rs}function _(t){return t.charCodeAt(0)}function ws(t,e){Array.isArray(t)?t.forEach(function(r){e.push(r)}):e.push(t)}function Qn(t,e){if(t[e]===!0)throw"duplicate flag "+e;let r=t[e];t[e]=!0}function on(t){if(t===void 0)throw Error("Internal Error - Should never get here!");return!0}function Mi(){throw Error("Internal Error - Should never get here!")}function rc(t){return t.type==="Character"}var Ui=[];for(let t=_("0");t<=_("9");t++)Ui.push(t);var Pi=[_("_")].concat(Ui);for(let t=_("a");t<=_("z");t++)Pi.push(t);for(let t=_("A");t<=_("Z");t++)Pi.push(t);var nc=[_(" "),_("\f"),_(`
`),_("\r"),_("	"),_("\v"),_("	"),_("\xA0"),_("\u1680"),_("\u2000"),_("\u2001"),_("\u2002"),_("\u2003"),_("\u2004"),_("\u2005"),_("\u2006"),_("\u2007"),_("\u2008"),_("\u2009"),_("\u200A"),_("\u2028"),_("\u2029"),_("\u202F"),_("\u205F"),_("\u3000"),_("\uFEFF")];var o0=/[0-9a-fA-F]/,ks=/[0-9]/,s0=/[1-9]/,qi=class{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");let r=this.disjunction();this.consumeChar("/");let n={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":Qn(n,"global");break;case"i":Qn(n,"ignoreCase");break;case"m":Qn(n,"multiLine");break;case"u":Qn(n,"unicode");break;case"y":Qn(n,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:r,loc:this.loc(0)}}disjunction(){let e=[],r=this.idx;for(e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(r)}}alternative(){let e=[],r=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(r)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){let e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let r;switch(this.popChar()){case"=":r="Lookahead";break;case"!":r="NegativeLookahead";break}on(r);let n=this.disjunction();return this.consumeChar(")"),{type:r,value:n,loc:this.loc(e)}}return Mi()}quantifier(e=!1){let r,n=this.idx;switch(this.popChar()){case"*":r={atLeast:0,atMost:1/0};break;case"+":r={atLeast:1,atMost:1/0};break;case"?":r={atLeast:0,atMost:1};break;case"{":let i=this.integerIncludingZero();switch(this.popChar()){case"}":r={atLeast:i,atMost:i};break;case",":let o;this.isDigit()?(o=this.integerIncludingZero(),r={atLeast:i,atMost:o}):r={atLeast:i,atMost:1/0},this.consumeChar("}");break}if(e===!0&&r===void 0)return;on(r);break}if(!(e===!0&&r===void 0)&&on(r))return this.peekChar(0)==="?"?(this.consumeChar("?"),r.greedy=!1):r.greedy=!0,r.type="Quantifier",r.loc=this.loc(n),r}atom(){let e,r=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}return e===void 0&&this.isPatternCharacter()&&(e=this.patternCharacter()),on(e)?(e.loc=this.loc(r),this.isQuantifier()&&(e.quantifier=this.quantifier()),e):Mi()}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[_(`
`),_("\r"),_("\u2028"),_("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,r=!1;switch(this.popChar()){case"d":e=Ui;break;case"D":e=Ui,r=!0;break;case"s":e=nc;break;case"S":e=nc,r=!0;break;case"w":e=Pi;break;case"W":e=Pi,r=!0;break}return on(e)?{type:"Set",value:e,complement:r}:Mi()}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=_("\f");break;case"n":e=_(`
`);break;case"r":e=_("\r");break;case"t":e=_("	");break;case"v":e=_("\v");break}return on(e)?{type:"Character",value:e}:Mi()}controlLetterEscapeAtom(){this.consumeChar("c");let e=this.popChar();if(/[a-zA-Z]/.test(e)===!1)throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:_("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){let e=this.popChar();return{type:"Character",value:_(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:let e=this.popChar();return{type:"Character",value:_(e)}}}characterClass(){let e=[],r=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),r=!0);this.isClassAtom();){let n=this.classAtom(),i=n.type==="Character";if(rc(n)&&this.isRangeDash()){this.consumeChar("-");let o=this.classAtom(),s=o.type==="Character";if(rc(o)){if(o.value<n.value)throw Error("Range out of order in character class");e.push({from:n.value,to:o.value})}else ws(n.value,e),e.push(_("-")),ws(o.value,e)}else ws(n.value,e)}return this.consumeChar("]"),{type:"Set",complement:r,value:e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:_("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++;break}let r=this.disjunction();this.consumeChar(")");let n={type:"Group",capturing:e,value:r};return e&&(n.idx=this.groupIdx),n}positiveInteger(){let e=this.popChar();if(s0.test(e)===!1)throw Error("Expecting a positive integer");for(;ks.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(ks.test(e)===!1)throw Error("Expecting an integer");for(;ks.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){let e=this.popChar();switch(e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:_(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return ks.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){let e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let r="";for(let i=0;i<e;i++){let o=this.popChar();if(o0.test(o)===!1)throw Error("Expecting a HexDecimal digits");r+=o}return{type:"Character",value:parseInt(r,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){let e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(e!==void 0&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}};var Fr=class{visitChildren(e){for(let r in e){let n=e[r];e.hasOwnProperty(r)&&(n.type!==void 0?this.visit(n):Array.isArray(n)&&n.forEach(i=>{this.visit(i)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}};var _s={},a0=new qi;function Zn(t){let e=t.toString();if(_s.hasOwnProperty(e))return _s[e];{let r=a0.pattern(e);return _s[e]=r,r}}function ug(){_s={}}var fg="Complement Sets are not supported for first char optimization",Di=`Unable to use "first char" lexer optimizations:
`;function dg(t,e=!1){try{let r=Zn(t);return ic(r.value,{},r.flags.ignoreCase)}catch(r){if(r.message===fg)e&&wi(`${Di}	Unable to optimize: < ${t.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let n="";e&&(n=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Yn(`${Di}
	Failed parsing: < ${t.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+n)}}return[]}function ic(t,e,r){switch(t.type){case"Disjunction":for(let i=0;i<t.value.length;i++)ic(t.value[i],e,r);break;case"Alternative":let n=t.value;for(let i=0;i<n.length;i++){let o=n[i];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}let s=o;switch(s.type){case"Character":Ms(s.value,e,r);break;case"Set":if(s.complement===!0)throw Error(fg);C(s.value,c=>{if(typeof c=="number")Ms(c,e,r);else{let l=c;if(r===!0)for(let h=l.from;h<=l.to;h++)Ms(h,e,r);else{for(let h=l.from;h<=l.to&&h<Jn;h++)Ms(h,e,r);if(l.to>=Jn){let h=l.from>=Jn?l.from:Jn,u=l.to,f=Qt(h),m=Qt(u);for(let p=f;p<=m;p++)e[p]=p}}}});break;case"Group":ic(s.value,e,r);break;default:throw Error("Non Exhaustive Match")}let a=s.quantifier!==void 0&&s.quantifier.atLeast===0;if(s.type==="Group"&&oc(s)===!1||s.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return ie(e)}function Ms(t,e,r){let n=Qt(t);e[n]=n,r===!0&&l0(t,e)}function l0(t,e){let r=String.fromCharCode(t),n=r.toUpperCase();if(n!==r){let i=Qt(n.charCodeAt(0));e[i]=i}else{let i=r.toLowerCase();if(i!==r){let o=Qt(i.charCodeAt(0));e[o]=o}}}function hg(t,e){return Xt(t.value,r=>{if(typeof r=="number")return ye(e,r);{let n=r;return Xt(e,i=>n.from<=i&&i<=n.to)!==void 0}})}function oc(t){let e=t.quantifier;return e&&e.atLeast===0?!0:t.value?R(t.value)?Je(t.value,oc):oc(t.value):!1}var sc=class extends Fr{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){ye(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?hg(e,this.targetCharCodes)===void 0&&(this.found=!0):hg(e,this.targetCharCodes)!==void 0&&(this.found=!0)}};function Us(t,e){if(e instanceof RegExp){let r=Zn(e),n=new sc(t);return n.visit(r),n.found}else return Xt(e,r=>ye(t,r.charCodeAt(0)))!==void 0}var sn="PATTERN",ei="defaultMode",Ps="modes",lc=typeof new RegExp("(?:)").sticky=="boolean";function gg(t,e){e=zn(e,{useSticky:lc,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(T,y)=>y()});let r=e.tracer;r("initCharCodeToOptimizedIndexMap",()=>{v0()});let n;r("Reject Lexer.NA",()=>{n=Dr(t,T=>T[sn]===K.NA)});let i=!1,o;r("Transform Patterns",()=>{i=!1,o=N(n,T=>{let y=T[sn];if(vt(y)){let O=y.source;return O.length===1&&O!=="^"&&O!=="$"&&O!=="."&&!y.ignoreCase?O:O.length===2&&O[0]==="\\"&&!ye(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],O[1])?O[1]:e.useSticky?mg(y):pg(y)}else{if(ot(y))return i=!0,{exec:y};if(typeof y=="object")return i=!0,y;if(typeof y=="string"){if(y.length===1)return y;{let O=y.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),A=new RegExp(O);return e.useSticky?mg(A):pg(A)}}else throw Error("non exhaustive match")}})});let s,a,c,l,h;r("misc mapping",()=>{s=N(n,T=>T.tokenTypeIdx),a=N(n,T=>{let y=T.GROUP;if(y!==K.SKIPPED){if(je(y))return y;if(tt(y))return!1;throw Error("non exhaustive match")}}),c=N(n,T=>{let y=T.LONGER_ALT;if(y)return R(y)?N(y,A=>Cs(n,A)):[Cs(n,y)]}),l=N(n,T=>T.PUSH_MODE),h=N(n,T=>I(T,"POP_MODE"))});let u;r("Line Terminator Handling",()=>{let T=Lg(e.lineTerminatorCharacters);u=N(n,y=>!1),e.positionTracking!=="onlyOffset"&&(u=N(n,y=>I(y,"LINE_BREAKS")?!!y.LINE_BREAKS:Ag(y,T)===!1&&Us(T,y.PATTERN)))});let f,m,p,g;r("Misc Mapping #2",()=>{f=N(n,Sg),m=N(o,L0),p=Be(n,(T,y)=>{let O=y.GROUP;return je(O)&&O!==K.SKIPPED&&(T[O]=[]),T},{}),g=N(o,(T,y)=>({pattern:o[y],longerAlt:c[y],canLineTerminator:u[y],isCustom:f[y],short:m[y],group:a[y],push:l[y],pop:h[y],tokenTypeIdx:s[y],tokenType:n[y]}))});let E=!0,x=[];return e.safeMode||r("First Char Optimization",()=>{x=Be(n,(T,y,O)=>{if(typeof y.PATTERN=="string"){let A=y.PATTERN.charCodeAt(0),L=Qt(A);ac(T,L,g[O])}else if(R(y.START_CHARS_HINT)){let A;C(y.START_CHARS_HINT,L=>{let b=typeof L=="string"?L.charCodeAt(0):L,v=Qt(b);A!==v&&(A=v,ac(T,v,g[O]))})}else if(vt(y.PATTERN))if(y.PATTERN.unicode)E=!1,e.ensureOptimizations&&Yn(`${Di}	Unable to analyze < ${y.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{let A=dg(y.PATTERN,e.ensureOptimizations);$(A)&&(E=!1),C(A,L=>{ac(T,L,g[O])})}else e.ensureOptimizations&&Yn(`${Di}	TokenType: <${y.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),E=!1;return T},[])}),{emptyGroups:p,patternIdxToConfig:g,charCodeToPatternIdxToConfig:x,hasCustom:i,canBeOptimized:E}}function xg(t,e){let r=[],n=u0(t);r=r.concat(n.errors);let i=h0(n.valid),o=i.valid;return r=r.concat(i.errors),r=r.concat(c0(o)),r=r.concat(y0(o)),r=r.concat(T0(o,e)),r=r.concat(S0(o)),r}function c0(t){let e=[],r=et(t,n=>vt(n[sn]));return e=e.concat(d0(r)),e=e.concat(g0(r)),e=e.concat(x0(r)),e=e.concat(E0(r)),e=e.concat(p0(r)),e}function u0(t){let e=et(t,i=>!I(i,sn)),r=N(e,i=>({message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:Te.MISSING_PATTERN,tokenTypes:[i]})),n=qr(t,e);return{errors:r,valid:n}}function h0(t){let e=et(t,i=>{let o=i[sn];return!vt(o)&&!ot(o)&&!I(o,"exec")&&!je(o)}),r=N(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Te.INVALID_PATTERN,tokenTypes:[i]})),n=qr(t,e);return{errors:r,valid:n}}var f0=/[^\\][$]/;function d0(t){class e extends Fr{constructor(){super(...arguments),this.found=!1}visitEndAnchor(o){this.found=!0}}let r=et(t,i=>{let o=i.PATTERN;try{let s=Zn(o),a=new e;return a.visit(s),a.found}catch{return f0.test(o.source)}});return N(r,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Te.EOI_ANCHOR_FOUND,tokenTypes:[i]}))}function p0(t){let e=et(t,n=>n.PATTERN.test(""));return N(e,n=>({message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:Te.EMPTY_MATCH_PATTERN,tokenTypes:[n]}))}var m0=/[^\\[][\^]|^\^/;function g0(t){class e extends Fr{constructor(){super(...arguments),this.found=!1}visitStartAnchor(o){this.found=!0}}let r=et(t,i=>{let o=i.PATTERN;try{let s=Zn(o),a=new e;return a.visit(s),a.found}catch{return m0.test(o.source)}});return N(r,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Te.SOI_ANCHOR_FOUND,tokenTypes:[i]}))}function x0(t){let e=et(t,n=>{let i=n[sn];return i instanceof RegExp&&(i.multiline||i.global)});return N(e,n=>({message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Te.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}))}function E0(t){let e=[],r=N(t,o=>Be(t,(s,a)=>(o.PATTERN.source===a.PATTERN.source&&!ye(e,a)&&a.PATTERN!==K.NA&&(e.push(a),s.push(a)),s),[]));r=Vt(r);let n=et(r,o=>o.length>1);return N(n,o=>{let s=N(o,c=>c.name);return{message:`The same RegExp pattern ->${Ve(o).PATTERN}<-has been used in all of the following Token Types: ${s.join(", ")} <-`,type:Te.DUPLICATE_PATTERNS_FOUND,tokenTypes:o}})}function y0(t){let e=et(t,n=>{if(!I(n,"GROUP"))return!1;let i=n.GROUP;return i!==K.SKIPPED&&i!==K.NA&&!je(i)});return N(e,n=>({message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Te.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}))}function T0(t,e){let r=et(t,i=>i.PUSH_MODE!==void 0&&!ye(e,i.PUSH_MODE));return N(r,i=>({message:`Token Type: ->${i.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${i.PUSH_MODE}<-which does not exist`,type:Te.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}))}function S0(t){let e=[],r=Be(t,(n,i,o)=>{let s=i.PATTERN;return s===K.NA||(je(s)?n.push({str:s,idx:o,tokenType:i}):vt(s)&&A0(s)&&n.push({str:s.source,idx:o,tokenType:i})),n},[]);return C(t,(n,i)=>{C(r,({str:o,idx:s,tokenType:a})=>{if(i<s&&O0(o,n.PATTERN)){let c=`Token: ->${a.name}<- can never be matched.
Because it appears AFTER the Token Type ->${n.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:c,type:Te.UNREACHABLE_PATTERN,tokenTypes:[n,a]})}})}),e}function O0(t,e){if(vt(e)){let r=e.exec(t);return r!==null&&r.index===0}else{if(ot(e))return e(t,0,[],{});if(I(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function A0(t){return Xt([".","\\","[","]","|","^","$","(",")","?","*","+","{"],r=>t.source.indexOf(r)!==-1)===void 0}function pg(t){let e=t.ignoreCase?"i":"";return new RegExp(`^(?:${t.source})`,e)}function mg(t){let e=t.ignoreCase?"iy":"y";return new RegExp(`${t.source}`,e)}function Eg(t,e,r){let n=[];return I(t,ei)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+ei+`> property in its definition
`,type:Te.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),I(t,Ps)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+Ps+`> property in its definition
`,type:Te.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),I(t,Ps)&&I(t,ei)&&!I(t.modes,t.defaultMode)&&n.push({message:`A MultiMode Lexer cannot be initialized with a ${ei}: <${t.defaultMode}>which does not exist
`,type:Te.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),I(t,Ps)&&C(t.modes,(i,o)=>{C(i,(s,a)=>{if(tt(s))n.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${o}> at index: <${a}>
`,type:Te.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(I(s,"LONGER_ALT")){let c=R(s.LONGER_ALT)?s.LONGER_ALT:[s.LONGER_ALT];C(c,l=>{!tt(l)&&!ye(i,l)&&n.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${l.name}> on token <${s.name}> outside of mode <${o}>
`,type:Te.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),n}function yg(t,e,r){let n=[],i=!1,o=Vt(Ge(ie(t.modes))),s=Dr(o,c=>c[sn]===K.NA),a=Lg(r);return e&&C(s,c=>{let l=Ag(c,a);if(l!==!1){let u={message:b0(c,l),type:l.issue,tokenType:c};n.push(u)}else I(c,"LINE_BREAKS")?c.LINE_BREAKS===!0&&(i=!0):Us(a,c.PATTERN)&&(i=!0)}),e&&!i&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Te.NO_LINE_BREAKS_FLAGS}),n}function Tg(t){let e={},r=oe(t);return C(r,n=>{let i=t[n];if(R(i))e[n]=[];else throw Error("non exhaustive match")}),e}function Sg(t){let e=t.PATTERN;if(vt(e))return!1;if(ot(e))return!0;if(I(e,"exec"))return!0;if(je(e))return!1;throw Error("non exhaustive match")}function L0(t){return je(t)&&t.length===1?t.charCodeAt(0):!1}var Og={test:function(t){let e=t.length;for(let r=this.lastIndex;r<e;r++){let n=t.charCodeAt(r);if(n===10)return this.lastIndex=r+1,!0;if(n===13)return t.charCodeAt(r+1)===10?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function Ag(t,e){if(I(t,"LINE_BREAKS"))return!1;if(vt(t.PATTERN)){try{Us(e,t.PATTERN)}catch(r){return{issue:Te.IDENTIFY_TERMINATOR,errMsg:r.message}}return!1}else{if(je(t.PATTERN))return!1;if(Sg(t))return{issue:Te.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function b0(t,e){if(e.issue===Te.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${t.name}> Token Type
	 Root cause: ${e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===Te.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${t.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function Lg(t){return N(t,r=>je(r)?r.charCodeAt(0):r)}function ac(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}var Jn=256,qs=[];function Qt(t){return t<Jn?t:qs[t]}function v0(){if($(qs)){qs=new Array(65536);for(let t=0;t<65536;t++)qs[t]=t>255?255+~~(t/255):t}}function pr(t,e){let r=t.tokenTypeIdx;return r===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[r]===!0}function ti(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}var bg=1,Ng={};function mr(t){let e=N0(t);C0(e),R0(e),I0(e),C(e,r=>{r.isParent=r.categoryMatches.length>0})}function N0(t){let e=ae(t),r=t,n=!0;for(;n;){r=Vt(Ge(N(r,o=>o.CATEGORIES)));let i=qr(r,e);e=e.concat(i),$(i)?n=!1:r=i}return e}function C0(t){C(t,e=>{cc(e)||(Ng[bg]=e,e.tokenTypeIdx=bg++),vg(e)&&!R(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),vg(e)||(e.CATEGORIES=[]),w0(e)||(e.categoryMatches=[]),k0(e)||(e.categoryMatchesMap={})})}function I0(t){C(t,e=>{e.categoryMatches=[],C(e.categoryMatchesMap,(r,n)=>{e.categoryMatches.push(Ng[n].tokenTypeIdx)})})}function R0(t){C(t,e=>{Cg([],e)})}function Cg(t,e){C(t,r=>{e.categoryMatchesMap[r.tokenTypeIdx]=!0}),C(e.CATEGORIES,r=>{let n=t.concat(e);ye(n,r)||Cg(n,r)})}function cc(t){return I(t,"tokenTypeIdx")}function vg(t){return I(t,"CATEGORIES")}function w0(t){return I(t,"categoryMatches")}function k0(t){return I(t,"categoryMatchesMap")}function Ig(t){return I(t,"tokenTypeIdx")}var uc={buildUnableToPopLexerModeMessage(t){return`Unable to pop Lexer Mode after encountering Token ->${t.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(t,e,r,n,i){return`unexpected character: ->${t.charAt(e)}<- at offset: ${e}, skipped ${r} characters.`}};var Te;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",t[t.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(Te||(Te={}));var Fi={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:uc,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(Fi);var K=class{constructor(e,r=Fi){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(i,o)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;let s=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${s}--> <${i}>`);let{time:a,value:c}=ki(o),l=a>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(`${s}<-- <${i}> time: ${a}ms`),this.traceInitIndent--,c}else return o()},typeof r=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Qe({},Fi,r);let n=this.config.traceInitPerf;n===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof n=="number"&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let i,o=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===Fi.lineTerminatorsPattern)this.config.lineTerminatorsPattern=Og;else if(this.config.lineTerminatorCharacters===Fi.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(r.safeMode&&r.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),R(e)?i={modes:{defaultMode:ae(e)},defaultMode:ei}:(o=!1,i=ae(e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(Eg(i,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(yg(i,this.trackStartLines,this.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},C(i.modes,(a,c)=>{i.modes[c]=Dr(a,l=>tt(l))});let s=oe(i.modes);if(C(i.modes,(a,c)=>{this.TRACE_INIT(`Mode: <${c}> processing`,()=>{if(this.modes.push(c),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(xg(a,s))}),$(this.lexerDefinitionErrors)){mr(a);let l;this.TRACE_INIT("analyzeTokenTypes",()=>{l=gg(a,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:r.positionTracking,ensureOptimizations:r.ensureOptimizations,safeMode:r.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[c]=l.patternIdxToConfig,this.charCodeToPatternIdxToConfig[c]=l.charCodeToPatternIdxToConfig,this.emptyGroups=Qe({},this.emptyGroups,l.emptyGroups),this.hasCustom=l.hasCustom||this.hasCustom,this.canModeBeOptimized[c]=l.canBeOptimized}})}),this.defaultMode=i.defaultMode,!$(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){let c=N(this.lexerDefinitionErrors,l=>l.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+c)}C(this.lexerDefinitionWarning,a=>{wi(a.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(lc?(this.chopInput=Lt,this.match=this.matchWithTest):(this.updateLastIndex=Ae,this.match=this.matchWithExec),o&&(this.handleModes=Ae),this.trackStartLines===!1&&(this.computeNewColumn=Lt),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=Ae),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{let a=Be(this.canModeBeOptimized,(c,l,h)=>(l===!1&&c.push(h),c),[]);if(r.ensureOptimizations&&!$(a))throw Error(`Lexer Modes: < ${a.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{ug()}),this.TRACE_INIT("toFastProperties",()=>{_i(this)})})}tokenize(e,r=this.defaultMode){if(!$(this.lexerDefinitionErrors)){let i=N(this.lexerDefinitionErrors,o=>o.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}return this.tokenizeInternal(e,r)}tokenizeInternal(e,r){let n,i,o,s,a,c,l,h,u,f,m,p,g,E,x,T,y=e,O=y.length,A=0,L=0,b=this.hasCustom?0:Math.floor(e.length/10),v=new Array(b),P=[],M=this.trackStartLines?1:void 0,k=this.trackStartLines?1:void 0,U=Tg(this.emptyGroups),w=this.trackStartLines,V=this.config.lineTerminatorsPattern,X=0,re=[],j=[],Z=[],_t=[];Object.freeze(_t);let Ue;function Pe(){return re}function He(ve){let q=Qt(ve),W=j[q];return W===void 0?_t:W}let Ft=ve=>{if(Z.length===1&&ve.tokenType.PUSH_MODE===void 0){let q=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(ve);P.push({offset:ve.startOffset,line:ve.startLine,column:ve.startColumn,length:ve.image.length,message:q})}else{Z.pop();let q=Yt(Z);re=this.patternIdxToConfig[q],j=this.charCodeToPatternIdxToConfig[q],X=re.length;let W=this.canModeBeOptimized[q]&&this.config.safeMode===!1;j&&W?Ue=He:Ue=Pe}};function Ot(ve){Z.push(ve),j=this.charCodeToPatternIdxToConfig[ve],re=this.patternIdxToConfig[ve],X=re.length,X=re.length;let q=this.canModeBeOptimized[ve]&&this.config.safeMode===!1;j&&q?Ue=He:Ue=Pe}Ot.call(this,r);let Xe,Bt=this.config.recoveryEnabled;for(;A<O;){c=null;let ve=y.charCodeAt(A),q=Ue(ve),W=q.length;for(n=0;n<W;n++){Xe=q[n];let ne=Xe.pattern;l=null;let ge=Xe.short;if(ge!==!1?ve===ge&&(c=ne):Xe.isCustom===!0?(T=ne.exec(y,A,v,U),T!==null?(c=T[0],T.payload!==void 0&&(l=T.payload)):c=null):(this.updateLastIndex(ne,A),c=this.match(ne,e,A)),c!==null){if(a=Xe.longerAlt,a!==void 0){let xe=a.length;for(o=0;o<xe;o++){let Ee=re[a[o]],Ke=Ee.pattern;if(h=null,Ee.isCustom===!0?(T=Ke.exec(y,A,v,U),T!==null?(s=T[0],T.payload!==void 0&&(h=T.payload)):s=null):(this.updateLastIndex(Ke,A),s=this.match(Ke,e,A)),s&&s.length>c.length){c=s,l=h,Xe=Ee;break}}}break}}if(c!==null){if(u=c.length,f=Xe.group,f!==void 0&&(m=Xe.tokenTypeIdx,p=this.createTokenInstance(c,A,m,Xe.tokenType,M,k,u),this.handlePayload(p,l),f===!1?L=this.addToken(v,L,p):U[f].push(p)),e=this.chopInput(e,u),A=A+u,k=this.computeNewColumn(k,u),w===!0&&Xe.canLineTerminator===!0){let ne=0,ge,xe;V.lastIndex=0;do ge=V.test(c),ge===!0&&(xe=V.lastIndex-1,ne++);while(ge===!0);ne!==0&&(M=M+ne,k=u-xe,this.updateTokenEndLineColumnLocation(p,f,xe,ne,M,k,u))}this.handleModes(Xe,Ft,Ot,p)}else{let ne=A,ge=M,xe=k,Ee=Bt===!1;for(;Ee===!1&&A<O;)for(e=this.chopInput(e,1),A++,i=0;i<X;i++){let Ke=re[i],nt=Ke.pattern,At=Ke.short;if(At!==!1?y.charCodeAt(A)===At&&(Ee=!0):Ke.isCustom===!0?Ee=nt.exec(y,A,v,U)!==null:(this.updateLastIndex(nt,A),Ee=nt.exec(e)!==null),Ee===!0)break}if(g=A-ne,k=this.computeNewColumn(k,g),x=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(y,ne,g,ge,xe),P.push({offset:ne,line:ge,column:xe,length:g,message:x}),Bt===!1)break}}return this.hasCustom||(v.length=L),{tokens:v,groups:U,errors:P}}handleModes(e,r,n,i){if(e.pop===!0){let o=e.push;r(i),o!==void 0&&n.call(this,o)}else e.push!==void 0&&n.call(this,e.push)}chopInput(e,r){return e.substring(r)}updateLastIndex(e,r){e.lastIndex=r}updateTokenEndLineColumnLocation(e,r,n,i,o,s,a){let c,l;r!==void 0&&(c=n===a-1,l=c?-1:0,i===1&&c===!0||(e.endLine=o+l,e.endColumn=s-1+-l))}computeNewColumn(e,r){return e+r}createOffsetOnlyToken(e,r,n,i){return{image:e,startOffset:r,tokenTypeIdx:n,tokenType:i}}createStartOnlyToken(e,r,n,i,o,s){return{image:e,startOffset:r,startLine:o,startColumn:s,tokenTypeIdx:n,tokenType:i}}createFullToken(e,r,n,i,o,s,a){return{image:e,startOffset:r,endOffset:r+a-1,startLine:o,endLine:o,startColumn:s,endColumn:s+a-1,tokenTypeIdx:n,tokenType:i}}addTokenUsingPush(e,r,n){return e.push(n),r}addTokenUsingMemberAccess(e,r,n){return e[r]=n,r++,r}handlePayloadNoCustom(e,r){}handlePayloadWithCustom(e,r){r!==null&&(e.payload=r)}matchWithTest(e,r,n){return e.test(r)===!0?r.substring(n,e.lastIndex):null}matchWithExec(e,r){let n=e.exec(r);return n!==null?n[0]:null}};K.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";K.NA=/NOT_APPLICABLE/;function an(t){return hc(t)?t.LABEL:t.name}function hc(t){return je(t.LABEL)&&t.LABEL!==""}var _0="parent",Rg="categories",wg="label",kg="group",_g="push_mode",Mg="pop_mode",Ug="longer_alt",Pg="line_breaks",qg="start_chars_hint";function S(t){return M0(t)}function M0(t){let e=t.pattern,r={};if(r.name=t.name,tt(e)||(r.PATTERN=e),I(t,_0))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return I(t,Rg)&&(r.CATEGORIES=t[Rg]),mr([r]),I(t,wg)&&(r.LABEL=t[wg]),I(t,kg)&&(r.GROUP=t[kg]),I(t,Mg)&&(r.POP_MODE=t[Mg]),I(t,_g)&&(r.PUSH_MODE=t[_g]),I(t,Ug)&&(r.LONGER_ALT=t[Ug]),I(t,Pg)&&(r.LINE_BREAKS=t[Pg]),I(t,qg)&&(r.START_CHARS_HINT=t[qg]),r}var te=S({name:"EOF",pattern:K.NA});mr([te]);function ln(t,e,r,n,i,o,s,a){return{image:e,startOffset:r,endOffset:n,startLine:i,endLine:o,startColumn:s,endColumn:a,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function fc(t,e){return pr(t,e)}var Ds={buildMismatchTokenMessage({expected:t,actual:e,previous:r,ruleName:n}){return`Expecting ${hc(t)?`--> ${an(t)} <--`:`token of type --> ${t.name} <--`} but found --> '${e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:t,ruleName:e}){return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage({expectedPathsPerAlt:t,actual:e,previous:r,customUserDescription:n,ruleName:i}){let o="Expecting: ",a=`
but found: '`+Ve(e).image+"'";if(n)return o+n+a;{let c=Be(t,(f,m)=>f.concat(m),[]),l=N(c,f=>`[${N(f,m=>an(m)).join(", ")}]`),u=`one of these possible Token sequences:
${N(l,(f,m)=>`  ${m+1}. ${f}`).join(`
`)}`;return o+u+a}},buildEarlyExitMessage({expectedIterationPaths:t,actual:e,customUserDescription:r,ruleName:n}){let i="Expecting: ",s=`
but found: '`+Ve(e).image+"'";if(r)return i+r+s;{let c=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${N(t,l=>`[${N(l,h=>an(h)).join(",")}]`).join(" ,")}>`;return i+c+s}}};Object.freeze(Ds);var Dg={buildRuleNotFoundError(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-"}},Ut={buildDuplicateFoundError(t,e){function r(h){return h instanceof H?h.terminalType.name:h instanceof le?h.nonTerminalName:""}let n=t.name,i=Ve(e),o=i.idx,s=mt(i),a=r(i),c=o>0,l=`->${s}${c?o:""}<- ${a?`with argument: ->${a}<-`:""}
                  appears more than once (${e.length} times) in the top level rule: ->${n}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return l=l.replace(/[ \t]+/g," "),l=l.replace(/\s\s+/g,`
`),l},buildNamespaceConflictError(t){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${t.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(t){let e=N(t.prefixPath,i=>an(i)).join(", "),r=t.alternation.idx===0?"":t.alternation.idx;return`Ambiguous alternatives: <${t.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${r}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(t){let e=N(t.prefixPath,i=>an(i)).join(", "),r=t.alternation.idx===0?"":t.alternation.idx,n=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(" ,")}> in <OR${r}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return n=n+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError(t){let e=mt(t.repetition);return t.repetition.idx!==0&&(e+=t.repetition.idx),`The repetition <${e}> within Rule <${t.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(t){return"deprecated"},buildEmptyAlternationError(t){return`Ambiguous empty alternative: <${t.emptyChoiceIdx+1}> in <OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(t){return`An Alternation cannot have more than 256 alternatives:
<OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
 has ${t.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(t){let e=t.topLevelRule.name,r=N(t.leftRecursionPath,o=>o.name),n=`${e} --> ${r.concat([e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${n}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(t){return"deprecated"},buildDuplicateRuleNameError(t){let e;return t.topLevelRule instanceof at?e=t.topLevelRule.name:e=t.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${t.grammarName}<-`}};function Fg(t,e){let r=new dc(t,e);return r.resolveRefs(),r.errors}var dc=class extends lt{constructor(e,r){super(),this.nameToTopRule=e,this.errMsgProvider=r,this.errors=[]}resolveRefs(){C(ie(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){let r=this.nameToTopRule[e.nonTerminalName];if(r)e.referencedRule=r;else{let n=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:n,type:We.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}};var pc=class extends dr{constructor(e,r){super(),this.topProd=e,this.path=r,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=ae(this.path.ruleStack).reverse(),this.occurrenceStack=ae(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,r=[]){this.found||super.walk(e,r)}walkProdRef(e,r,n){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){let i=r.concat(n);this.updateExpectedNext(),this.walk(e.referencedRule,i)}}updateExpectedNext(){$(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}},Fs=class extends pc{constructor(e,r){super(e,r),this.path=r,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,r,n){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){let i=r.concat(n),o=new ce({definition:i});this.possibleTokTypes=nn(o),this.found=!0}}},ri=class extends dr{constructor(e,r){super(),this.topRule=e,this.occurrence=r,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}},Bs=class extends ri{walkMany(e,r,n){if(e.idx===this.occurrence){let i=Ve(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof H&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkMany(e,r,n)}},Bi=class extends ri{walkManySep(e,r,n){if(e.idx===this.occurrence){let i=Ve(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof H&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkManySep(e,r,n)}},$s=class extends ri{walkAtLeastOne(e,r,n){if(e.idx===this.occurrence){let i=Ve(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof H&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOne(e,r,n)}},$i=class extends ri{walkAtLeastOneSep(e,r,n){if(e.idx===this.occurrence){let i=Ve(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof H&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOneSep(e,r,n)}};function Ks(t,e,r=[]){r=ae(r);let n=[],i=0;function o(a){return a.concat(we(t,i+1))}function s(a){let c=Ks(o(a),e,r);return n.concat(c)}for(;r.length<e&&i<t.length;){let a=t[i];if(a instanceof ce)return s(a.definition);if(a instanceof le)return s(a.definition);if(a instanceof de)n=s(a.definition);else if(a instanceof ke){let c=a.definition.concat([new ee({definition:a.definition})]);return s(c)}else if(a instanceof _e){let c=[new ce({definition:a.definition}),new ee({definition:[new H({terminalType:a.separator})].concat(a.definition)})];return s(c)}else if(a instanceof Ne){let c=a.definition.concat([new ee({definition:[new H({terminalType:a.separator})].concat(a.definition)})]);n=s(c)}else if(a instanceof ee){let c=a.definition.concat([new ee({definition:a.definition})]);n=s(c)}else{if(a instanceof Ce)return C(a.definition,c=>{$(c.definition)===!1&&(n=s(c.definition))}),n;if(a instanceof H)r.push(a.terminalType);else throw Error("non exhaustive match")}i++}return n.push({partialPath:r,suffixDef:we(t,i)}),n}function Gs(t,e,r,n){let i="EXIT_NONE_TERMINAL",o=[i],s="EXIT_ALTERNATIVE",a=!1,c=e.length,l=c-n-1,h=[],u=[];for(u.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!$(u);){let f=u.pop();if(f===s){a&&Yt(u).idx<=l&&u.pop();continue}let m=f.def,p=f.idx,g=f.ruleStack,E=f.occurrenceStack;if($(m))continue;let x=m[0];if(x===i){let T={idx:p,def:we(m),ruleStack:fr(g),occurrenceStack:fr(E)};u.push(T)}else if(x instanceof H)if(p<c-1){let T=p+1,y=e[T];if(r(y,x.terminalType)){let O={idx:T,def:we(m),ruleStack:g,occurrenceStack:E};u.push(O)}}else if(p===c-1)h.push({nextTokenType:x.terminalType,nextTokenOccurrence:x.idx,ruleStack:g,occurrenceStack:E}),a=!0;else throw Error("non exhaustive match");else if(x instanceof le){let T=ae(g);T.push(x.nonTerminalName);let y=ae(E);y.push(x.idx);let O={idx:p,def:x.definition.concat(o,we(m)),ruleStack:T,occurrenceStack:y};u.push(O)}else if(x instanceof de){let T={idx:p,def:we(m),ruleStack:g,occurrenceStack:E};u.push(T),u.push(s);let y={idx:p,def:x.definition.concat(we(m)),ruleStack:g,occurrenceStack:E};u.push(y)}else if(x instanceof ke){let T=new ee({definition:x.definition,idx:x.idx}),y=x.definition.concat([T],we(m)),O={idx:p,def:y,ruleStack:g,occurrenceStack:E};u.push(O)}else if(x instanceof _e){let T=new H({terminalType:x.separator}),y=new ee({definition:[T].concat(x.definition),idx:x.idx}),O=x.definition.concat([y],we(m)),A={idx:p,def:O,ruleStack:g,occurrenceStack:E};u.push(A)}else if(x instanceof Ne){let T={idx:p,def:we(m),ruleStack:g,occurrenceStack:E};u.push(T),u.push(s);let y=new H({terminalType:x.separator}),O=new ee({definition:[y].concat(x.definition),idx:x.idx}),A=x.definition.concat([O],we(m)),L={idx:p,def:A,ruleStack:g,occurrenceStack:E};u.push(L)}else if(x instanceof ee){let T={idx:p,def:we(m),ruleStack:g,occurrenceStack:E};u.push(T),u.push(s);let y=new ee({definition:x.definition,idx:x.idx}),O=x.definition.concat([y],we(m)),A={idx:p,def:O,ruleStack:g,occurrenceStack:E};u.push(A)}else if(x instanceof Ce)for(let T=x.definition.length-1;T>=0;T--){let y=x.definition[T],O={idx:p,def:y.definition.concat(we(m)),ruleStack:g,occurrenceStack:E};u.push(O),u.push(s)}else if(x instanceof ce)u.push({idx:p,def:x.definition.concat(we(m)),ruleStack:g,occurrenceStack:E});else if(x instanceof at)u.push(U0(x,p,g,E));else throw Error("non exhaustive match")}return h}function U0(t,e,r,n){let i=ae(r);i.push(t.name);let o=ae(n);return o.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:o}}var Le;(function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(Le||(Le={}));function Ws(t){if(t instanceof de||t==="Option")return Le.OPTION;if(t instanceof ee||t==="Repetition")return Le.REPETITION;if(t instanceof ke||t==="RepetitionMandatory")return Le.REPETITION_MANDATORY;if(t instanceof _e||t==="RepetitionMandatoryWithSeparator")return Le.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof Ne||t==="RepetitionWithSeparator")return Le.REPETITION_WITH_SEPARATOR;if(t instanceof Ce||t==="Alternation")return Le.ALTERNATION;throw Error("non exhaustive match")}function $g(t,e,r,n,i,o){let s=Ki(t,e,r),a=zg(s)?ti:pr;return o(s,n,a,i)}function Kg(t,e,r,n,i,o){let s=Gi(t,e,i,r),a=zg(s)?ti:pr;return o(s[0],a,n)}function Gg(t,e,r,n){let i=t.length,o=Je(t,s=>Je(s,a=>a.length===1));if(e)return function(s){let a=N(s,c=>c.GATE);for(let c=0;c<i;c++){let l=t[c],h=l.length,u=a[c];if(!(u!==void 0&&u.call(this)===!1))e:for(let f=0;f<h;f++){let m=l[f],p=m.length;for(let g=0;g<p;g++){let E=this.LA(g+1);if(r(E,m[g])===!1)continue e}return c}}};if(o&&!n){let s=N(t,c=>Ge(c)),a=Be(s,(c,l,h)=>(C(l,u=>{I(c,u.tokenTypeIdx)||(c[u.tokenTypeIdx]=h),C(u.categoryMatches,f=>{I(c,f)||(c[f]=h)})}),c),{});return function(){let c=this.LA(1);return a[c.tokenTypeIdx]}}else return function(){for(let s=0;s<i;s++){let a=t[s],c=a.length;e:for(let l=0;l<c;l++){let h=a[l],u=h.length;for(let f=0;f<u;f++){let m=this.LA(f+1);if(r(m,h[f])===!1)continue e}return s}}}}function jg(t,e,r){let n=Je(t,o=>o.length===1),i=t.length;if(n&&!r){let o=Ge(t);if(o.length===1&&$(o[0].categoryMatches)){let a=o[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{let s=Be(o,(a,c,l)=>(a[c.tokenTypeIdx]=!0,C(c.categoryMatches,h=>{a[h]=!0}),a),[]);return function(){let a=this.LA(1);return s[a.tokenTypeIdx]===!0}}}else return function(){e:for(let o=0;o<i;o++){let s=t[o],a=s.length;for(let c=0;c<a;c++){let l=this.LA(c+1);if(e(l,s[c])===!1)continue e}return!0}return!1}}var gc=class extends dr{constructor(e,r,n){super(),this.topProd=e,this.targetOccurrence=r,this.targetProdType=n}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,r,n,i){return e.idx===this.targetOccurrence&&this.targetProdType===r?(this.restDef=n.concat(i),!0):!1}walkOption(e,r,n){this.checkIsTarget(e,Le.OPTION,r,n)||super.walkOption(e,r,n)}walkAtLeastOne(e,r,n){this.checkIsTarget(e,Le.REPETITION_MANDATORY,r,n)||super.walkOption(e,r,n)}walkAtLeastOneSep(e,r,n){this.checkIsTarget(e,Le.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||super.walkOption(e,r,n)}walkMany(e,r,n){this.checkIsTarget(e,Le.REPETITION,r,n)||super.walkOption(e,r,n)}walkManySep(e,r,n){this.checkIsTarget(e,Le.REPETITION_WITH_SEPARATOR,r,n)||super.walkOption(e,r,n)}},js=class extends lt{constructor(e,r,n){super(),this.targetOccurrence=e,this.targetProdType=r,this.targetRef=n,this.result=[]}checkIsTarget(e,r){e.idx===this.targetOccurrence&&this.targetProdType===r&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,Le.OPTION)}visitRepetition(e){this.checkIsTarget(e,Le.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,Le.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,Le.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,Le.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,Le.ALTERNATION)}};function Bg(t){let e=new Array(t);for(let r=0;r<t;r++)e[r]=[];return e}function mc(t){let e=[""];for(let r=0;r<t.length;r++){let n=t[r],i=[];for(let o=0;o<e.length;o++){let s=e[o];i.push(s+"_"+n.tokenTypeIdx);for(let a=0;a<n.categoryMatches.length;a++){let c="_"+n.categoryMatches[a];i.push(s+c)}}e=i}return e}function P0(t,e,r){for(let n=0;n<t.length;n++){if(n===r)continue;let i=t[n];for(let o=0;o<e.length;o++){let s=e[o];if(i[s]===!0)return!1}}return!0}function Wg(t,e){let r=N(t,s=>Ks([s],1)),n=Bg(r.length),i=N(r,s=>{let a={};return C(s,c=>{let l=mc(c.partialPath);C(l,h=>{a[h]=!0})}),a}),o=r;for(let s=1;s<=e;s++){let a=o;o=Bg(a.length);for(let c=0;c<a.length;c++){let l=a[c];for(let h=0;h<l.length;h++){let u=l[h].partialPath,f=l[h].suffixDef,m=mc(u);if(P0(i,m,c)||$(f)||u.length===e){let g=n[c];if(Hs(g,u)===!1){g.push(u);for(let E=0;E<m.length;E++){let x=m[E];i[c][x]=!0}}}else{let g=Ks(f,s+1,u);o[c]=o[c].concat(g),C(g,E=>{let x=mc(E.partialPath);C(x,T=>{i[c][T]=!0})})}}}}return n}function Ki(t,e,r,n){let i=new js(t,Le.ALTERNATION,n);return e.accept(i),Wg(i.result,r)}function Gi(t,e,r,n){let i=new js(t,r);e.accept(i);let o=i.result,a=new gc(e,t,r).startWalking(),c=new ce({definition:o}),l=new ce({definition:a});return Wg([c,l],n)}function Hs(t,e){e:for(let r=0;r<t.length;r++){let n=t[r];if(n.length===e.length){for(let i=0;i<n.length;i++){let o=e[i],s=n[i];if((o===s||s.categoryMatchesMap[o.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function Hg(t,e){return t.length<e.length&&Je(t,(r,n)=>{let i=e[n];return r===i||i.categoryMatchesMap[r.tokenTypeIdx]})}function zg(t){return Je(t,e=>Je(e,r=>Je(r,n=>$(n.categoryMatches))))}function Vg(t){let e=t.lookaheadStrategy.validate({rules:t.rules,tokenTypes:t.tokenTypes,grammarName:t.grammarName});return N(e,r=>Object.assign({type:We.CUSTOM_LOOKAHEAD_VALIDATION},r))}function Yg(t,e,r,n){let i=st(t,c=>q0(c,r)),o=G0(t,e,r),s=st(t,c=>B0(c,r)),a=st(t,c=>F0(c,t,n,r));return i.concat(o,s,a)}function q0(t,e){let r=new xc;t.accept(r);let n=r.allProductions,i=Zl(n,D0),o=pt(i,a=>a.length>1);return N(ie(o),a=>{let c=Ve(a),l=e.buildDuplicateFoundError(t,a),h=mt(c),u={message:l,type:We.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:h,occurrence:c.idx},f=Xg(c);return f&&(u.parameter=f),u})}function D0(t){return`${mt(t)}_#_${t.idx}_#_${Xg(t)}`}function Xg(t){return t instanceof H?t.terminalType.name:t instanceof le?t.nonTerminalName:""}var xc=class extends lt{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}};function F0(t,e,r,n){let i=[];if(Be(e,(s,a)=>a.name===t.name?s+1:s,0)>1){let s=n.buildDuplicateRuleNameError({topLevelRule:t,grammarName:r});i.push({message:s,type:We.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}function Qg(t,e,r){let n=[],i;return ye(e,t)||(i=`Invalid rule override, rule: ->${t}<- cannot be overridden in the grammar: ->${r}<-as it is not defined in any of the super grammars `,n.push({message:i,type:We.INVALID_RULE_OVERRIDE,ruleName:t})),n}function yc(t,e,r,n=[]){let i=[],o=zs(e.definition);if($(o))return[];{let s=t.name;ye(o,t)&&i.push({message:r.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:n}),type:We.LEFT_RECURSION,ruleName:s});let c=qr(o,n.concat([t])),l=st(c,h=>{let u=ae(n);return u.push(h),yc(t,h,r,u)});return i.concat(l)}}function zs(t){let e=[];if($(t))return e;let r=Ve(t);if(r instanceof le)e.push(r.referencedRule);else if(r instanceof ce||r instanceof de||r instanceof ke||r instanceof _e||r instanceof Ne||r instanceof ee)e=e.concat(zs(r.definition));else if(r instanceof Ce)e=Ge(N(r.definition,o=>zs(o.definition)));else if(!(r instanceof H))throw Error("non exhaustive match");let n=rn(r),i=t.length>1;if(n&&i){let o=we(t);return e.concat(zs(o))}else return e}var ji=class extends lt{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(e)}};function Zg(t,e){let r=new ji;t.accept(r);let n=r.alternations;return st(n,o=>{let s=fr(o.definition);return st(s,(a,c)=>{let l=Gs([a],[],pr,1);return $(l)?[{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:o,emptyChoiceIdx:c}),type:We.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:o.idx,alternative:c+1}]:[]})})}function Jg(t,e,r){let n=new ji;t.accept(n);let i=n.alternations;return i=Dr(i,s=>s.ignoreAmbiguities===!0),st(i,s=>{let a=s.idx,c=s.maxLookahead||e,l=Ki(a,t,c,s),h=$0(l,s,t,r),u=K0(l,s,t,r);return h.concat(u)})}var Ec=class extends lt{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}};function B0(t,e){let r=new ji;t.accept(r);let n=r.alternations;return st(n,o=>o.definition.length>255?[{message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:o}),type:We.TOO_MANY_ALTS,ruleName:t.name,occurrence:o.idx}]:[])}function ex(t,e,r){let n=[];return C(t,i=>{let o=new Ec;i.accept(o);let s=o.allProductions;C(s,a=>{let c=Ws(a),l=a.maxLookahead||e,h=a.idx,f=Gi(h,i,c,l)[0];if($(Ge(f))){let m=r.buildEmptyRepetitionError({topLevelRule:i,repetition:a});n.push({message:m,type:We.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),n}function $0(t,e,r,n){let i=[],o=Be(t,(a,c,l)=>(e.definition[l].ignoreAmbiguities===!0||C(c,h=>{let u=[l];C(t,(f,m)=>{l!==m&&Hs(f,h)&&e.definition[m].ignoreAmbiguities!==!0&&u.push(m)}),u.length>1&&!Hs(i,h)&&(i.push(h),a.push({alts:u,path:h}))}),a),[]);return N(o,a=>{let c=N(a.alts,h=>h+1);return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:c,prefixPath:a.path}),type:We.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:e.idx,alternatives:a.alts}})}function K0(t,e,r,n){let i=Be(t,(s,a,c)=>{let l=N(a,h=>({idx:c,path:h}));return s.concat(l)},[]);return Vt(st(i,s=>{if(e.definition[s.idx].ignoreAmbiguities===!0)return[];let c=s.idx,l=s.path,h=et(i,f=>e.definition[f.idx].ignoreAmbiguities!==!0&&f.idx<c&&Hg(f.path,l));return N(h,f=>{let m=[f.idx+1,c+1],p=e.idx===0?"":e.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:m,prefixPath:f.path}),type:We.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:p,alternatives:m}})}))}function G0(t,e,r){let n=[],i=N(e,o=>o.name);return C(t,o=>{let s=o.name;if(ye(i,s)){let a=r.buildNamespaceConflictError(o);n.push({message:a,type:We.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:s})}}),n}function tx(t){let e=zn(t,{errMsgProvider:Dg}),r={};return C(t.rules,n=>{r[n.name]=n}),Fg(r,e.errMsgProvider)}function rx(t){return t=zn(t,{errMsgProvider:Ut}),Yg(t.rules,t.tokenTypes,t.errMsgProvider,t.grammarName)}var nx="MismatchedTokenException",ix="NoViableAltException",ox="EarlyExitException",sx="NotAllInputParsedException",ax=[nx,ix,ox,sx];Object.freeze(ax);function Br(t){return ye(ax,t.name)}var ni=class extends Error{constructor(e,r){super(e),this.token=r,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},cn=class extends ni{constructor(e,r,n){super(e,r),this.previousToken=n,this.name=nx}},Wi=class extends ni{constructor(e,r,n){super(e,r),this.previousToken=n,this.name=ix}},Hi=class extends ni{constructor(e,r){super(e,r),this.name=sx}},zi=class extends ni{constructor(e,r,n){super(e,r),this.previousToken=n,this.name=ox}};var Tc={},Oc="InRuleRecoveryException",Sc=class extends Error{constructor(e){super(e),this.name=Oc}},Vs=class{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=I(e,"recoveryEnabled")?e.recoveryEnabled:ct.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=j0)}getTokenToInsert(e){let r=ln(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return r.isInsertedInRecovery=!0,r}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){return!0}tryInRepetitionRecovery(e,r,n,i){let o=this.findReSyncTokenType(),s=this.exportLexerState(),a=[],c=!1,l=this.LA(1),h=this.LA(1),u=()=>{let f=this.LA(0),m=this.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:l,previous:f,ruleName:this.getCurrRuleFullName()}),p=new cn(m,l,this.LA(0));p.resyncedTokens=fr(a),this.SAVE_ERROR(p)};for(;!c;)if(this.tokenMatcher(h,i)){u();return}else if(n.call(this)){u(),e.apply(this,r);return}else this.tokenMatcher(h,o)?c=!0:(h=this.SKIP_TOKEN(),this.addToResyncTokens(h,a));this.importLexerState(s)}shouldInRepetitionRecoveryBeTried(e,r,n){return!(n===!1||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,r)))}getFollowsForInRuleRecovery(e,r){let n=this.getCurrentGrammarPath(e,r);return this.getNextPossibleTokenTypes(n)}tryInRuleRecovery(e,r){if(this.canRecoverWithSingleTokenInsertion(e,r))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){let n=this.SKIP_TOKEN();return this.consumeToken(),n}throw new Sc("sad sad panda")}canPerformInRuleRecovery(e,r){return this.canRecoverWithSingleTokenInsertion(e,r)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,r){if(!this.canTokenTypeBeInsertedInRecovery(e)||$(r))return!1;let n=this.LA(1);return Xt(r,o=>this.tokenMatcher(n,o))!==void 0}canRecoverWithSingleTokenDeletion(e){return this.canTokenTypeBeDeletedInRecovery(e)?this.tokenMatcher(this.LA(2),e):!1}isInCurrentRuleReSyncSet(e){let r=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(r);return ye(n,e)}findReSyncTokenType(){let e=this.flattenFollowSet(),r=this.LA(1),n=2;for(;;){let i=Xt(e,o=>fc(r,o));if(i!==void 0)return i;r=this.LA(n),n++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return Tc;let e=this.getLastExplicitRuleShortName(),r=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:r,inRule:this.shortRuleNameToFullName(n)}}buildFullFollowKeyStack(){let e=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return N(e,(n,i)=>i===0?Tc:{ruleName:this.shortRuleNameToFullName(n),idxInCallingRule:r[i],inRule:this.shortRuleNameToFullName(e[i-1])})}flattenFollowSet(){let e=N(this.buildFullFollowKeyStack(),r=>this.getFollowSetFromFollowKey(r));return Ge(e)}getFollowSetFromFollowKey(e){if(e===Tc)return[te];let r=e.ruleName+e.idxInCallingRule+Rs+e.inRule;return this.resyncFollows[r]}addToResyncTokens(e,r){return this.tokenMatcher(e,te)||r.push(e),r}reSyncTo(e){let r=[],n=this.LA(1);for(;this.tokenMatcher(n,e)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,r);return fr(r)}attemptInRepetitionRecovery(e,r,n,i,o,s,a){}getCurrentGrammarPath(e,r){let n=this.getHumanReadableRuleStack(),i=ae(this.RULE_OCCURRENCE_STACK);return{ruleStack:n,occurrenceStack:i,lastTok:e,lastTokOccurrence:r}}getHumanReadableRuleStack(){return N(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}};function j0(t,e,r,n,i,o,s){let a=this.getKeyForAutomaticLookahead(n,i),c=this.firstAfterRepMap[a];if(c===void 0){let f=this.getCurrRuleFullName(),m=this.getGAstProductions()[f];c=new o(m,i).startWalking(),this.firstAfterRepMap[a]=c}let l=c.token,h=c.occurrence,u=c.isEndOfRule;this.RULE_STACK.length===1&&u&&l===void 0&&(l=te,h=1),!(l===void 0||h===void 0)&&this.shouldInRepetitionRecoveryBeTried(l,h,s)&&this.tryInRepetitionRecovery(t,e,r,l)}function Ys(t,e,r){return r|e|t}var Vi=class{constructor(e){var r;this.maxLookahead=(r=e?.maxLookahead)!==null&&r!==void 0?r:ct.maxLookahead}validate(e){let r=this.validateNoLeftRecursion(e.rules);if($(r)){let n=this.validateEmptyOrAlternatives(e.rules),i=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),o=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...r,...n,...i,...o]}return r}validateNoLeftRecursion(e){return st(e,r=>yc(r,r,Ut))}validateEmptyOrAlternatives(e){return st(e,r=>Zg(r,Ut))}validateAmbiguousAlternationAlternatives(e,r){return st(e,n=>Jg(n,r,Ut))}validateSomeNonEmptyLookaheadPath(e,r){return ex(e,r,Ut)}buildLookaheadForAlternation(e){return $g(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,Gg)}buildLookaheadForOptional(e){return Kg(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,Ws(e.prodType),jg)}};var Qs=class{initLooksAhead(e){this.dynamicTokensEnabled=I(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:ct.dynamicTokensEnabled,this.maxLookahead=I(e,"maxLookahead")?e.maxLookahead:ct.maxLookahead,this.lookaheadStrategy=I(e,"lookaheadStrategy")?e.lookaheadStrategy:new Vi({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){C(e,r=>{this.TRACE_INIT(`${r.name} Rule Lookahead`,()=>{let{alternation:n,repetition:i,option:o,repetitionMandatory:s,repetitionMandatoryWithSeparator:a,repetitionWithSeparator:c}=W0(r);C(n,l=>{let h=l.idx===0?"":l.idx;this.TRACE_INIT(`${mt(l)}${h}`,()=>{let u=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:l.idx,rule:r,maxLookahead:l.maxLookahead||this.maxLookahead,hasPredicates:l.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),f=Ys(this.fullRuleNameToShort[r.name],256,l.idx);this.setLaFuncCache(f,u)})}),C(i,l=>{this.computeLookaheadFunc(r,l.idx,768,"Repetition",l.maxLookahead,mt(l))}),C(o,l=>{this.computeLookaheadFunc(r,l.idx,512,"Option",l.maxLookahead,mt(l))}),C(s,l=>{this.computeLookaheadFunc(r,l.idx,1024,"RepetitionMandatory",l.maxLookahead,mt(l))}),C(a,l=>{this.computeLookaheadFunc(r,l.idx,1536,"RepetitionMandatoryWithSeparator",l.maxLookahead,mt(l))}),C(c,l=>{this.computeLookaheadFunc(r,l.idx,1280,"RepetitionWithSeparator",l.maxLookahead,mt(l))})})})}computeLookaheadFunc(e,r,n,i,o,s){this.TRACE_INIT(`${s}${r===0?"":r}`,()=>{let a=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:r,rule:e,maxLookahead:o||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:i}),c=Ys(this.fullRuleNameToShort[e.name],n,r);this.setLaFuncCache(c,a)})}getKeyForAutomaticLookahead(e,r){let n=this.getLastExplicitRuleShortName();return Ys(n,e,r)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,r){this.lookAheadFuncsCache.set(e,r)}},Ac=class extends lt{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}},Xs=new Ac;function W0(t){Xs.reset(),t.accept(Xs);let e=Xs.dslMethods;return Xs.reset(),e}function vc(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function Nc(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function lx(t,e,r){t.children[r]===void 0?t.children[r]=[e]:t.children[r].push(e)}function cx(t,e,r){t.children[e]===void 0?t.children[e]=[r]:t.children[e].push(r)}var H0="name";function Cc(t,e){Object.defineProperty(t,H0,{enumerable:!1,configurable:!0,writable:!1,value:e})}function z0(t,e){let r=oe(t),n=r.length;for(let i=0;i<n;i++){let o=r[i],s=t[o],a=s.length;for(let c=0;c<a;c++){let l=s[c];l.tokenTypeIdx===void 0&&this[l.name](l.children,e)}}}function ux(t,e){let r=function(){};Cc(r,t+"BaseSemantics");let n={visit:function(i,o){if(R(i)&&(i=i[0]),!tt(i))return this[i.name](i.children,o)},validateVisitor:function(){let i=V0(this,e);if(!$(i)){let o=N(i,s=>s.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${o.join(`

`).replace(/\n/g,`
	`)}`)}}};return r.prototype=n,r.prototype.constructor=r,r._RULE_NAMES=e,r}function hx(t,e,r){let n=function(){};Cc(n,t+"BaseSemanticsWithDefaults");let i=Object.create(r.prototype);return C(e,o=>{i[o]=z0}),n.prototype=i,n.prototype.constructor=n,n}var Ic;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(Ic||(Ic={}));function V0(t,e){return Y0(t,e)}function Y0(t,e){let r=et(e,i=>ot(t[i])===!1),n=N(r,i=>({msg:`Missing visitor method: <${i}> on ${t.constructor.name} CST Visitor.`,type:Ic.MISSING_METHOD,methodName:i}));return Vt(n)}var ta=class{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=I(e,"nodeLocationTracking")?e.nodeLocationTracking:ct.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Ae,this.cstFinallyStateUpdate=Ae,this.cstPostTerminal=Ae,this.cstPostNonTerminal=Ae,this.cstPostRule=Ae;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Nc,this.setNodeLocationFromNode=Nc,this.cstPostRule=Ae,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Ae,this.setNodeLocationFromNode=Ae,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=vc,this.setNodeLocationFromNode=vc,this.cstPostRule=Ae,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Ae,this.setNodeLocationFromNode=Ae,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Ae,this.setNodeLocationFromNode=Ae,this.cstPostRule=Ae,this.setInitialNodeLocation=Ae;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){let r=this.LA(1);e.location={startOffset:r.startOffset,startLine:r.startLine,startColumn:r.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){let r={name:e,children:Object.create(null)};this.setInitialNodeLocation(r),this.CST_STACK.push(r)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){let r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?(n.endOffset=r.endOffset,n.endLine=r.endLine,n.endColumn=r.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)}cstPostRuleOnlyOffset(e){let r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?n.endOffset=r.endOffset:n.startOffset=NaN}cstPostTerminal(e,r){let n=this.CST_STACK[this.CST_STACK.length-1];lx(n,r,e),this.setNodeLocationFromToken(n.location,r)}cstPostNonTerminal(e,r){let n=this.CST_STACK[this.CST_STACK.length-1];cx(n,r,e),this.setNodeLocationFromNode(n.location,e.location)}getBaseCstVisitorConstructor(){if(tt(this.baseCstVisitorConstructor)){let e=ux(this.className,oe(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(tt(this.baseCstVisitorWithDefaultsConstructor)){let e=hx(this.className,oe(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){let e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){let e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){let e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}};var ra=class{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):ii}LA(e){let r=this.currIdx+e;return r<0||this.tokVectorLength<=r?ii:this.tokVector[r]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}};var na=class{ACTION(e){return e.call(this)}consume(e,r,n){return this.consumeInternal(r,e,n)}subrule(e,r,n){return this.subruleInternal(r,e,n)}option(e,r){return this.optionInternal(r,e)}or(e,r){return this.orInternal(r,e)}many(e,r){return this.manyInternal(e,r)}atLeastOne(e,r){return this.atLeastOneInternal(e,r)}CONSUME(e,r){return this.consumeInternal(e,0,r)}CONSUME1(e,r){return this.consumeInternal(e,1,r)}CONSUME2(e,r){return this.consumeInternal(e,2,r)}CONSUME3(e,r){return this.consumeInternal(e,3,r)}CONSUME4(e,r){return this.consumeInternal(e,4,r)}CONSUME5(e,r){return this.consumeInternal(e,5,r)}CONSUME6(e,r){return this.consumeInternal(e,6,r)}CONSUME7(e,r){return this.consumeInternal(e,7,r)}CONSUME8(e,r){return this.consumeInternal(e,8,r)}CONSUME9(e,r){return this.consumeInternal(e,9,r)}SUBRULE(e,r){return this.subruleInternal(e,0,r)}SUBRULE1(e,r){return this.subruleInternal(e,1,r)}SUBRULE2(e,r){return this.subruleInternal(e,2,r)}SUBRULE3(e,r){return this.subruleInternal(e,3,r)}SUBRULE4(e,r){return this.subruleInternal(e,4,r)}SUBRULE5(e,r){return this.subruleInternal(e,5,r)}SUBRULE6(e,r){return this.subruleInternal(e,6,r)}SUBRULE7(e,r){return this.subruleInternal(e,7,r)}SUBRULE8(e,r){return this.subruleInternal(e,8,r)}SUBRULE9(e,r){return this.subruleInternal(e,9,r)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,r,n=oi){if(ye(this.definedRulesNames,e)){let s={message:Ut.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:We.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(s)}this.definedRulesNames.push(e);let i=this.defineRule(e,r,n);return this[e]=i,i}OVERRIDE_RULE(e,r,n=oi){let i=Qg(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(i);let o=this.defineRule(e,r,n);return this[e]=o,o}BACKTRACK(e,r){return function(){this.isBackTrackingStack.push(1);let n=this.saveRecogState();try{return e.apply(this,r),!0}catch(i){if(Br(i))return!1;throw i}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return Is(ie(this.gastProductionsCache))}};var ia=class{initRecognizerEngine(e,r){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=ti,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},I(r,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(R(e)){if($(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(R(e))this.tokensMap=Be(e,(o,s)=>(o[s.name]=s,o),{});else if(I(e,"modes")&&Je(Ge(ie(e.modes)),Ig)){let o=Ge(ie(e.modes)),s=Vn(o);this.tokensMap=Be(s,(a,c)=>(a[c.name]=c,a),{})}else if(Oe(e))this.tokensMap=ae(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=te;let n=I(e,"modes")?Ge(ie(e.modes)):ie(e),i=Je(n,o=>$(o.categoryMatches));this.tokenMatcher=i?ti:pr,mr(ie(this.tokensMap))}defineRule(e,r,n){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);let i=I(n,"resyncEnabled")?n.resyncEnabled:oi.resyncEnabled,o=I(n,"recoveryValueFunc")?n.recoveryValueFunc:oi.recoveryValueFunc,s=this.ruleShortNameIdx<<12;this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=e,this.fullRuleNameToShort[e]=s;let a;return this.outputCst===!0?a=function(...h){try{this.ruleInvocationStateUpdate(s,e,this.subruleIdx),r.apply(this,h);let u=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(u),u}catch(u){return this.invokeRuleCatch(u,i,o)}finally{this.ruleFinallyStateUpdate()}}:a=function(...h){try{return this.ruleInvocationStateUpdate(s,e,this.subruleIdx),r.apply(this,h)}catch(u){return this.invokeRuleCatch(u,i,o)}finally{this.ruleFinallyStateUpdate()}},Object.assign(a,{ruleName:e,originalGrammarAction:r})}invokeRuleCatch(e,r,n){let i=this.RULE_STACK.length===1,o=r&&!this.isBackTracking()&&this.recoveryEnabled;if(Br(e)){let s=e;if(o){let a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(s.resyncedTokens=this.reSyncTo(a),this.outputCst){let c=this.CST_STACK[this.CST_STACK.length-1];return c.recoveredNode=!0,c}else return n(e);else{if(this.outputCst){let c=this.CST_STACK[this.CST_STACK.length-1];c.recoveredNode=!0,s.partialCstResult=c}throw s}}else{if(i)return this.moveToTerminatedState(),n(e);throw s}}else throw e}optionInternal(e,r){let n=this.getKeyForAutomaticLookahead(512,r);return this.optionInternalLogic(e,r,n)}optionInternalLogic(e,r,n){let i=this.getLaFuncFromCache(n),o;if(typeof e!="function"){o=e.DEF;let s=e.GATE;if(s!==void 0){let a=i;i=()=>s.call(this)&&a.call(this)}}else o=e;if(i.call(this)===!0)return o.call(this)}atLeastOneInternal(e,r){let n=this.getKeyForAutomaticLookahead(1024,e);return this.atLeastOneInternalLogic(e,r,n)}atLeastOneInternalLogic(e,r,n){let i=this.getLaFuncFromCache(n),o;if(typeof r!="function"){o=r.DEF;let s=r.GATE;if(s!==void 0){let a=i;i=()=>s.call(this)&&a.call(this)}}else o=r;if(i.call(this)===!0){let s=this.doSingleRepetition(o);for(;i.call(this)===!0&&s===!0;)s=this.doSingleRepetition(o)}else throw this.raiseEarlyExitException(e,Le.REPETITION_MANDATORY,r.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,r],i,1024,e,$s)}atLeastOneSepFirstInternal(e,r){let n=this.getKeyForAutomaticLookahead(1536,e);this.atLeastOneSepFirstInternalLogic(e,r,n)}atLeastOneSepFirstInternalLogic(e,r,n){let i=r.DEF,o=r.SEP;if(this.getLaFuncFromCache(n).call(this)===!0){i.call(this);let a=()=>this.tokenMatcher(this.LA(1),o);for(;this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,a,i,$i],a,1536,e,$i)}else throw this.raiseEarlyExitException(e,Le.REPETITION_MANDATORY_WITH_SEPARATOR,r.ERR_MSG)}manyInternal(e,r){let n=this.getKeyForAutomaticLookahead(768,e);return this.manyInternalLogic(e,r,n)}manyInternalLogic(e,r,n){let i=this.getLaFuncFromCache(n),o;if(typeof r!="function"){o=r.DEF;let a=r.GATE;if(a!==void 0){let c=i;i=()=>a.call(this)&&c.call(this)}}else o=r;let s=!0;for(;i.call(this)===!0&&s===!0;)s=this.doSingleRepetition(o);this.attemptInRepetitionRecovery(this.manyInternal,[e,r],i,768,e,Bs,s)}manySepFirstInternal(e,r){let n=this.getKeyForAutomaticLookahead(1280,e);this.manySepFirstInternalLogic(e,r,n)}manySepFirstInternalLogic(e,r,n){let i=r.DEF,o=r.SEP;if(this.getLaFuncFromCache(n).call(this)===!0){i.call(this);let a=()=>this.tokenMatcher(this.LA(1),o);for(;this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,a,i,Bi],a,1280,e,Bi)}}repetitionSepSecondInternal(e,r,n,i,o){for(;n();)this.CONSUME(r),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,r,n,i,o],n,1536,e,o)}doSingleRepetition(e){let r=this.getLexerPosition();return e.call(this),this.getLexerPosition()>r}orInternal(e,r){let n=this.getKeyForAutomaticLookahead(256,r),i=R(e)?e:e.DEF,s=this.getLaFuncFromCache(n).call(this,i);if(s!==void 0)return i[s].ALT.call(this);this.raiseNoAltException(r,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){let e=this.LA(1),r=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Hi(r,e))}}subruleInternal(e,r,n){let i;try{let o=n!==void 0?n.ARGS:void 0;return this.subruleIdx=r,i=e.apply(this,o),this.cstPostNonTerminal(i,n!==void 0&&n.LABEL!==void 0?n.LABEL:e.ruleName),i}catch(o){throw this.subruleInternalError(o,n,e.ruleName)}}subruleInternalError(e,r,n){throw Br(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,r!==void 0&&r.LABEL!==void 0?r.LABEL:n),delete e.partialCstResult),e}consumeInternal(e,r,n){let i;try{let o=this.LA(1);this.tokenMatcher(o,e)===!0?(this.consumeToken(),i=o):this.consumeInternalError(e,o,n)}catch(o){i=this.consumeInternalRecovery(e,r,o)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:e.name,i),i}consumeInternalError(e,r,n){let i,o=this.LA(0);throw n!==void 0&&n.ERR_MSG?i=n.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:r,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new cn(i,r,o))}consumeInternalRecovery(e,r,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){let i=this.getFollowsForInRuleRecovery(e,r);try{return this.tryInRuleRecovery(e,i)}catch(o){throw o.name===Oc?n:o}}else throw n}saveRecogState(){let e=this.errors,r=ae(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:r,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,r,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(r)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){let e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),te)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}};var oa=class{initErrorHandler(e){this._errors=[],this.errorMessageProvider=I(e,"errorMessageProvider")?e.errorMessageProvider:ct.errorMessageProvider}SAVE_ERROR(e){if(Br(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:ae(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return ae(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,r,n){let i=this.getCurrRuleFullName(),o=this.getGAstProductions()[i],a=Gi(e,o,r,this.maxLookahead)[0],c=[];for(let h=1;h<=this.maxLookahead;h++)c.push(this.LA(h));let l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:c,previous:this.LA(0),customUserDescription:n,ruleName:i});throw this.SAVE_ERROR(new zi(l,this.LA(1),this.LA(0)))}raiseNoAltException(e,r){let n=this.getCurrRuleFullName(),i=this.getGAstProductions()[n],o=Ki(e,i,this.maxLookahead),s=[];for(let l=1;l<=this.maxLookahead;l++)s.push(this.LA(l));let a=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:s,previous:a,customUserDescription:r,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new Wi(c,this.LA(1),a))}};var sa=class{initContentAssist(){}computeContentAssist(e,r){let n=this.gastProductionsCache[e];if(tt(n))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return Gs([n],r,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){let r=Ve(e.ruleStack),i=this.getGAstProductions()[r];return new Fs(i,e).startWalking()}};var ca={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(ca);var fx=!0,dx=Math.pow(2,8)-1,mx=S({name:"RECORDING_PHASE_TOKEN",pattern:K.NA});mr([mx]);var gx=ln(mx,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(gx);var Q0={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}},aa=class{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){let r=e>0?e:"";this[`CONSUME${r}`]=function(n,i){return this.consumeInternalRecord(n,e,i)},this[`SUBRULE${r}`]=function(n,i){return this.subruleInternalRecord(n,e,i)},this[`OPTION${r}`]=function(n){return this.optionInternalRecord(n,e)},this[`OR${r}`]=function(n){return this.orInternalRecord(n,e)},this[`MANY${r}`]=function(n){this.manyInternalRecord(e,n)},this[`MANY_SEP${r}`]=function(n){this.manySepFirstInternalRecord(e,n)},this[`AT_LEAST_ONE${r}`]=function(n){this.atLeastOneInternalRecord(e,n)},this[`AT_LEAST_ONE_SEP${r}`]=function(n){this.atLeastOneSepFirstInternalRecord(e,n)}}this.consume=function(e,r,n){return this.consumeInternalRecord(r,e,n)},this.subrule=function(e,r,n){return this.subruleInternalRecord(r,e,n)},this.option=function(e,r){return this.optionInternalRecord(r,e)},this.or=function(e,r){return this.orInternalRecord(r,e)},this.many=function(e,r){this.manyInternalRecord(e,r)},this.atLeastOne=function(e,r){this.atLeastOneInternalRecord(e,r)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{let e=this;for(let r=0;r<10;r++){let n=r>0?r:"";delete e[`CONSUME${n}`],delete e[`SUBRULE${n}`],delete e[`OPTION${n}`],delete e[`OR${n}`],delete e[`MANY${n}`],delete e[`MANY_SEP${n}`],delete e[`AT_LEAST_ONE${n}`],delete e[`AT_LEAST_ONE_SEP${n}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,r){return()=>!0}LA_RECORD(e){return ii}topLevelRuleRecord(e,r){try{let n=new at({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),r.call(this),this.recordingProdStack.pop(),n}catch(n){if(n.KNOWN_RECORDER_ERROR!==!0)try{n.message=n.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw n}throw n}}optionInternalRecord(e,r){return Xi.call(this,de,e,r)}atLeastOneInternalRecord(e,r){Xi.call(this,ke,r,e)}atLeastOneSepFirstInternalRecord(e,r){Xi.call(this,_e,r,e,fx)}manyInternalRecord(e,r){Xi.call(this,ee,r,e)}manySepFirstInternalRecord(e,r){Xi.call(this,Ne,r,e,fx)}orInternalRecord(e,r){return Z0.call(this,e,r)}subruleInternalRecord(e,r,n){if(la(r),!e||I(e,"ruleName")===!1){let a=new Error(`<SUBRULE${px(r)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}let i=Yt(this.recordingProdStack),o=e.ruleName,s=new le({idx:r,nonTerminalName:o,label:n?.LABEL,referencedRule:void 0});return i.definition.push(s),this.outputCst?Q0:ca}consumeInternalRecord(e,r,n){if(la(r),!cc(e)){let s=new Error(`<CONSUME${px(r)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw s.KNOWN_RECORDER_ERROR=!0,s}let i=Yt(this.recordingProdStack),o=new H({idx:r,terminalType:e,label:n?.LABEL});return i.definition.push(o),gx}};function Xi(t,e,r,n=!1){la(r);let i=Yt(this.recordingProdStack),o=ot(e)?e:e.DEF,s=new t({definition:[],idx:r});return n&&(s.separator=e.SEP),I(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(s),o.call(this),i.definition.push(s),this.recordingProdStack.pop(),ca}function Z0(t,e){la(e);let r=Yt(this.recordingProdStack),n=R(t)===!1,i=n===!1?t:t.DEF,o=new Ce({definition:[],idx:e,ignoreAmbiguities:n&&t.IGNORE_AMBIGUITIES===!0});I(t,"MAX_LOOKAHEAD")&&(o.maxLookahead=t.MAX_LOOKAHEAD);let s=Ri(i,a=>ot(a.GATE));return o.hasPredicates=s,r.definition.push(o),C(i,a=>{let c=new ce({definition:[]});o.definition.push(c),I(a,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=a.IGNORE_AMBIGUITIES:I(a,"GATE")&&(c.ignoreAmbiguities=!0),this.recordingProdStack.push(c),a.ALT.call(this),this.recordingProdStack.pop()}),ca}function px(t){return t===0?"":`${t}`}function la(t){if(t<0||t>dx){let e=new Error(`Invalid DSL Method idx value: <${t}>
	Idx value must be a none negative value smaller than ${dx+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}var ua=class{initPerformanceTracer(e){if(I(e,"traceInitPerf")){let r=e.traceInitPerf,n=typeof r=="number";this.traceInitMaxIdent=n?r:1/0,this.traceInitPerf=n?r>0:r}else this.traceInitMaxIdent=0,this.traceInitPerf=ct.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,r){if(this.traceInitPerf===!0){this.traceInitIndent++;let n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${n}--> <${e}>`);let{time:i,value:o}=ki(r),s=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(`${n}<-- <${e}> time: ${i}ms`),this.traceInitIndent--,o}else return r()}};function xx(t,e){e.forEach(r=>{let n=r.prototype;Object.getOwnPropertyNames(n).forEach(i=>{if(i==="constructor")return;let o=Object.getOwnPropertyDescriptor(n,i);o&&(o.get||o.set)?Object.defineProperty(t.prototype,i,o):t.prototype[i]=r.prototype[i]})})}var ii=ln(te,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(ii);var ct=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Ds,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),oi=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0}),We;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",t[t.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(We||(We={}));var Qi=class t{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;let r=this.className;this.TRACE_INIT("toFastProps",()=>{_i(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),C(this.definedRulesNames,i=>{let s=this[i].originalGrammarAction,a;this.TRACE_INIT(`${i} Rule`,()=>{a=this.topLevelRuleRecord(i,s)}),this.gastProductionsCache[i]=a})}finally{this.disableRecording()}});let n=[];if(this.TRACE_INIT("Grammar Resolving",()=>{n=tx({rules:ie(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(n)}),this.TRACE_INIT("Grammar Validations",()=>{if($(n)&&this.skipValidations===!1){let i=rx({rules:ie(this.gastProductionsCache),tokenTypes:ie(this.tokensMap),errMsgProvider:Ut,grammarName:r}),o=Vg({lookaheadStrategy:this.lookaheadStrategy,rules:ie(this.gastProductionsCache),tokenTypes:ie(this.tokensMap),grammarName:r});this.definitionErrors=this.definitionErrors.concat(i,o)}}),$(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{let i=cg(ie(this.gastProductionsCache));this.resyncFollows=i}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var i,o;(o=(i=this.lookaheadStrategy).initialize)===null||o===void 0||o.call(i,{rules:ie(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(ie(this.gastProductionsCache))})),!t.DEFER_DEFINITION_ERRORS_HANDLING&&!$(this.definitionErrors))throw e=N(this.definitionErrors,i=>i.message),new Error(`Parser Definition Errors detected:
 ${e.join(`
-------------------------------
`)}`)})}constructor(e,r){this.definitionErrors=[],this.selfAnalysisDone=!1;let n=this;if(n.initErrorHandler(r),n.initLexerAdapter(),n.initLooksAhead(r),n.initRecognizerEngine(e,r),n.initRecoverable(r),n.initTreeBuilder(r),n.initContentAssist(),n.initGastRecorder(r),n.initPerformanceTracer(r),I(r,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=I(r,"skipValidations")?r.skipValidations:ct.skipValidations}};Qi.DEFER_DEFINITION_ERRORS_HANDLING=!1;xx(Qi,[Vs,Qs,ta,ra,ia,na,oa,sa,aa,ua]);var xt=class extends Qi{constructor(e,r=ct){let n=ae(r);n.outputCst=!0,super(e,n)}};var ue=S({name:"Identifier",pattern:/[a-zA-Z_][a-zA-Z0-9_]*(?:-[a-zA-Z0-9_]+)*/}),Pt=S({name:"NumberLiteral",pattern:/[0-9]+/}),wc=S({name:"FlowchartKeyword",pattern:/flowchart/,longer_alt:ue}),kc=S({name:"GraphKeyword",pattern:/graph/,longer_alt:ue}),ha=S({name:"Direction",pattern:/TD|TB|BT|RL|LR/,longer_alt:ue}),_c=S({name:"SubgraphKeyword",pattern:/subgraph/,longer_alt:ue}),Mc=S({name:"EndKeyword",pattern:/end/,longer_alt:ue}),Uc=S({name:"ClassKeyword",pattern:/class/,longer_alt:ue}),Pc=S({name:"StyleKeyword",pattern:/style/,longer_alt:ue}),qc=S({name:"ClassDefKeyword",pattern:/classDef/,longer_alt:ue}),fa=S({name:"Ampersand",pattern:/&/}),si=S({name:"Comma",pattern:/,/}),da=S({name:"Semicolon",pattern:/;/}),Zi=S({name:"Colon",pattern:/:/}),pa=S({name:"TripleColon",pattern:/:::/}),Dc=S({name:"BiDirectionalArrow",pattern:/<-->/}),Fc=S({name:"CircleEndLine",pattern:/o--o|o---o|o----o/}),Bc=S({name:"CrossEndLine",pattern:/x--x|x---x|x----x/}),ma=S({name:"DottedArrowRight",pattern:/-\.->|-\.\.->|-\.\.\.->/}),$c=S({name:"DottedArrowLeft",pattern:/<-\.-|<-\.\.-|<-\.\.\.-/}),ga=S({name:"ThickArrowRight",pattern:/==>|===>|====>/}),Kc=S({name:"ThickArrowLeft",pattern:/<==|<===|<====/}),xa=S({name:"ArrowRight",pattern:/-->|--->|---->/}),Gc=S({name:"ArrowLeft",pattern:/<--|<---|<----/}),Ji=S({name:"DottedLine",pattern:/-\.-|-\.\.-|-\.\.\.-/}),eo=S({name:"ThickLine",pattern:/===|====|=====/}),Ea=S({name:"Line",pattern:/---|----/}),ya=S({name:"TwoDashes",pattern:/--/}),to=S({name:"InvalidArrow",pattern:/->(?!>)/}),jc=S({name:"DoubleSquareOpen",pattern:/\[\[/}),Wc=S({name:"DoubleSquareClose",pattern:/\]\]/}),Hc=S({name:"DoubleRoundOpen",pattern:/\(\(/}),zc=S({name:"DoubleRoundClose",pattern:/\)\)/}),Vc=S({name:"HexagonOpen",pattern:/\{\{/}),Yc=S({name:"HexagonClose",pattern:/\}\}/}),Xc=S({name:"StadiumOpen",pattern:/\(\[/}),Qc=S({name:"StadiumClose",pattern:/\]\)/}),Zc=S({name:"CylinderOpen",pattern:/\[\(/}),Jc=S({name:"CylinderClose",pattern:/\)\]/}),ro=S({name:"SquareOpen",pattern:/\[/}),no=S({name:"SquareClose",pattern:/\]/}),Ta=S({name:"RoundOpen",pattern:/\(/}),Sa=S({name:"RoundClose",pattern:/\)/}),eu=S({name:"DiamondOpen",pattern:/\{/}),tu=S({name:"DiamondClose",pattern:/\}/}),Oa=S({name:"AngleOpen",pattern:/>/}),ru=S({name:"AngleLess",pattern:/</}),io=S({name:"Pipe",pattern:/\|/}),nu=S({name:"ForwardSlash",pattern:/\//}),iu=S({name:"Backslash",pattern:/\\/}),Aa=S({name:"QuotedString",pattern:/"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'/}),ou=S({name:"MultilineText",pattern:/"""[\s\S]*?"""/,line_breaks:!0}),e1=S({name:"Comment",pattern:/%%[^\n\r]*/,group:K.SKIPPED}),La=S({name:"ColorValue",pattern:/#[0-9a-fA-F]{3,6}/}),$r=S({name:"Text",pattern:/[^[\](){}|<>\n\r\t &,;:]+/}),t1=S({name:"WhiteSpace",pattern:/[ \t]+/,group:K.SKIPPED}),Nt=S({name:"Newline",pattern:/[\n\r]+/,line_breaks:!0}),su=[e1,ou,Aa,wc,kc,_c,Mc,qc,Uc,Pc,ha,jc,Wc,Hc,zc,Vc,Yc,Xc,Qc,Zc,Jc,Dc,Fc,Bc,ma,$c,ga,Kc,xa,Gc,Ji,eo,Ea,ya,to,ro,no,Ta,Sa,eu,tu,Oa,ru,nu,iu,io,pa,fa,si,da,Zi,La,Pt,ue,$r,t1,Nt],r1=new K(su);function ba(t){return r1.tokenize(t)}var au=class extends xt{constructor(){super(su),this.diagram=this.RULE("diagram",()=>{this.OR([{ALT:()=>this.CONSUME(wc)},{ALT:()=>this.CONSUME(kc)}]),this.CONSUME(ha),this.OPTION(()=>{this.CONSUME(Nt)}),this.MANY(()=>{this.SUBRULE(this.statement)})}),this.statement=this.RULE("statement",()=>{this.OR([{ALT:()=>this.SUBRULE(this.nodeStatement)},{ALT:()=>this.SUBRULE(this.subgraph)},{ALT:()=>this.SUBRULE(this.classStatement)},{ALT:()=>this.SUBRULE(this.styleStatement)},{ALT:()=>this.SUBRULE(this.classDefStatement)},{ALT:()=>this.CONSUME(Nt)}])}),this.nodeStatement=this.RULE("nodeStatement",()=>{this.SUBRULE(this.nodeOrParallelGroup),this.OPTION(()=>{this.SUBRULE(this.link),this.SUBRULE2(this.nodeOrParallelGroup),this.MANY(()=>{this.SUBRULE2(this.link),this.SUBRULE3(this.nodeOrParallelGroup)})}),this.OPTION2(()=>this.CONSUME(da)),this.OR2([{ALT:()=>this.CONSUME(Nt)},{ALT:()=>this.CONSUME(te)}])}),this.nodeOrParallelGroup=this.RULE("nodeOrParallelGroup",()=>{this.SUBRULE(this.node),this.MANY(()=>{this.CONSUME(fa),this.SUBRULE2(this.node)})}),this.node=this.RULE("node",()=>{this.OR([{ALT:()=>{this.CONSUME(ue,{LABEL:"nodeId"}),this.OPTION(()=>{this.CONSUME(Pt,{LABEL:"nodeIdSuffix"})})}},{ALT:()=>{this.CONSUME2(Pt,{LABEL:"nodeIdNum"})}}]),this.OPTION2(()=>{this.SUBRULE(this.nodeShape)}),this.OPTION3(()=>{this.CONSUME(pa),this.CONSUME3(ue,{LABEL:"nodeClass"})})}),this.nodeShape=this.RULE("nodeShape",()=>{this.OR([{ALT:()=>{this.CONSUME(ro),this.OPTION(()=>this.SUBRULE(this.nodeContent)),this.CONSUME(no)}},{ALT:()=>{this.CONSUME(jc),this.OPTION2(()=>this.SUBRULE2(this.nodeContent)),this.CONSUME(Wc)}},{ALT:()=>{this.CONSUME(Ta),this.OPTION3(()=>this.SUBRULE3(this.nodeContent)),this.CONSUME(Sa)}},{ALT:()=>{this.CONSUME(Hc),this.OPTION4(()=>this.SUBRULE4(this.nodeContent)),this.CONSUME(zc)}},{ALT:()=>{this.CONSUME(eu),this.OPTION5(()=>this.SUBRULE5(this.nodeContent)),this.CONSUME(tu)}},{ALT:()=>{this.CONSUME(Vc),this.OPTION6(()=>this.SUBRULE6(this.nodeContent)),this.CONSUME(Yc)}},{ALT:()=>{this.CONSUME(Xc),this.OPTION7(()=>this.SUBRULE7(this.nodeContent)),this.CONSUME(Qc)}},{ALT:()=>{this.CONSUME(Zc),this.OPTION8(()=>this.SUBRULE8(this.nodeContent)),this.CONSUME(Jc)}}])}),this.nodeContent=this.RULE("nodeContent",()=>{this.OR([{ALT:()=>this.CONSUME(Aa)},{ALT:()=>this.CONSUME(ou)},{ALT:()=>{this.AT_LEAST_ONE(()=>{this.OR2([{ALT:()=>this.CONSUME(ue)},{ALT:()=>this.CONSUME($r)},{ALT:()=>this.CONSUME(Pt)},{ALT:()=>this.CONSUME(Ta)},{ALT:()=>this.CONSUME(Sa)},{ALT:()=>this.CONSUME(ru)},{ALT:()=>this.CONSUME(Oa)},{ALT:()=>this.CONSUME(nu)},{ALT:()=>this.CONSUME(iu)},{ALT:()=>this.CONSUME(si)},{ALT:()=>this.CONSUME(Zi)},{ALT:()=>this.CONSUME(fa)},{ALT:()=>this.CONSUME(da)},{ALT:()=>this.CONSUME(ya)},{ALT:()=>this.CONSUME(Ea)},{ALT:()=>this.CONSUME(eo)},{ALT:()=>this.CONSUME(Ji)}])})}}])}),this.link=this.RULE("link",()=>{this.OR([{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(Ji)},{ALT:()=>this.CONSUME(eo)},{ALT:()=>this.CONSUME(ya)}]),this.SUBRULE(this.linkTextInline),this.OR3([{ALT:()=>this.CONSUME(xa)},{ALT:()=>this.CONSUME(ma)},{ALT:()=>this.CONSUME(ga)}])}},{ALT:()=>{this.CONSUME($r,{LABEL:"inlineCarrier"}),this.CONSUME(Oa)}},{ALT:()=>this.CONSUME2(Dc)},{ALT:()=>this.CONSUME2(Fc)},{ALT:()=>this.CONSUME2(Bc)},{ALT:()=>this.CONSUME2(xa)},{ALT:()=>this.CONSUME2(Gc)},{ALT:()=>this.CONSUME2(ma)},{ALT:()=>this.CONSUME2($c)},{ALT:()=>this.CONSUME2(ga)},{ALT:()=>this.CONSUME2(Kc)},{ALT:()=>this.CONSUME2(Ea)},{ALT:()=>this.CONSUME2(Ji)},{ALT:()=>this.CONSUME2(eo)},{ALT:()=>this.CONSUME(to)}]),this.OPTION(()=>{this.CONSUME(io),this.SUBRULE(this.linkText),this.CONSUME2(io)})}),this.linkText=this.RULE("linkText",()=>{this.AT_LEAST_ONE(()=>{this.OR([{ALT:()=>this.CONSUME(ue)},{ALT:()=>this.CONSUME($r)},{ALT:()=>this.CONSUME(Pt)}])})}),this.linkTextInline=this.RULE("linkTextInline",()=>{this.AT_LEAST_ONE(()=>{this.OR([{ALT:()=>this.CONSUME(ue)},{ALT:()=>this.CONSUME($r)},{ALT:()=>this.CONSUME(Pt)},{ALT:()=>this.CONSUME(io)}])})}),this.subgraph=this.RULE("subgraph",()=>{this.CONSUME(_c),this.OR([{ALT:()=>{this.CONSUME(ue,{LABEL:"subgraphId"}),this.OPTION(()=>{this.CONSUME1(ro),this.SUBRULE(this.nodeContent),this.CONSUME1(no)})}},{ALT:()=>{this.CONSUME(Aa,{LABEL:"subgraphTitleQ"})}},{ALT:()=>{this.CONSUME2(ro),this.SUBRULE2(this.nodeContent),this.CONSUME2(no)}}]),this.CONSUME(Nt),this.MANY(()=>{this.SUBRULE(this.subgraphStatement)}),this.CONSUME(Mc),this.OPTION3(()=>{this.CONSUME2(Nt)})}),this.subgraphStatement=this.RULE("subgraphStatement",()=>{this.OR([{ALT:()=>this.SUBRULE(this.directionStatement)},{ALT:()=>this.SUBRULE(this.nodeStatement)},{ALT:()=>this.SUBRULE(this.subgraph)},{ALT:()=>this.SUBRULE(this.classStatement)},{ALT:()=>this.SUBRULE(this.styleStatement)},{ALT:()=>this.SUBRULE(this.classDefStatement)},{ALT:()=>this.CONSUME(Nt)}])}),this.directionStatement=this.RULE("directionStatement",()=>{this.CONSUME(ue,{LABEL:"dirKw"}),this.CONSUME(ha),this.OPTION(()=>this.CONSUME(Nt))}),this.classStatement=this.RULE("classStatement",()=>{this.CONSUME(Uc),this.CONSUME(ue),this.MANY(()=>{this.CONSUME(si),this.CONSUME2(ue)}),this.CONSUME3(ue,{LABEL:"className"}),this.OPTION(()=>{this.CONSUME(Nt)})}),this.styleStatement=this.RULE("styleStatement",()=>{this.CONSUME(Pc),this.CONSUME(ue),this.MANY(()=>{this.OR([{ALT:()=>this.CONSUME($r)},{ALT:()=>this.CONSUME2(ue)},{ALT:()=>this.CONSUME(La)},{ALT:()=>this.CONSUME(Zi)},{ALT:()=>this.CONSUME(si)},{ALT:()=>this.CONSUME(Pt)}])}),this.OPTION(()=>{this.CONSUME(Nt)})}),this.classDefStatement=this.RULE("classDefStatement",()=>{this.CONSUME(qc),this.CONSUME(ue),this.MANY(()=>{this.OR([{ALT:()=>this.CONSUME($r)},{ALT:()=>this.CONSUME2(ue)},{ALT:()=>this.CONSUME(La)},{ALT:()=>this.CONSUME(Zi)},{ALT:()=>this.CONSUME(si)},{ALT:()=>this.CONSUME(Pt)}])}),this.OPTION(()=>{this.CONSUME(Nt)})}),this.performSelfAnalysis()}_augmentNodeRule(){let e=this.node;this.node=this.RULE("node",()=>{this.OR([{ALT:()=>{this.CONSUME(ue,{LABEL:"nodeId"}),this.OPTION(()=>{this.CONSUME(Pt,{LABEL:"nodeIdSuffix"})})}},{ALT:()=>{this.CONSUME2(Pt,{LABEL:"nodeIdNum"})}}]),this.OPTION2(()=>{this.SUBRULE(this.nodeShape)}),this.OPTION3(()=>{this.CONSUME(pa),this.CONSUME3(ue,{LABEL:"nodeClass"})})})}},Ct=new au;function Ex(t){return Ct.input=t,{cst:Ct.diagram(),errors:Ct.errors}}var i1=Ct.getBaseCstVisitorConstructorWithDefaults(),lu=class extends i1{constructor(e){super(),this.validateVisitor(),this.ctx=e}diagram(e){e.statement&&e.statement.forEach(r=>this.visit(r))}statement(e){for(let r of Object.keys(e)){let n=e[r];Array.isArray(n)&&n.forEach(i=>{i&&typeof i.name=="string"&&this.visit(i)})}}subgraph(e){e.subgraphStatement&&e.subgraphStatement.forEach(r=>this.visit(r))}subgraphStatement(e){for(let r of Object.keys(e)){let n=e[r];Array.isArray(n)&&n.forEach(i=>{i&&typeof i.name=="string"&&this.visit(i)})}}directionStatement(e){let r=e.dirKw?.[0];r&&r.image!=="direction"&&this.ctx.errors.push({line:r.startLine??1,column:r.startColumn??1,severity:"error",code:"FL-DIR-KW-INVALID",message:`Unknown keyword '${r.image}' before direction. Use 'direction TB' / 'LR' / etc.`,hint:"Example inside subgraph: 'direction TB'",length:r.image?.length??0})}nodeStatement(e){e.nodeOrParallelGroup&&e.nodeOrParallelGroup.forEach(r=>this.visit(r))}nodeOrParallelGroup(e){e.node&&e.node.forEach(r=>this.visit(r))}node(e){e.nodeShape&&e.nodeShape.forEach(r=>this.visit(r))}checkEmptyContent(e,r){if(!r||r.length===0){this.ctx.errors.push({line:e.startLine??1,column:e.startColumn??1,severity:"error",message:"Empty label inside a shape.",code:"FL-NODE-EMPTY",hint:'Write non-empty text inside the brackets, e.g., A["Start"] or A[Start]. If you want no label, omit the brackets and just use A.'});return}for(let n of r){let i=n.children||{},o=[].concat(i.QuotedString||[]).concat(i.MultilineText||[]);for(let s of o){let a=s.image;if(!a)continue;(a.startsWith('"')||a.startsWith("'")?a.slice(1,-1):a).trim().length===0&&this.ctx.errors.push({line:s.startLine??1,column:s.startColumn??1,severity:"error",message:"Empty label inside a shape (only empty quotes/whitespace).",code:"FL-NODE-EMPTY",hint:'Provide non-empty text, e.g., A["Start"] or A[Start]. If you want no label, omit the brackets and just use A.'})}}}checkEscapedQuotes(e){if(e)for(let r of e){let n=r.children||{},i=[].concat(n.QuotedString||[]).concat(n.Text||[]).concat(n.Identifier||[]).concat(n.NumberLiteral||[]);for(let o of i)o.image&&o.image.includes('\\"')&&this.ctx.errors.push({line:o.startLine??1,column:o.startColumn??1,severity:"error",message:'Escaped quotes (\\") in node labels are not supported by Mermaid. Use &quot; instead.',code:"FL-LABEL-ESCAPED-QUOTE",hint:'Prefer "He said &quot;Hi&quot;".'})}}checkDoubleInSingleQuoted(e){if(e)for(let r of e){let i=(r.children||{}).QuotedString||[];for(let o of i){let s=o.image||"";if(s.startsWith("'")&&s.endsWith("'")&&s.includes('"')){let a=s.indexOf('"'),c=(o.startColumn??1)+Math.max(0,a);this.ctx.errors.push({line:o.startLine??1,column:c,severity:"error",message:'Double quotes inside a single-quoted label are not supported by Mermaid. Replace inner " with &quot; or use a double-quoted label with &quot;.',code:"FL-LABEL-DOUBLE-IN-SINGLE",hint:'Change to "She said &quot;Hello&quot;" or replace inner " with &quot;.',length:1})}}}}checkDoubleInDoubleQuoted(e){if(e)for(let r of e){let i=(r.children||{}).QuotedString||[];if(i.length>=2){let o=i[1];this.ctx.errors.push({line:o.startLine??1,column:o.startColumn??1,severity:"error",code:"FL-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted label are not supported. Use &quot; for inner quotes.",hint:'Example: A["He said &quot;Hi&quot;"]',length:1})}}}warnParensInUnquoted(e){if(e)for(let r of e){let n=r.children||{};if(Array.isArray(n.QuotedString)&&n.QuotedString.length>0)continue;let o=n.RoundOpen||[],s=n.RoundClose||[],a=[...o,...s];if(a.length>0){let c=a[0];this.ctx.errors.push({line:c.startLine??1,column:c.startColumn??1,severity:"warning",code:"FL-LABEL-PARENS-UNQUOTED",message:"Parentheses inside an unquoted label may be ambiguous. Wrap the label in quotes.",hint:'Example: A["Calls func(arg)"]'})}}}nodeShape(e){let r=e.SquareOpen&&e.SquareOpen[0]||e.DoubleSquareOpen&&e.DoubleSquareOpen[0]||e.RoundOpen&&e.RoundOpen[0]||e.DoubleRoundOpen&&e.DoubleRoundOpen[0]||e.DiamondOpen&&e.DiamondOpen[0]||e.HexagonOpen&&e.HexagonOpen[0]||e.StadiumOpen&&e.StadiumOpen[0]||e.CylinderOpen&&e.CylinderOpen[0],n=[];for(let i of Object.keys(e))if(i.startsWith("nodeContent")){let o=e[i];Array.isArray(o)&&n.push(...o)}if(r&&(this.checkEmptyContent(r,n.length?n:void 0),this.checkDoubleInSingleQuoted(n),this.warnParensInUnquoted(n),this.ctx.strict)){let i=!1,o;for(let s of n){let a=s.children||{};if(a.QuotedString&&a.QuotedString.length||a.MultilineText&&a.MultilineText.length){i=!0;break}let c=[].concat(a.Identifier||[]).concat(a.Text||[]).concat(a.NumberLiteral||[]).concat(a.RoundOpen||[]).concat(a.RoundClose||[]).concat(a.Comma||[]).concat(a.Colon||[]).concat(a.Pipe||[]);!o&&c.length&&(o=c[0])}if(n.length>0&&!i){let s=o??r;this.ctx.errors.push({line:s.startLine??1,column:s.startColumn??1,severity:"error",code:"FL-STRICT-LABEL-QUOTES-REQUIRED",message:"Strict mode: Node label must be quoted (use double quotes and &quot; inside).",hint:'Example: A["Label with &quot;quotes&quot; and (parens)"]'})}}}};function yx(t,e,r){let n={errors:[],strict:r?.strict};return new lu(n).visit(t),n.errors}function oo(t,e){let r=[],n=e.code,i=e.message||'Escaped quotes (\\") are not supported by Mermaid. Use &quot; instead.',o=e.hint||'Use &quot; for inner quotes, e.g., "He said &quot;Hi&quot;".',s=new Set;for(let a of t)if(typeof a.image=="string"){let c=a.image.indexOf('\\"');if(c!==-1){let l=a.startLine??1;if(s.has(l))continue;s.add(l);let h=(a.startColumn??1)+c,{line:u,column:f}=Zt(l,h,1,1);r.push({line:u,column:f,severity:"error",code:n,message:i,hint:o,length:2})}}return r}function ai(t,e){let r=[],n=new Map;for(let o of t){let s=o.startLine??1;n.has(s)||n.set(s,[]),n.get(s).push(o)}let i=new Set(e.scopeEndTokenNames||[]);for(let[o,s]of n)for(let a=0;a<s.length;a++)if(s[a].tokenType?.name==="QuotedString"){for(let l=a+1;l<s.length;l++){let h=s[l];if(i.size>0&&i.has(h.tokenType?.name||""))break;if(h.tokenType?.name==="QuotedString"){let{line:u,column:f}=Zt(h.startLine??null,h.startColumn??null,o,1);r.push({line:u,column:f,severity:"error",code:e.code,message:e.message,hint:e.hint,length:1}),l=s.length;break}if(h.tokenType?.name==="Text"&&typeof h.image=="string"&&h.image.includes('"')){let u=h.image.indexOf('"'),f=(h.startColumn??1)+(u>=0?u:0),{line:m,column:p}=Zt(h.startLine??null,f,o,1);r.push({line:m,column:p,severity:"error",code:e.code,message:e.message,hint:e.hint,length:1}),l=s.length;break}}if(r.length>0&&r[r.length-1].line===o)break}return r}function Kr(t,e){let r=[],n=t.split(/\r?\n/),i=e.message||"Unclosed quote in label or name.",o=e.hint||'Close the quote, e.g., "Text"',s=e.limitPerFile??1;for(let a=0;a<n.length;a++){let c=n[a]??"";if(!c)continue;let l=c.split("&quot;").join("").split('\\"').join(""),h=[],u=[];for(let p=0;p<l.length;p++){let g=l[p];g==='"'?h.push(p):g==="'"&&u.push(p)}let f=h.length%2===1,m=u.length%2===1;if(f||m){let p=f?h[0]??0:u[0]??0;if(r.push({line:a+1,column:p+1,severity:"error",code:e.code,message:i,hint:o,length:1}),r.length>=s)break}}return r}function Zt(t,e,r=1,n=1){let i=Number.isFinite(t)&&t>0?t:r,o=Number.isFinite(e)&&e>0?e:n;return{line:i,column:o}}function so(t){let e=t.split(/\r?\n/),r=e.length,n=e[e.length-1]??"",i=Math.max(1,n.length+1);return{line:r,column:i}}function Tx(t){let{line:e,column:r}=Zt(t.line,t.column);return{line:e,column:r,severity:"error",message:t.message}}function cu(t){let e=t?.image??"";return e===`
`?"\\n":e}function rt(t,e){let r=t?.context?.ruleStack;return Array.isArray(r)&&r.includes(e)}function $e(t,e){return(t.message||"").includes(`--> ${e} <--`)}function uu(t){let e=t?.context?.ruleStack;return Array.isArray(e)&&e.length===1&&e[0]==="diagram"}function Sx(t,e){let r=t.token,n=so(e),{line:i,column:o}=Zt(r?.startLine??null,r?.startColumn??null,n.line,n.column),s=cu(r),a=r?.tokenType?.name,c=typeof r?.image=="string"&&r.image.length>0?r.image.length:1,h=e.split(/\r?\n/)[Math.max(0,i-1)]??"",u=f=>{let m=Math.max(0,o-1),g=h.slice(0,m).lastIndexOf(f);if(g===-1)return null;let E=h.slice(g+1),x=E.indexOf('\\"');if(x!==-1)return{kind:"escaped",column:g+1+x+1};let T=[];for(let y=0;y<E.length;y++)E[y]==='"'&&T.push(y);if(T.length>=3){let y=T[2];return{kind:"double-in-double",column:g+1+y+1}}return null};if(uu(t)&&$e(t,"Direction"))return a==="EOF"||a==="Newline"?{line:i,column:o,severity:"error",code:"FL-DIR-MISSING",message:"Missing direction after diagram header. Use TD, TB, BT, RL, or LR.",hint:"Example: 'flowchart TD' for top-down layout.",length:1}:{line:i,column:o,severity:"error",code:"FL-DIR-INVALID",message:`Invalid direction '${s}'. Use one of: TD, TB, BT, RL, LR.`,hint:"Try 'TD' (top-down) or 'LR' (left-to-right).",length:c};if(rt(t,"nodeStatement")&&t.name==="NoViableAltException"&&(t.message||"").includes("[Newline")&&(t.message||"").includes("[EOF"))return{line:i,column:o,severity:"error",code:"FL-LINK-MISSING",message:`Two nodes on one line must be connected with an arrow before '${s}'.`,hint:"Insert --> between nodes, e.g., A --> B.",length:c};if(rt(t,"nodeShape")&&t.name==="MismatchedTokenException"&&a==="SquareClose"&&$e(t,"RoundClose"))return{line:i,column:o,severity:"error",code:"FL-NODE-MIXED-BRACKETS",message:"Mismatched brackets: opened '(' but closed with ']'.",hint:"Close with ')' or change the opening bracket to '['.",length:c};if(rt(t,"nodeShape")&&t.name==="MismatchedTokenException"){if($e(t,"SquareClose")){let f=u("[");return f?.kind==="escaped"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-ESCAPED-QUOTE",message:'Escaped quotes (\\") in node labels are not supported by Mermaid. Use &quot; instead.',hint:'Prefer "He said &quot;Hi&quot;".',length:2}:f?.kind==="double-in-double"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted label are not supported. Use &quot; for inner quotes.",hint:'Example: A["He said &quot;Hi&quot;"]',length:1}:{line:i,column:o,severity:"error",code:"FL-NODE-UNCLOSED-BRACKET",message:"Unclosed '['. Add a matching ']' before the arrow or newline.",hint:"Example: A[Label] --> B",length:1}}if($e(t,"RoundClose")){let f=u("(");return f?.kind==="escaped"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-ESCAPED-QUOTE",message:'Escaped quotes (\\") in node labels are not supported by Mermaid. Use &quot; instead.',hint:'Prefer "He said &quot;Hi&quot;".',length:2}:f?.kind==="double-in-double"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted label are not supported. Use &quot; for inner quotes.",hint:'Example: A["He said &quot;Hi&quot;"]',length:1}:{line:i,column:o,severity:"error",code:"FL-NODE-UNCLOSED-BRACKET",message:"Unclosed '('. Add a matching ')'.",hint:"Example: B(Label)",length:1}}if($e(t,"DiamondClose")){let f=u("{");return f?.kind==="escaped"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-ESCAPED-QUOTE",message:'Escaped quotes (\\") in node labels are not supported by Mermaid. Use &quot; instead.',hint:'Example: D{"Is &quot;Driver&quot; AND &quot;AuthCheck.Path&quot; configured?"}',length:2}:f?.kind==="double-in-double"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted label are not supported by Mermaid. Use &quot; for inner quotes.",hint:'Example: D{"Is &quot;Driver&quot; and &quot;AuthCheck.Path&quot; configured?"}',length:1}:{line:i,column:o,severity:"error",code:"FL-NODE-UNCLOSED-BRACKET",message:"Unclosed '{'. Add a matching '}'.",hint:"Example: C{Decision}",length:1}}if($e(t,"DoubleRoundClose")){let f=u("(");return f?.kind==="escaped"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-ESCAPED-QUOTE",message:'Escaped quotes (\\") in node labels are not supported by Mermaid. Use &quot; instead.',hint:'Prefer "He said &quot;Hi&quot;".',length:2}:f?.kind==="double-in-double"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted label are not supported. Use &quot; for inner quotes.",hint:'Example: A["He said &quot;Hi&quot;"]',length:1}:{line:i,column:o,severity:"error",code:"FL-NODE-UNCLOSED-BRACKET",message:"Unclosed '(( '. Add a matching '))'.",hint:"Example: A((Circle))",length:2}}if($e(t,"DoubleSquareClose")){let f=u("[");return f?.kind==="escaped"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-ESCAPED-QUOTE",message:'Escaped quotes (\\") in node labels are not supported by Mermaid. Use &quot; instead.',hint:'Prefer "He said &quot;Hi&quot;".',length:2}:f?.kind==="double-in-double"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted label are not supported. Use &quot; for inner quotes.",hint:'Example: A["He said &quot;Hi&quot;"]',length:1}:{line:i,column:o,severity:"error",code:"FL-NODE-UNCLOSED-BRACKET",message:"Unclosed '[[ '. Add a matching ']]'.",hint:"Example: [[Subroutine]]",length:2}}if($e(t,"StadiumClose")){let f=u("(")||u("[");return f?.kind==="escaped"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-ESCAPED-QUOTE",message:'Escaped quotes (\\") in node labels are not supported by Mermaid. Use &quot; instead.',hint:'Prefer "He said &quot;Hi&quot;".',length:2}:f?.kind==="double-in-double"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted label are not supported. Use &quot; for inner quotes.",hint:'Example: A["He said &quot;Hi&quot;"]',length:1}:{line:i,column:o,severity:"error",code:"FL-NODE-UNCLOSED-BRACKET",message:"Unclosed '([ '. Add a matching '])'.",hint:"Example: A([Stadium])",length:c}}if($e(t,"CylinderClose")){let f=u("(")||u("[");return f?.kind==="escaped"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-ESCAPED-QUOTE",message:'Escaped quotes (\\") in node labels are not supported by Mermaid. Use &quot; instead.',hint:'Prefer "He said &quot;Hi&quot;".',length:2}:f?.kind==="double-in-double"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted label are not supported. Use &quot; for inner quotes.",hint:'Example: A["He said &quot;Hi&quot;"]',length:1}:{line:i,column:o,severity:"error",code:"FL-NODE-UNCLOSED-BRACKET",message:"Unclosed '[( '. Add a matching ')]'.",hint:"Example: A[(Cylinder)]",length:c}}if($e(t,"HexagonClose")){let f=u("{");return f?.kind==="escaped"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-ESCAPED-QUOTE",message:'Escaped quotes (\\") in node labels are not supported by Mermaid. Use &quot; instead.',hint:'Prefer "He said &quot;Hi&quot;".',length:2}:f?.kind==="double-in-double"?{line:i,column:f.column,severity:"error",code:"FL-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted label are not supported. Use &quot; for inner quotes.",hint:'Example: A["He said &quot;Hi&quot;"]',length:1}:{line:i,column:o,severity:"error",code:"FL-NODE-UNCLOSED-BRACKET",message:"Unclosed '{{ '. Add a matching '}}'.",hint:"Example: A{{Hexagon}}",length:c}}}return rt(t,"nodeContent")&&t.name==="MismatchedTokenException"&&a==="QuotedString"?{line:i,column:o,severity:"error",code:"FL-LABEL-QUOTE-IN-UNQUOTED",message:"Double quotes inside an unquoted label are not allowed. Wrap the entire label in quotes or use &quot;.",hint:'Example: A["Calls logger.debug(&quot;message&quot;, data)"]',length:c}:rt(t,"classStatement")?{line:i,column:o,severity:"error",code:"FL-CLASS-MALFORMED",message:"Invalid class statement. Provide node id(s) then a class name.",hint:"Example: class A,B important",length:c}:rt(t,"subgraph")&&t.name==="NoViableAltException"?{line:i,column:o,severity:"error",code:"FL-SUBGRAPH-MISSING-HEADER",message:"Subgraph header is missing. Add an ID or a [Title] after the keyword.",hint:"Example: subgraph API [API Layer]",length:c}:t.name==="NotAllInputParsedException"&&a==="EndKeyword"?{line:i,column:o,severity:"error",code:"FL-END-WITHOUT-SUBGRAPH",message:"'end' without a matching 'subgraph'.",hint:"Remove this end or add a subgraph above.",length:c}:{line:i,column:o,severity:"error",message:t.message||"Parser error",length:c}}function Ox(t,e){let r=t.token,n=so(e),{line:i,column:o}=Zt(r?.startLine??null,r?.startColumn??null,n.line,n.column),s=cu(r),a=typeof r?.image=="string"&&r.image.length>0?r.image.length:1,l=e.split(/\r?\n/)[Math.max(0,i-1)]||"";if(t.name==="NotAllInputParsedException"&&r?.tokenType?.name==="Colon")return{line:i,column:o,severity:"error",code:"PI-LABEL-REQUIRES-QUOTES",message:"Slice labels must be quoted (single or double quotes).",hint:'Example: "Dogs" : 10',length:a};if(t.name==="NotAllInputParsedException"){let h=l.indexOf(":");if(h>0){let u=l.slice(0,h);if(!(u.trimStart().startsWith('"')||u.trimStart().startsWith("'")))return{line:i,column:Math.max(1,h),severity:"error",code:"PI-LABEL-REQUIRES-QUOTES",message:"Slice labels must be quoted (single or double quotes).",hint:'Example: "Dogs" : 10',length:1}}}if(t.name==="NotAllInputParsedException"&&typeof r?.image=="string"){let h=r.image;if(h.startsWith('"')&&!h.slice(1).includes('"')||h.startsWith("'")&&!h.slice(1).includes("'"))return{line:i,column:o,severity:"error",code:"PI-QUOTE-UNCLOSED",message:"Unclosed quote in slice label.",hint:'Close the quote: "Dogs" : 10',length:a}}if($e(t,"Colon")){let h=(l.match(/\"/g)||[]).length;if((l.match(/"/g)||[]).length-h>=3){let f=[];for(let p=0;p<l.length;p++)l[p]==='"'&&f.push(p);let m=(f[2]??o-1)+1;return{line:i,column:m,severity:"error",code:"PI-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted slice label are not supported. Use &quot; for inner quotes.",hint:'Example: "He said &quot;Hi&quot;" : 1',length:1}}return{line:i,column:o,severity:"error",code:"PI-MISSING-COLON",message:"Missing colon between slice label and value.",hint:'Use: "Label" : 10',length:a}}return $e(t,"NumberLiteral")?{line:i,column:o,severity:"error",code:"PI-MISSING-NUMBER",message:"Missing numeric value after colon.",hint:"Use a number like 10 or 42.5",length:a}:$e(t,"QuotedString")?{line:i,column:o,severity:"error",code:"PI-LABEL-REQUIRES-QUOTES",message:"Slice labels must be quoted (single or double quotes).",hint:'Example: "Dogs" : 10',length:a}:{line:i,column:o,severity:"error",message:t.message||"Parser error",length:a}}function Ax(t,e){let r=t.token,n=so(e),{line:i,column:o}=Zt(r?.startLine??null,r?.startColumn??null,n.line,n.column),s=cu(r),a=r?.tokenType?.name,c=typeof r?.image=="string"&&r.image.length>0?r.image.length:1,h=e.split(/\r?\n/)[Math.max(0,i-1)]||"",u=L=>rt(t,L),f=u("actorRef")||u("participantDecl"),m=L=>$e(t,L),p=t?.context?.ruleStack?.[0]==="diagram"&&t?.context?.ruleStack?.length===1,g=[{tok:"ElseKeyword",key:"else",allowedRule:"altBlock",allowedLabel:"alt",example:`alt Condition
  \u2026
else
  \u2026
end`},{tok:"AndKeyword",key:"and",allowedRule:"parBlock",allowedLabel:"par",example:`par
  \u2026
and
  \u2026
end`},{tok:"OptionKeyword",key:"option",allowedRule:"criticalBlock",allowedLabel:"critical",example:`critical
  \u2026
option Label
  \u2026
end`}],x=(t?.context?.ruleStack||[]).slice().reverse().find(L=>/Block$/.test(L)),T=g.find(L=>L.tok===a);if(T){if(!x)return T.key==="else"?{line:i,column:o,severity:"error",code:"SE-ELSE-OUTSIDE-ALT",message:"'else' is only allowed inside 'alt' blocks.",hint:"Use: alt Condition \u2026 else \u2026 end",length:c}:T.key==="and"?{line:i,column:o,severity:"error",code:"SE-AND-OUTSIDE-PAR",message:"'and' is only allowed inside 'par' blocks.",hint:"Example: par \u2026 and \u2026 end (parallel branches).",length:c}:{line:i,column:o,severity:"error",code:"SE-BRANCH-OUTSIDE-BLOCK",message:`'${T.key}' is only allowed inside a '${T.allowedLabel}' block.`,hint:`Start a ${T.allowedLabel} section:
${T.example}`,length:c};if(x!==T.allowedRule){if(T.key==="else"&&x==="criticalBlock")return{line:i,column:o,severity:"error",code:"SE-ELSE-IN-CRITICAL",message:"'else' is not allowed inside a 'critical' block. Use 'option' or close the block with 'end'.",hint:`Replace with: option <label>
Example:
option Retry`,length:c};let L=(x||"").replace(/Block$/,"")||"block";return{line:i,column:o,severity:"error",code:"SE-BRANCH-IN-WRONG-BLOCK",message:`'${T.key}' is only valid in '${T.allowedLabel}' blocks (not inside '${L}').`,hint:`Use the proper branch for '${L}' or close it with 'end'.
For '${T.allowedLabel}', use:
${T.example}`,length:c}}}if(p&&m("SequenceKeyword"))return{line:i,column:o,severity:"error",code:"SE-HEADER-MISSING",message:"Missing 'sequenceDiagram' header.",hint:"Start with: sequenceDiagram",length:c};if(u("messageStmt")&&t.name==="MismatchedTokenException"&&m("Colon"))return{line:i,column:o,severity:"error",code:"SE-MSG-COLON-MISSING",message:"Missing colon after target actor in message.",hint:"Use: A->>B: Message text",length:c};if(f&&(t.name==="NoViableAltException"||t.name==="MismatchedTokenException"||t.name==="EarlyExitException")){let b=Kr(e,{code:"SE-QUOTE-UNCLOSED",message:"Unclosed quote in participant/actor name.",hint:'Close the quote: participant "Bob"  or  participant Alice as "Alias"',limitPerFile:Number.MAX_SAFE_INTEGER}).find(k=>k.line===i);if(b)return{...b,severity:"warning"};let v=(h.match(/\"/g)||[]).length,P=(h.match(/"/g)||[]).length-v,M=(h.match(/'/g)||[]).length;if(P>=3){let k=[];for(let w=0;w<h.length;w++)h[w]==='"'&&k.push(w);let U=(k[2]??o-1)+1;return{line:i,column:U,severity:"warning",code:"SE-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted name/label are not supported. Use &quot; for inner quotes.",hint:'Example: participant "Logger &quot;debug&quot;" as L',length:1}}}if(u("arrow")&&t.name==="NoViableAltException")return{line:i,column:o,severity:"error",code:"SE-ARROW-INVALID",message:`Invalid sequence arrow near '${s}'.`,hint:"Use ->, -->, ->>, -->>, -x, --x, -), --), <<->>, or <<-->>",length:c};if(u("noteStmt")){if(t.name==="MismatchedTokenException"&&m("Colon"))return{line:i,column:o,severity:"error",code:"SE-NOTE-MALFORMED",message:"Malformed note: missing colon before the note text.",hint:"Example: Note right of Alice: Hello",length:c};if(t.name==="NoViableAltException")return{line:i,column:o,severity:"error",code:"SE-NOTE-MALFORMED",message:"Malformed note statement. Use left|right of X or over X[,Y]: text",hint:"Examples: Note over A,B: hi",length:c}}if(a==="ElseKeyword"&&rt(t,"criticalBlock"))return{line:i,column:o,severity:"error",code:"SE-ELSE-IN-CRITICAL",message:"'else' is not allowed inside a 'critical' block. Use 'option' or close the block with 'end'.",hint:`Replace with: option <label>
Example:
option Retry`,length:c};let y=[{rule:"altBlock",label:"alt"},{rule:"optBlock",label:"opt"},{rule:"loopBlock",label:"loop"},{rule:"parBlock",label:"par"},{rule:"rectBlock",label:"rect"},{rule:"criticalBlock",label:"critical"},{rule:"breakBlock",label:"break"},{rule:"boxBlock",label:"box"}];if(t.name==="MismatchedTokenException"&&m("EndKeyword")){let L=y.find(b=>rt(t,b.rule));if(L){let b=e.split(/\r?\n/),v=/^(\s*)(alt\b|opt\b|loop\b|par\b|rect\b|critical\b|break\b|box\b)/,P=-1,M="";for(let U=Math.max(0,i-1);U>=0;U--){let w=v.exec(b[U]||"");if(w){P=U,M=w[1]||"";break}}let k=i;if(P!==-1){k=b.length;for(let U=P+1;U<b.length;U++){let w=b[U]||"";if(w.trim()==="")continue;if((w.match(/^(\s*)/)?.[1]||"").length<=M.length){k=U+1;break}}k>b.length&&(k=b.length+1)}return{line:k,column:1,severity:"error",code:"SE-BLOCK-MISSING-END",message:`Missing 'end' to close a '${L.label}' block.`,hint:"Add 'end' on its own line aligned with the block's start.",length:1}}}if((t.name==="NoViableAltException"||t.name==="NotAllInputParsedException")&&a==="ElseKeyword")return{line:i,column:o,severity:"error",code:"SE-ELSE-OUTSIDE-ALT",message:"'else' is only allowed inside 'alt' blocks.",hint:"Use: alt Condition \u2026 else \u2026 end",length:c};if((t.name==="NoViableAltException"||t.name==="NotAllInputParsedException")&&a==="AndKeyword")return{line:i,column:o,severity:"error",code:"SE-AND-OUTSIDE-PAR",message:"'and' is only allowed inside 'par' blocks.",hint:"Example: par \u2026 and \u2026 end (parallel branches).",length:c};if((t.name==="NoViableAltException"||t.name==="NotAllInputParsedException")&&a==="EndKeyword")return{line:i,column:o,severity:"error",code:"SE-END-WITHOUT-BLOCK",message:"'end' without an open block (alt/opt/loop/par/rect/critical/break/box).",hint:"Add a block above (e.g., par \u2026 end | alt \u2026 end) or remove this end.",length:c};if(u("autonumberStmt")){if(a==="Identifier")return{line:i,column:o,severity:"error",code:"SE-AUTONUMBER-NON-NUMERIC",message:`Autonumber values must be numbers. Found '${s}'.`,hint:"Use numbers: autonumber 10 or autonumber 10 10 (start and step).",length:c};if(a==="ParticipantKeyword"||a==="ActorKeyword")return{line:i,column:o,severity:"error",code:"SE-AUTONUMBER-EXTRANEOUS",message:"Unexpected token after 'autonumber'. Put 'autonumber' on its own line.",hint:`Example:
autonumber 10 10
participant A`,length:c};if(t.name==="NoViableAltException"||t.name==="MismatchedTokenException"||t.name==="NotAllInputParsedException")return{line:i,column:o,severity:"error",code:"SE-AUTONUMBER-MALFORMED",message:"Malformed autonumber statement.",hint:"Use: autonumber | autonumber off | autonumber 10 10",length:c}}if(u("createStmt")&&(a==="Newline"||a==="EOF"))return{line:i,column:o,severity:"error",code:"SE-CREATE-MISSING-NAME",message:"Missing name after 'create'.",hint:"Use: create participant A  or  create actor B",length:c};if(u("createStmt")&&(t.name==="MismatchedTokenException"||t.name==="NoViableAltException"))return{line:i,column:o,severity:"error",code:"SE-CREATE-MALFORMED",message:"After 'create', specify 'participant' or 'actor' before the name.",hint:`Examples:
create participant B
create actor D as Donald`,length:c};if(u("destroyStmt")&&t.name==="MismatchedTokenException")return{line:i,column:o,severity:"error",code:"SE-DESTROY-MALFORMED",message:"After 'destroy', specify 'participant' or 'actor' and a name.",hint:`Examples:
destroy participant A
destroy actor B`,length:c};if(u("destroyStmt")&&(a==="Newline"||a==="EOF"))return{line:i,column:o,severity:"error",code:"SE-DESTROY-MISSING-NAME",message:"Missing name after 'destroy'.",hint:"Use: destroy participant A  or  destroy actor B",length:c};let O=(h.match(/\"/g)||[]).length;if((h.match(/"/g)||[]).length-O>=3){let L=[];for(let v=0;v<h.length;v++)h[v]==='"'&&L.push(v);let b=(L[2]??o-1)+1;return{line:i,column:b,severity:"error",code:"SE-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted name/label are not supported. Use &quot; for inner quotes.",hint:'Example: participant "Logger &quot;debug&quot;" as L',length:1}}return{line:i,column:o,severity:"error",message:t.message||"Parser error",length:c}}function Lx(t,e){let r=t.token,n=so(e),{line:i,column:o}=Zt(r?.startLine??null,r?.startColumn??null,n.line,n.column),s=r?.tokenType?.name,a=typeof r?.image=="string"&&r.image.length>0?r.image.length:1,l=e.split(/\r?\n/)[Math.max(0,i-1)]||"";return uu(t)&&!$e(t,"ClassDiagramKeyword")?{line:i,column:o,severity:"error",code:"CL-HEADER-MISSING",message:"Missing 'classDiagram' header.",hint:"Start with: classDiagram",length:a}:rt(t,"relationOp")?/^\s*class\b/.test(l)?{line:i,column:o,severity:"error",message:t.message||"Parser error",length:a}:{line:i,column:o,severity:"error",code:"CL-REL-INVALID",message:"Invalid relationship operator. Use <|--, *--, o--, --, ..> or ..|>.",hint:"Example: Foo <|-- Bar",length:a}:(rt(t,"classBlock")||rt(t,"classLine"))&&t.name==="MismatchedTokenException"&&$e(t,"RCurly")?{line:i,column:o,severity:"error",code:"CL-BLOCK-MISSING-RBRACE",message:"Missing '}' to close class block.",hint:"Close the block: class Foo { ... }",length:a}:rt(t,"memberLine")&&(t.name==="MismatchedTokenException"||t.name==="NoViableAltException")?{line:i,column:o,severity:"error",code:"CL-MEMBER-MALFORMED",message:"Malformed class member. Use visibility + name [()][: type].",hint:"Examples: +foo() : void  |  -bar: int",length:a}:rt(t,"relationStmt")&&t.name==="MismatchedTokenException"?{line:i,column:o,severity:"error",code:"CL-REL-MALFORMED",message:"Malformed relationship. Use: A <op> B [: label]",hint:"Example: Foo <|-- Bar : extends",length:a}:{line:i,column:o,severity:"error",message:t.message||"Parser error",length:a}}function bx(t,e){let r=t.token,n=so(e),{line:i,column:o}=Zt(r?.startLine??null,r?.startColumn??null,n.line,n.column),s=r?.tokenType?.name,a=typeof r?.image=="string"&&r.image.length>0?r.image.length:1,l=e.split(/\r?\n/)[Math.max(0,i-1)]||"";if(uu(t)&&!($e(t,"StateDiagram")||$e(t,"StateDiagramV2")))return{line:i,column:o,severity:"error",code:"ST-HEADER-MISSING",message:"Missing 'stateDiagram' header.",hint:"Start with: stateDiagram-v2",length:a};if(rt(t,"noteStmt")&&t.name==="MismatchedTokenException"&&$e(t,"Colon"))return{line:i,column:o,severity:"error",code:"ST-NOTE-MALFORMED",message:"Malformed note: missing colon before note text.",hint:"Example: Note right of A: message",length:a};if(rt(t,"stateBlock")&&t.name==="MismatchedTokenException"&&$e(t,"RCurly"))return/---/.test(l)?{line:i,column:o,severity:"error",code:"ST-CONCURRENCY-UNSUPPORTED",message:"Concurrency separator '---' is not supported in Mermaid state diagrams.",hint:"Use separate states or regions without '---'.",length:a}:{line:i,column:o,severity:"error",code:"ST-BLOCK-MISSING-RBRACE",message:"Missing '}' to close a state block.",hint:"Close the block: state Foo { ... }",length:a};let h=(l.match(/\\\"/g)||[]).length;if((l.match(/\"/g)||[]).length-h>=3){let f=[];for(let p=0;p<l.length;p++)l[p]==='"'&&f.push(p);let m=(f[2]??o-1)+1;return{line:i,column:m,severity:"warning",code:"ST-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted name/label may be invalid. Use &quot; for inner quotes.",hint:'Example: state "Logger &quot;core&quot;" as L',length:1}}return{line:i,column:o,severity:"error",message:t.message||"Parser error",length:a}}function Jt(t,e){let r=[],n=e.tokenize(t);if(n.errors.length>0&&r.push(...n.errors.map(Tx)),e.postLex)try{r.push(...e.postLex(t,n.tokens)||[])}catch{}let i=null;if(n.errors.length===0){let o=e.parse(n.tokens);i=o.cst,o.errors.length>0&&r.push(...o.errors.map(s=>e.mapParserError(s,t)))}if(i)try{r.push(...e.analyze(i,n.tokens)||[])}catch(o){r.push({line:1,column:1,severity:"error",message:`Internal semantic analysis error: ${o.message}`})}if(e.postParse)try{r.push(...e.postParse(t,n.tokens,i,r)||[])}catch{}return r}function vx(t,e={}){return Jt(t,{tokenize:ba,parse:Ex,analyze:(r,n)=>yx(r,n,{strict:!!e.strict}),mapParserError:(r,n)=>Sx(r,n),postLex:(r,n)=>{let i=[];for(let o of n)o.tokenType===to&&i.push({line:o.startLine??1,column:o.startColumn??1,message:"Invalid arrow syntax: -> (use --> instead)",severity:"error",code:"FL-ARROW-INVALID",hint:"Replace -> with -->, or use -- text --> for inline labels.",length:o.image?.length??2});return i},postParse:(r,n,i,o)=>{let s=oo(n,{code:"FL-LABEL-ESCAPED-QUOTE",message:'Escaped quotes (\\") in node labels are accepted by Mermaid, but using &quot; is preferred for portability.',hint:'Prefer &quot; inside quoted labels, e.g., A["He said &quot;Hi&quot;"]'}).map(p=>({...p,severity:"warning"})),a=new Set(o.filter(p=>p.code==="FL-LABEL-DOUBLE-IN-DOUBLE").map(p=>p.line)),c=new Set(oo(n,{code:"x"}).map(p=>p.line)),l=ai(n,{code:"FL-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted label are not supported. Use &quot; for inner quotes.",hint:'Example: A["He said &quot;Hi&quot;"]',scopeEndTokenNames:["SquareClose","RoundClose","DiamondClose","DoubleSquareClose","DoubleRoundClose","StadiumClose","CylinderClose","HexagonClose"]}).filter(p=>!a.has(p.line)&&!c.has(p.line)),h=s.concat(l),u=(r.match(/\\\"/g)||[]).length,f=(r.match(/\"/g)||[]).length-u,m=(r.match(/'/g)||[]).length;return(f%2===1||m%2===1)&&h.push(...Kr(r,{code:"FL-QUOTE-UNCLOSED",message:"Unclosed quote in node label.",hint:'Close the quote: A["Label"]',limitPerFile:1})),h}})}var hu=S({name:"PieKeyword",pattern:/pie/}),fu=S({name:"TitleKeyword",pattern:/title/}),du=S({name:"ShowDataKeyword",pattern:/showData/}),pu=S({name:"Colon",pattern:/:/}),va=S({name:"NumberLiteral",pattern:/-?[0-9]+(\.[0-9]+)?/}),Na=S({name:"QuotedString",pattern:/"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'/}),mu=S({name:"Text",pattern:/[^:\n\r]+/}),o1=S({name:"Comment",pattern:/%%[^\n\r]*/,group:K.SKIPPED}),s1=S({name:"WhiteSpace",pattern:/[ \t]+/,group:K.SKIPPED}),li=S({name:"Newline",pattern:/[\n\r]+/,line_breaks:!0}),gu=[o1,Na,hu,fu,du,s1,pu,va,mu,li],a1=new K(gu);function Ca(t){return a1.tokenize(t)}var xu=class extends xt{constructor(){super(gu),this.diagram=this.RULE("diagram",()=>{this.CONSUME(hu),this.OPTION(()=>this.CONSUME(du)),this.OPTION2(()=>this.CONSUME(li)),this.MANY(()=>this.SUBRULE(this.statement))}),this.statement=this.RULE("statement",()=>{this.OR([{ALT:()=>this.SUBRULE(this.titleStmt)},{ALT:()=>this.SUBRULE(this.sliceStmt)},{ALT:()=>this.CONSUME(li)}])}),this.titleStmt=this.RULE("titleStmt",()=>{this.CONSUME(fu),this.AT_LEAST_ONE(()=>this.OR([{ALT:()=>this.CONSUME(Na)},{ALT:()=>this.CONSUME(mu)},{ALT:()=>this.CONSUME(va)}])),this.OPTION2(()=>this.CONSUME(li))}),this.sliceStmt=this.RULE("sliceStmt",()=>{this.SUBRULE(this.sliceLabel),this.CONSUME(pu),this.CONSUME(va),this.OPTION3(()=>this.CONSUME(li))}),this.sliceLabel=this.RULE("sliceLabel",()=>{this.CONSUME(Na)}),this.performSelfAnalysis()}},er=new xu;function Nx(t){return er.input=t,{cst:er.diagram(),errors:er.errors}}var c1=er.getBaseCstVisitorConstructorWithDefaults(),Eu=class extends c1{constructor(e){super(),this.validateVisitor(),this.ctx=e}diagram(e){e.statement&&e.statement.forEach(r=>this.visit(r))}statement(e){for(let r of Object.keys(e)){let n=e[r];Array.isArray(n)&&n.forEach(i=>{i&&typeof i.name=="string"&&this.visit(i)})}}};function Cx(t,e){let r={errors:[]};return new Eu(r).visit(t),r.errors}function Ix(t,e={}){return Jt(t,{tokenize:Ca,parse:Nx,analyze:(r,n)=>Cx(r,n),mapParserError:(r,n)=>Ox(r,n),postLex:(r,n)=>{let i=[];i.push(...Kr(r,{code:"PI-QUOTE-UNCLOSED",message:"Unclosed quote in slice label.",hint:'Close the quote: "Dogs" : 10',limitPerFile:1}));let o=n,s=new Set;for(let c of o)typeof c.image=="string"&&c.image.includes('\\"')&&s.add(c.startLine??1);let a=ai(o,{code:"PI-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted slice label are not supported. Use &quot; for inner quotes.",hint:'Example: "He said &quot;Hi&quot;" : 1',scopeEndTokenNames:["Colon"]}).filter(c=>!s.has(c.line));return i.push(...a),i}})}var Y=S({name:"Identifier",pattern:/[A-Za-z_][A-Za-z0-9_]*/}),ci=S({name:"NumberLiteral",pattern:/[0-9]+/}),yu=S({name:"SequenceKeyword",pattern:/sequenceDiagram/,longer_alt:Y}),ui=S({name:"ParticipantKeyword",pattern:/participant/i,longer_alt:Y}),hi=S({name:"ActorKeyword",pattern:/actor/i,longer_alt:Y}),Ia=S({name:"AsKeyword",pattern:/as/i,longer_alt:Y}),Ra=S({name:"AutonumberKeyword",pattern:/autonumber/i,longer_alt:Y}),wa=S({name:"OffKeyword",pattern:/off/i,longer_alt:Y}),ka=S({name:"NoteKeyword",pattern:/note/i,longer_alt:Y}),_a=S({name:"LeftKeyword",pattern:/left/i,longer_alt:Y}),Ma=S({name:"RightKeyword",pattern:/right/i,longer_alt:Y}),Ua=S({name:"OverKeyword",pattern:/over/i,longer_alt:Y}),Pa=S({name:"OfKeyword",pattern:/of/i,longer_alt:Y}),qa=S({name:"ActivateKeyword",pattern:/activate/i,longer_alt:Y}),Da=S({name:"DeactivateKeyword",pattern:/deactivate/i,longer_alt:Y}),Fa=S({name:"CreateKeyword",pattern:/create/i,longer_alt:Y}),Ba=S({name:"DestroyKeyword",pattern:/destroy/i,longer_alt:Y}),ao=S({name:"AltKeyword",pattern:/alt/i,longer_alt:Y}),un=S({name:"ElseKeyword",pattern:/else/i,longer_alt:Y}),$a=S({name:"OptionKeyword",pattern:/option/i,longer_alt:Y}),Ka=S({name:"OptKeyword",pattern:/opt/i,longer_alt:Y}),Ga=S({name:"LoopKeyword",pattern:/loop/i,longer_alt:Y}),fi=S({name:"ParKeyword",pattern:/par/i,longer_alt:Y}),hn=S({name:"AndKeyword",pattern:/and/i,longer_alt:Y}),ja=S({name:"RectKeyword",pattern:/rect/i,longer_alt:Y}),Wa=S({name:"CriticalKeyword",pattern:/critical/i,longer_alt:Y}),Ha=S({name:"BoxKeyword",pattern:/box/i,longer_alt:Y}),qt=S({name:"EndKeyword",pattern:/end/i,longer_alt:Y}),za=S({name:"LinksKeyword",pattern:/links/i,longer_alt:Y}),Va=S({name:"LinkKeyword",pattern:/link/i,longer_alt:Y}),Ya=S({name:"BreakKeyword",pattern:/break/i,longer_alt:Y}),Tu=S({name:"BidirAsyncDotted",pattern:/<<-->>/}),Su=S({name:"BidirAsync",pattern:/<<->>/}),Ou=S({name:"DottedAsync",pattern:/-->>/}),Au=S({name:"Async",pattern:/->>/}),Lu=S({name:"Dotted",pattern:/-->/}),bu=S({name:"Solid",pattern:/->/}),vu=S({name:"DottedCross",pattern:/--x/}),Nu=S({name:"Cross",pattern:/-x/}),Cu=S({name:"DottedOpen",pattern:/--\)/}),Iu=S({name:"Open",pattern:/-\)/}),Xa=S({name:"Plus",pattern:/\+/}),Qa=S({name:"Minus",pattern:/-/}),Za=S({name:"Comma",pattern:/,/}),di=S({name:"Colon",pattern:/:/}),Ru=S({name:"LParen",pattern:/\(/}),wu=S({name:"RParen",pattern:/\)/}),Ja=S({name:"QuotedString",pattern:/"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'/}),u1=S({name:"Comment",pattern:/%%[^\n\r]*/,group:K.SKIPPED}),h1=S({name:"WhiteSpace",pattern:/[ \t]+/,group:K.SKIPPED}),Q=S({name:"Newline",pattern:/[\n\r]+/,line_breaks:!0}),el=S({name:"Text",pattern:/[^\n\r]+/}),ku=[u1,Ja,h1,Q,yu,ui,hi,Ia,Ra,wa,ka,_a,Ma,Ua,Pa,qa,Da,Fa,Ba,ao,un,$a,Ka,Ga,fi,hn,ja,Wa,Ya,Ha,qt,za,Va,Tu,Su,Ou,Au,Lu,bu,vu,Nu,Cu,Iu,Za,di,Ru,wu,Xa,Qa,ci,Y,el],f1=new K(ku);function Rx(t){return f1.tokenize(t)}var _u=class extends xt{constructor(){super(ku),this.diagram=this.RULE("diagram",()=>{this.CONSUME(yu),this.MANY(()=>this.CONSUME(Q)),this.MANY2(()=>{this.SUBRULE(this.line)}),this.OPTION(()=>this.CONSUME(te))}),this.line=this.RULE("line",()=>{this.OR([{ALT:()=>this.SUBRULE(this.participantDecl)},{ALT:()=>this.SUBRULE(this.autonumberStmt)},{ALT:()=>this.SUBRULE(this.noteStmt)},{ALT:()=>this.SUBRULE(this.activateStmt)},{ALT:()=>this.SUBRULE(this.deactivateStmt)},{ALT:()=>this.SUBRULE(this.createStmt)},{ALT:()=>this.SUBRULE(this.destroyStmt)},{ALT:()=>this.SUBRULE(this.linkStmt)},{ALT:()=>this.SUBRULE(this.altBlock)},{ALT:()=>this.SUBRULE(this.optBlock)},{ALT:()=>this.SUBRULE(this.loopBlock)},{ALT:()=>this.SUBRULE(this.parBlock)},{ALT:()=>this.SUBRULE(this.criticalBlock)},{ALT:()=>this.SUBRULE(this.breakBlock)},{ALT:()=>this.SUBRULE(this.rectBlock)},{ALT:()=>this.SUBRULE(this.boxBlock)},{ALT:()=>this.SUBRULE(this.messageStmt)},{ALT:()=>this.SUBRULE(this.blankLine)}])}),this.blankLine=this.RULE("blankLine",()=>{this.AT_LEAST_ONE(()=>this.CONSUME(Q))}),this.actorRef=this.RULE("actorRef",()=>{this.AT_LEAST_ONE(()=>this.OR([{ALT:()=>this.CONSUME(Y)},{ALT:()=>this.CONSUME(Ja)},{ALT:()=>this.CONSUME(ci)},{ALT:()=>this.CONSUME(el)}]))}),this.participantDecl=this.RULE("participantDecl",()=>{this.OR([{ALT:()=>this.CONSUME(ui)},{ALT:()=>this.CONSUME(hi)}]),this.SUBRULE(this.actorRef),this.OPTION(()=>{this.CONSUME(Ia),this.SUBRULE2(this.actorRef)}),this.OR2([{ALT:()=>this.AT_LEAST_ONE(()=>this.CONSUME(Q))},{ALT:()=>this.CONSUME(te)}])}),this.autonumberStmt=this.RULE("autonumberStmt",()=>{this.CONSUME(Ra),this.OPTION(()=>{this.OR([{ALT:()=>this.CONSUME(wa)},{ALT:()=>{this.CONSUME(ci),this.OPTION2(()=>this.CONSUME2(ci))}}])}),this.OR2([{ALT:()=>this.AT_LEAST_ONE(()=>this.CONSUME(Q))},{ALT:()=>this.CONSUME(te)}])}),this.noteStmt=this.RULE("noteStmt",()=>{this.CONSUME(ka),this.OR([{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(_a)},{ALT:()=>this.CONSUME(Ma)}]),this.CONSUME(Pa),this.SUBRULE(this.actorRef)}},{ALT:()=>{this.CONSUME(Ua),this.SUBRULE2(this.actorRef),this.OPTION(()=>{this.CONSUME(Za),this.SUBRULE3(this.actorRef)})}}]),this.CONSUME(di),this.OPTION2(()=>this.SUBRULE(this.lineRemainder)),this.OR3([{ALT:()=>this.AT_LEAST_ONE(()=>this.CONSUME(Q))},{ALT:()=>this.CONSUME(te)}])}),this.activateStmt=this.RULE("activateStmt",()=>{this.CONSUME(qa),this.SUBRULE(this.actorRef),this.OR2([{ALT:()=>this.AT_LEAST_ONE(()=>this.CONSUME(Q))},{ALT:()=>this.CONSUME(te)}])}),this.deactivateStmt=this.RULE("deactivateStmt",()=>{this.CONSUME(Da),this.SUBRULE(this.actorRef),this.OR2([{ALT:()=>this.AT_LEAST_ONE(()=>this.CONSUME(Q))},{ALT:()=>this.CONSUME(te)}])}),this.createStmt=this.RULE("createStmt",()=>{this.CONSUME(Fa),this.OR([{ALT:()=>this.CONSUME(ui)},{ALT:()=>this.CONSUME(hi)}]),this.SUBRULE(this.actorRef),this.OPTION(()=>{this.CONSUME(Ia),this.OPTION2(()=>this.SUBRULE(this.lineRemainder))}),this.OR2([{ALT:()=>this.AT_LEAST_ONE(()=>this.CONSUME(Q))},{ALT:()=>this.CONSUME(te)}])}),this.destroyStmt=this.RULE("destroyStmt",()=>{this.CONSUME(Ba),this.OPTION(()=>{this.OR([{ALT:()=>this.CONSUME(ui)},{ALT:()=>this.CONSUME(hi)}])}),this.SUBRULE(this.actorRef),this.OR2([{ALT:()=>this.AT_LEAST_ONE(()=>this.CONSUME(Q))},{ALT:()=>this.CONSUME(te)}])}),this.linkStmt=this.RULE("linkStmt",()=>{this.OR([{ALT:()=>this.CONSUME(Va)},{ALT:()=>this.CONSUME(za)}]),this.SUBRULE(this.actorRef),this.CONSUME(di),this.OPTION(()=>this.SUBRULE(this.lineRemainder)),this.OR2([{ALT:()=>this.AT_LEAST_ONE(()=>this.CONSUME(Q))},{ALT:()=>this.CONSUME(te)}])}),this.messageStmt=this.RULE("messageStmt",()=>{this.SUBRULE(this.actorRef),this.SUBRULE(this.arrow),this.OPTION(()=>this.OR([{ALT:()=>this.CONSUME(Xa)},{ALT:()=>this.CONSUME(Qa)}])),this.SUBRULE2(this.actorRef),this.CONSUME(di),this.OPTION2(()=>this.SUBRULE(this.lineRemainder)),this.OR2([{ALT:()=>this.AT_LEAST_ONE(()=>this.CONSUME(Q))},{ALT:()=>this.CONSUME(te)}])}),this.arrow=this.RULE("arrow",()=>{this.OR([{ALT:()=>this.CONSUME(Tu)},{ALT:()=>this.CONSUME(Su)},{ALT:()=>this.CONSUME(Ou)},{ALT:()=>this.CONSUME(Au)},{ALT:()=>this.CONSUME(Lu)},{ALT:()=>this.CONSUME(bu)},{ALT:()=>this.CONSUME(vu)},{ALT:()=>this.CONSUME(Nu)},{ALT:()=>this.CONSUME(Cu)},{ALT:()=>this.CONSUME(Iu)}])}),this.altBlock=this.RULE("altBlock",()=>{this.CONSUME(ao),this.OPTION(()=>this.SUBRULE(this.lineRemainder)),this.AT_LEAST_ONE(()=>this.CONSUME(Q)),this.MANY(()=>this.SUBRULE(this.line)),this.MANY2(()=>{this.CONSUME(un),this.OPTION2(()=>this.SUBRULE2(this.lineRemainder)),this.AT_LEAST_ONE2(()=>this.CONSUME2(Q)),this.MANY3(()=>this.SUBRULE2(this.line))}),this.CONSUME(qt),this.OR3([{ALT:()=>this.AT_LEAST_ONE3(()=>this.CONSUME3(Q))},{ALT:()=>this.CONSUME3(te)}])}),this.optBlock=this.RULE("optBlock",()=>{this.CONSUME(Ka),this.OPTION(()=>this.SUBRULE(this.lineRemainder)),this.AT_LEAST_ONE(()=>this.CONSUME(Q)),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(qt),this.OR2([{ALT:()=>this.AT_LEAST_ONE2(()=>this.CONSUME2(Q))},{ALT:()=>this.CONSUME2(te)}])}),this.loopBlock=this.RULE("loopBlock",()=>{this.CONSUME(Ga),this.OPTION(()=>this.SUBRULE(this.lineRemainder)),this.AT_LEAST_ONE(()=>this.CONSUME(Q)),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(qt),this.OR2([{ALT:()=>this.AT_LEAST_ONE2(()=>this.CONSUME2(Q))},{ALT:()=>this.CONSUME2(te)}])}),this.parBlock=this.RULE("parBlock",()=>{this.CONSUME(fi),this.OPTION(()=>this.SUBRULE(this.lineRemainder)),this.AT_LEAST_ONE(()=>this.CONSUME(Q)),this.MANY(()=>this.SUBRULE(this.line)),this.MANY2(()=>{this.CONSUME(hn),this.OPTION2(()=>this.SUBRULE2(this.lineRemainder)),this.AT_LEAST_ONE2(()=>this.CONSUME2(Q)),this.MANY3(()=>this.SUBRULE2(this.line))}),this.CONSUME(qt),this.OR3([{ALT:()=>this.AT_LEAST_ONE3(()=>this.CONSUME3(Q))},{ALT:()=>this.CONSUME3(te)}])}),this.criticalBlock=this.RULE("criticalBlock",()=>{this.CONSUME(Wa),this.OPTION(()=>this.SUBRULE(this.lineRemainder)),this.AT_LEAST_ONE(()=>this.CONSUME(Q)),this.MANY(()=>this.SUBRULE(this.line)),this.MANY2(()=>{this.CONSUME($a),this.OPTION2(()=>this.SUBRULE2(this.lineRemainder)),this.AT_LEAST_ONE2(()=>this.CONSUME2(Q)),this.MANY3(()=>this.SUBRULE2(this.line))}),this.CONSUME(qt),this.AT_LEAST_ONE3(()=>this.CONSUME3(Q))}),this.breakBlock=this.RULE("breakBlock",()=>{this.CONSUME(Ya),this.OPTION(()=>this.SUBRULE(this.lineRemainder)),this.AT_LEAST_ONE(()=>this.CONSUME(Q)),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(qt),this.OR2([{ALT:()=>this.AT_LEAST_ONE2(()=>this.CONSUME2(Q))},{ALT:()=>this.CONSUME2(te)}])}),this.rectBlock=this.RULE("rectBlock",()=>{this.CONSUME(ja),this.OPTION(()=>this.SUBRULE(this.lineRemainder)),this.AT_LEAST_ONE(()=>this.CONSUME(Q)),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(qt),this.OR2([{ALT:()=>this.AT_LEAST_ONE2(()=>this.CONSUME2(Q))},{ALT:()=>this.CONSUME2(te)}])}),this.boxBlock=this.RULE("boxBlock",()=>{this.CONSUME(Ha),this.OPTION(()=>this.SUBRULE(this.lineRemainder)),this.AT_LEAST_ONE(()=>this.CONSUME(Q)),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(qt),this.AT_LEAST_ONE2(()=>this.CONSUME2(Q))}),this.lineRemainder=this.RULE("lineRemainder",()=>{this.AT_LEAST_ONE(()=>this.OR([{ALT:()=>this.CONSUME(Y)},{ALT:()=>this.CONSUME(ci)},{ALT:()=>this.CONSUME(Ja)},{ALT:()=>this.CONSUME(el)},{ALT:()=>this.CONSUME(Xa)},{ALT:()=>this.CONSUME(Qa)},{ALT:()=>this.CONSUME(Za)},{ALT:()=>this.CONSUME(di)},{ALT:()=>this.CONSUME(Ru)},{ALT:()=>this.CONSUME(wu)},{ALT:()=>this.CONSUME(hn)},{ALT:()=>this.CONSUME(un)},{ALT:()=>this.CONSUME(Ka)},{ALT:()=>this.CONSUME($a)},{ALT:()=>this.CONSUME(Ga)},{ALT:()=>this.CONSUME(fi)},{ALT:()=>this.CONSUME(ja)},{ALT:()=>this.CONSUME(Wa)},{ALT:()=>this.CONSUME(Ya)},{ALT:()=>this.CONSUME(Ha)},{ALT:()=>this.CONSUME(qt)},{ALT:()=>this.CONSUME(ka)},{ALT:()=>this.CONSUME(_a)},{ALT:()=>this.CONSUME(Ma)},{ALT:()=>this.CONSUME(Ua)},{ALT:()=>this.CONSUME(Pa)},{ALT:()=>this.CONSUME(Ra)},{ALT:()=>this.CONSUME(wa)},{ALT:()=>this.CONSUME(Va)},{ALT:()=>this.CONSUME(za)},{ALT:()=>this.CONSUME(Fa)},{ALT:()=>this.CONSUME(Ba)},{ALT:()=>this.CONSUME(ui)},{ALT:()=>this.CONSUME(hi)},{ALT:()=>this.CONSUME(qa)},{ALT:()=>this.CONSUME(Da)}]))}),this.performSelfAnalysis()}},lo=new _u;function kx(t){return lo.input=t,{cst:lo.diagram(),errors:lo.errors}}var d1=lo.getBaseCstVisitorConstructorWithDefaults(),Mu=class extends d1{constructor(e){super(),this.ctx=e,this.validateVisitor()}};function _x(t,e){let r={tokens:e},n=new Mu(r);return[]}function Mx(t,e={}){return Jt(t,{tokenize:Rx,parse:kx,analyze:(r,n)=>_x(r,n),mapParserError:(r,n)=>Ax(r,n),postLex:(r,n)=>{let i=n,s=oo(i,{code:"SE-LABEL-ESCAPED-QUOTE",message:'Escaped quotes (\\") in names or labels are not supported by Mermaid. Use &quot; instead.',hint:'Example: participant "Logger &quot;debug&quot;" as L'}).map(h=>({...h,severity:e.strict?"error":"warning"})),a=new Map;for(let h of i){let u=h.startLine??1;a.has(u)||a.set(u,[]),a.get(u).push(h)}let c=new Set(s.map(h=>h.line)),l=ai(i,{code:"SE-LABEL-DOUBLE-IN-DOUBLE",message:"Double quotes inside a double-quoted name/label are not supported. Use &quot; for inner quotes.",hint:'Example: participant "Logger &quot;debug&quot;" as L',scopeEndTokenNames:["Newline"]}).filter(h=>!c.has(h.line)).map(h=>({...h,severity:e.strict?"error":"warning"}));return s.push(...l),s},postParse:(r,n,i,o)=>{let s=[],a=n,c=a.some(m=>m.tokenType===fi),l=a.some(m=>m.tokenType===hn),h=a.some(m=>m.tokenType===ao),u=a.some(m=>m.tokenType===un);if(o.some(m=>m.severity==="error")){if(!o.some(g=>g.code==="SE-QUOTE-UNCLOSED")){let g=Kr(r,{code:"SE-QUOTE-UNCLOSED",message:"Unclosed quote in participant/actor name.",hint:'Close the quote: participant "Bob"  or  participant Alice as "Alias"',limitPerFile:1});g.length&&s.push(...g.map(E=>({...E,severity:e.strict?"error":"warning"})))}let m=o.some(g=>g.code==="SE-AND-OUTSIDE-PAR"),p=o.some(g=>g.code==="SE-ELSE-OUTSIDE-ALT");if(l&&!c&&!m){let g=a.find(E=>E.tokenType===hn);s.push({line:g.startLine??1,column:g.startColumn??1,severity:"warning",code:"SE-HINT-PAR-BLOCK-SUGGEST",message:"Found 'and' but no 'par' block in the file.",hint:"Start a parallel section with: par \u2026 and \u2026 end",length:g.image?.length??3})}if(u&&!h&&!p){let g=a.find(E=>E.tokenType===un);s.push({line:g.startLine??1,column:g.startColumn??1,severity:"warning",code:"SE-HINT-ALT-BLOCK-SUGGEST",message:"Found 'else' but no 'alt' block in the file.",hint:"Use: alt Condition \u2026 else \u2026 end",length:g.image?.length??4})}}return s}})}var Ye=S({name:"Identifier",pattern:/[A-Za-z_][A-Za-z0-9_$]*/}),tl=S({name:"NumberLiteral",pattern:/[0-9]+/}),Uu=S({name:"ClassDiagramKeyword",pattern:/classDiagram/,longer_alt:Ye}),Pu=S({name:"DirectionKw",pattern:/direction/,longer_alt:Ye}),qu=S({name:"Direction",pattern:/LR|RL|TB|BT|TD/,longer_alt:Ye}),co=S({name:"ClassKw",pattern:/class/,longer_alt:Ye}),Du=S({name:"AsKw",pattern:/as/,longer_alt:Ye}),p1=S({name:"NoteKw",pattern:/note/,longer_alt:Ye}),Fu=S({name:"RelCompToAgg",pattern:/\*--o/}),Bu=S({name:"RelAggToComp",pattern:/o--\*/}),$u=S({name:"RelCompBoth",pattern:/\*--\*/}),Ku=S({name:"RelAggBoth",pattern:/o--o/}),Gu=S({name:"LollipopLeft",pattern:/\(\)--/}),ju=S({name:"LollipopRight",pattern:/--\(\)/}),uo=S({name:"RelExtends",pattern:/<\|--/}),ho=S({name:"RelComposition",pattern:/\*--/}),fo=S({name:"RelAggregation",pattern:/o--/}),po=S({name:"RelDependency",pattern:/\.\.>/}),mo=S({name:"RelRealization",pattern:/\.\.\|>/}),go=S({name:"RelAssociation",pattern:/--/}),Wu=S({name:"InvalidRelArrow",pattern:/->(?!>)/}),Hu=S({name:"LCurly",pattern:/\{/}),zu=S({name:"RCurly",pattern:/\}/}),rl=S({name:"LParen",pattern:/\(/}),Vu=S({name:"RParen",pattern:/\)/}),Gr=S({name:"Colon",pattern:/:/}),nl=S({name:"Comma",pattern:/,/}),Yu=S({name:"Visibility",pattern:/[+\-#~]/}),xo=S({name:"LTlt",pattern:/<</}),il=S({name:"GTgt",pattern:/>>/}),It=S({name:"QuotedString",pattern:/"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'/}),Xu=S({name:"BacktickName",pattern:/`(?:\\.|[^`\\])*`/}),Qu=S({name:"SquareOpen",pattern:/\[/}),Zu=S({name:"SquareClose",pattern:/\]/}),m1=S({name:"Comment",pattern:/%%[^\n\r]*/,group:K.SKIPPED}),g1=S({name:"WhiteSpace",pattern:/[ \t]+/,group:K.SKIPPED}),tr=S({name:"Newline",pattern:/[\n\r]+/,line_breaks:!0}),Ju=[m1,It,Uu,Pu,co,Du,p1,qu,Fu,Bu,$u,Ku,Gu,ju,mo,po,uo,ho,fo,go,Wu,xo,il,Hu,zu,rl,Vu,Qu,Zu,Gr,nl,Yu,tl,Xu,Ye,g1,tr],x1=new K(Ju);function Ux(t){return x1.tokenize(t)}var th=class extends xt{constructor(){super(Ju),this.diagram=this.RULE("diagram",()=>{this.CONSUME(Uu),this.OPTION(()=>this.CONSUME(tr)),this.MANY(()=>this.SUBRULE(this.statement))}),this.statement=this.RULE("statement",()=>{this.OR([{ALT:()=>this.SUBRULE(this.directionStmt)},{ALT:()=>this.SUBRULE(this.classLine)},{ALT:()=>this.SUBRULE(this.relationStmt)},{ALT:()=>this.SUBRULE(this.memberAssignStmt)},{ALT:()=>this.CONSUME(tr)}])}),this.directionStmt=this.RULE("directionStmt",()=>{this.CONSUME(Pu),this.CONSUME(qu),this.OPTION(()=>this.CONSUME(tr))}),this.classLine=this.RULE("classLine",()=>{this.CONSUME(co),this.SUBRULE(this.classRef),this.OR([{ALT:()=>{this.CONSUME(Hu),this.MANY(()=>{this.OR2([{ALT:()=>this.CONSUME3(tr)},{ALT:()=>this.SUBRULE(this.memberLineStmt)}])}),this.CONSUME(zu),this.OPTION(()=>this.CONSUME(tr))}},{ALT:()=>{this.OPTION1(()=>{this.CONSUME(Qu),this.CONSUME(It),this.CONSUME(Zu)}),this.OPTION2(()=>{this.CONSUME(xo),this.CONSUME2(Ye),this.CONSUME(il)}),this.OPTION3(()=>{this.CONSUME(Du),this.CONSUME3(Ye)}),this.OPTION4(()=>this.CONSUME2(tr))}}])}),this.memberAssignStmt=this.RULE("memberAssignStmt",()=>{this.SUBRULE(this.classRef),this.CONSUME(Gr),this.SUBRULE(this.memberLine),this.OPTION(()=>this.CONSUME(tr))}),this.memberLineStmt=this.RULE("memberLineStmt",()=>{this.SUBRULE(this.memberLine)}),this.memberLine=this.RULE("memberLine",()=>{this.OR([{GATE:()=>this.LA(1).tokenType===xo,ALT:()=>{this.CONSUME(xo),this.CONSUME(Ye),this.CONSUME(il)}},{ALT:()=>{this.OPTION(()=>this.CONSUME(Yu)),this.OPTION1({GATE:()=>this.LA(1).tokenType!==rl,DEF:()=>this.SUBRULE(this.memberName)}),this.OPTION2(()=>{this.CONSUME(rl),this.OPTION3(()=>this.SUBRULE(this.argList)),this.CONSUME(Vu)}),this.OPTION4(()=>{this.CONSUME(Gr),this.SUBRULE(this.typeRef)})}}])}),this.memberName=this.RULE("memberName",()=>{this.OR([{ALT:()=>this.CONSUME(Ye)},{ALT:()=>this.CONSUME(It)}])}),this.param=this.RULE("param",()=>{this.OPTION(()=>{this.CONSUME(Ye),this.CONSUME(Gr)}),this.SUBRULE(this.typeRef)}),this.argList=this.RULE("argList",()=>{this.SUBRULE(this.param),this.MANY(()=>{this.CONSUME(nl),this.SUBRULE2(this.param)})}),this.typeRef=this.RULE("typeRef",()=>{this.OR([{ALT:()=>this.CONSUME(Ye)},{ALT:()=>this.CONSUME(tl)},{ALT:()=>this.CONSUME(It)}])}),this.relationOp=this.RULE("relationOp",()=>{this.OR([{ALT:()=>this.CONSUME(Fu)},{ALT:()=>this.CONSUME(Bu)},{ALT:()=>this.CONSUME($u)},{ALT:()=>this.CONSUME(Ku)},{ALT:()=>this.CONSUME(Gu)},{ALT:()=>this.CONSUME(ju)},{ALT:()=>this.CONSUME(uo)},{ALT:()=>this.CONSUME(ho)},{ALT:()=>this.CONSUME(fo)},{ALT:()=>this.CONSUME(mo)},{ALT:()=>this.CONSUME(po)},{ALT:()=>this.CONSUME(go)}])}),this.classRef=this.RULE("classRef",()=>{this.OR([{ALT:()=>this.CONSUME(Ye)},{ALT:()=>this.CONSUME(It)},{ALT:()=>this.CONSUME(Xu)}])}),this.labelText=this.RULE("labelText",()=>{this.OR([{ALT:()=>this.CONSUME(It)},{ALT:()=>this.CONSUME(Ye)},{ALT:()=>this.CONSUME(tl)}])}),this.relationStmt=this.RULE("relationStmt",()=>{this.SUBRULE(this.classRef),this.OPTION1(()=>this.CONSUME(It)),this.SUBRULE(this.relationOp),this.OPTION2(()=>this.CONSUME2(It)),this.SUBRULE2(this.classRef),this.OPTION3(()=>{this.CONSUME(Gr),this.AT_LEAST_ONE_SEP({SEP:nl,DEF:()=>this.SUBRULE(this.labelText)})}),this.OPTION4(()=>this.CONSUME(tr))}),this.performSelfAnalysis()}},eh=new th;function qx(t){return eh.input=t,{cst:eh.diagram(),errors:eh.errors}}function Dx(t,e){return[]}function Fx(t,e={}){return Jt(t,{tokenize:Ux,parse:qx,analyze:Dx,mapParserError:Lx,postLex:(r,n)=>{let i=[],o=n;for(let s=0;s<o.length-1;s++){let a=o[s],c=o[s+1];a.tokenType===co&&c.tokenType===It&&i.push({line:c.startLine??1,column:c.startColumn??1,severity:"error",code:"CL-NAME-DOUBLE-QUOTED",message:"Double-quoted class name is not supported. Use backticks for names with spaces/punctuation, or use a label.",hint:'Example: class `Logger "core"` as L  or  class L["Logger "core""]',length:c.image?.length??1})}for(let s of o)s.tokenType===Wu&&i.push({line:s.startLine??1,column:s.startColumn??1,severity:"error",code:"CL-REL-INVALID",message:"Invalid relationship operator '->'. Use <|--, *--, o--, --, ..> or ..|>.",hint:"Example: Foo <|-- Bar",length:s.image?.length??2});for(let s=0;s<o.length;s++){let a=o[s];if(!(a.tokenType===uo||a.tokenType===ho||a.tokenType===fo||a.tokenType===po||a.tokenType===mo||a.tokenType===go))continue;let l=a.startLine??-1,h=s+1,u=null,f=!1;for(;h<o.length;){let m=o[h];if((m.startLine??-1)!==l)break;if(m.tokenType===Ye||m.tokenType===It){f=!0;break}if(m.tokenType===Gr){u=m;break}h++}u&&!f&&i.push({line:l,column:u.startColumn??1,severity:"error",code:"CL-REL-MALFORMED",message:"Malformed relationship. Provide a target class before the label.",hint:"Use: A <|-- B : label",length:u.image?.length??1})}return i},postParse:(r,n,i,o)=>{let s=[],a=(h,u)=>(o||[]).some(f=>f.code===h&&f.line===u&&f.severity==="error"),c=r.split(/\r?\n/),l=[];for(let h=0;h<c.length;h++){let u=c[h]||"";/^\s*class\b.*\{\s*$/.test(u)&&l.push(h+1)}if(l.length>0&&!c.some(u=>/\}/.test(u))&&!a("CL-BLOCK-MISSING-RBRACE",Math.max(1,c.length))){let u=l[l.length-1];s.push({line:Math.max(1,c.length),column:1,severity:"error",code:"CL-BLOCK-MISSING-RBRACE",message:"Missing '}' to close class block.",hint:"Close the block: class Foo { ... }"})}return s}})}var Se=S({name:"Identifier",pattern:/[A-Za-z_][A-Za-z0-9_]*/}),Eo=S({name:"NumberLiteral",pattern:/[0-9]+/}),rh=S({name:"StateDiagramV2",pattern:/stateDiagram-v2/}),nh=S({name:"StateDiagram",pattern:/stateDiagram/,longer_alt:Se}),ol=S({name:"StateKw",pattern:/state/,longer_alt:Se}),ih=S({name:"AsKw",pattern:/as/,longer_alt:Se}),oh=S({name:"DirectionKw",pattern:/direction/,longer_alt:Se}),sh=S({name:"Direction",pattern:/LR|RL|TB|BT|TD/,longer_alt:Se}),yo=S({name:"NoteKw",pattern:/note/i,longer_alt:Se}),ah=S({name:"LeftKw",pattern:/left/,longer_alt:Se}),lh=S({name:"RightKw",pattern:/right/,longer_alt:Se}),sl=S({name:"OfKw",pattern:/of/,longer_alt:Se}),ch=S({name:"OverKw",pattern:/over/,longer_alt:Se}),al=S({name:"AngleAngleOpen",pattern:/<</}),ll=S({name:"AngleAngleClose",pattern:/>>/}),E1=S({name:"Dashes",pattern:/---+/}),uh=S({name:"StyleClassDefKw",pattern:/classDef/,longer_alt:Se}),hh=S({name:"StyleClassKw",pattern:/class(?!Diagram)/,longer_alt:Se}),fh=S({name:"Start",pattern:/\[\*\]/}),dh=S({name:"Arrow",pattern:/-->/}),ph=S({name:"InvalidArrow",pattern:/->(?!>)/}),mh=S({name:"Hyphen",pattern:/-/}),gh=S({name:"LCurly",pattern:/\{/}),xh=S({name:"RCurly",pattern:/\}/}),To=S({name:"Colon",pattern:/:/}),Eh=S({name:"Comma",pattern:/,/}),rr=S({name:"QuotedString",pattern:/"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'/}),y1=S({name:"Comment",pattern:/%%[^\n\r]*/,group:K.SKIPPED}),T1=S({name:"WhiteSpace",pattern:/[ \t]+/,group:K.SKIPPED}),Et=S({name:"Newline",pattern:/[\n\r]+/,line_breaks:!0}),fn=S({name:"LabelChunk",pattern:/[^\n\r<\-][^\n\r]*/}),yh=[y1,rr,rh,nh,ol,ih,oh,sh,yo,ah,lh,sl,ch,al,ll,fh,dh,ph,E1,mh,uh,hh,gh,xh,To,Eh,Eo,Se,T1,fn,Et],S1=new K(yh);function Bx(t){return S1.tokenize(t)}var Sh=class extends xt{constructor(){super(yh),this.diagram=this.RULE("diagram",()=>{this.OR([{ALT:()=>this.CONSUME(rh)},{ALT:()=>this.CONSUME(nh)}]),this.OPTION(()=>this.CONSUME(Et)),this.MANY(()=>this.SUBRULE(this.statement))}),this.statement=this.RULE("statement",()=>{this.OR([{ALT:()=>this.SUBRULE(this.directionStmt)},{ALT:()=>this.SUBRULE(this.transitionStmt)},{ALT:()=>this.SUBRULE(this.stateBlock)},{ALT:()=>this.SUBRULE(this.stateDecl)},{ALT:()=>this.SUBRULE(this.stateDescriptionStmt)},{ALT:()=>this.SUBRULE(this.noteStmt)},{ALT:()=>this.SUBRULE(this.styleStmt)},{ALT:()=>this.CONSUME(Et)}])}),this.styleStmt=this.RULE("styleStmt",()=>{this.OR([{ALT:()=>{this.CONSUME(uh),this.OPTION1(()=>this.CONSUME1(fn))}},{ALT:()=>{this.CONSUME(hh),this.OPTION2(()=>this.CONSUME2(fn))}}]),this.OPTION3(()=>this.CONSUME(Et))}),this.directionStmt=this.RULE("directionStmt",()=>{this.CONSUME(oh),this.CONSUME(sh),this.OPTION(()=>this.CONSUME(Et))}),this.actorRef=this.RULE("actorRef",()=>{this.OR([{ALT:()=>this.CONSUME(fh)},{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(Se)},{ALT:()=>this.CONSUME(rr)}]),this.OPTION(()=>{this.CONSUME(al),this.CONSUME2(Se),this.CONSUME(ll)})}}])}),this.labelText=this.RULE("labelText",()=>{this.OR([{ALT:()=>this.CONSUME(rr)},{ALT:()=>this.CONSUME(Se)},{ALT:()=>this.CONSUME(Eo)},{ALT:()=>this.CONSUME(mh)},{ALT:()=>this.CONSUME(fn)}])}),this.transitionStmt=this.RULE("transitionStmt",()=>{this.SUBRULE(this.actorRef),this.CONSUME(dh),this.SUBRULE2(this.actorRef),this.OPTION(()=>{this.CONSUME(To),this.AT_LEAST_ONE(()=>{this.OR([{ALT:()=>this.CONSUME(rr)},{ALT:()=>this.CONSUME(Se)},{ALT:()=>this.CONSUME(Eo)},{ALT:()=>this.CONSUME(fn)}])})}),this.OPTION2(()=>this.CONSUME(Et))}),this.stateDecl=this.RULE("stateDecl",()=>{this.CONSUME(ol),this.OR([{GATE:()=>this.LA(1).tokenType===rr,ALT:()=>{this.CONSUME(rr),this.CONSUME(ih),this.CONSUME(Se)}},{ALT:()=>{this.CONSUME2(Se),this.OPTION1(()=>{this.CONSUME(al),this.CONSUME3(Se),this.CONSUME(ll)})}}]),this.OPTION2(()=>this.CONSUME(Et))}),this.stateBlock=this.RULE("stateBlock",()=>{this.CONSUME(ol),this.OR([{ALT:()=>this.CONSUME(Se)},{ALT:()=>this.CONSUME(rr)}]),this.CONSUME(gh),this.MANY(()=>this.SUBRULE(this.statement)),this.CONSUME(xh),this.OPTION(()=>this.CONSUME(Et))}),this.noteStmt=this.RULE("noteStmt",()=>{this.CONSUME(yo),this.OR([{ALT:()=>{this.CONSUME(ah),this.CONSUME(sl),this.SUBRULE(this.actorRef)}},{ALT:()=>{this.CONSUME(lh),this.CONSUME2(sl),this.SUBRULE2(this.actorRef)}},{ALT:()=>{this.CONSUME(ch),this.SUBRULE3(this.actorRef),this.OPTION1(()=>{this.CONSUME(Eh),this.SUBRULE4(this.actorRef)})}}]),this.CONSUME(To),this.AT_LEAST_ONE(()=>this.SUBRULE(this.labelText)),this.OPTION2(()=>this.CONSUME(Et))}),this.stateDescriptionStmt=this.RULE("stateDescriptionStmt",()=>{this.OR1([{ALT:()=>this.CONSUME1(Se)},{ALT:()=>this.CONSUME1(rr)}]),this.CONSUME(To),this.AT_LEAST_ONE(()=>{this.OR2([{ALT:()=>this.CONSUME2(rr)},{ALT:()=>this.CONSUME2(Se)},{ALT:()=>this.CONSUME1(Eo)},{ALT:()=>this.CONSUME1(fn)}])}),this.OPTION(()=>this.CONSUME(Et))}),this.performSelfAnalysis()}},Th=new Sh;function Kx(t){return Th.input=t,{cst:Th.diagram(),errors:Th.errors}}function Gx(t,e){return[]}function jx(t,e={}){return Jt(t,{tokenize:Bx,parse:Kx,analyze:Gx,mapParserError:bx,postLex:(r,n)=>{let i=[],o=n;for(let s=0;s<o.length;s++){let a=o[s];a.tokenType===ph&&i.push({line:a.startLine??1,column:a.startColumn??1,severity:"error",code:"ST-ARROW-INVALID",message:"Invalid arrow '->'. Use '-->' in state transitions.",hint:"Example: A --> B : event",length:a.image?.length??2})}for(let s=0;s<o.length;s++){let a=o[s];if(a.tokenType===yo){let c=o[s-1];c&&c.tokenType!==Et&&c.startLine===a.startLine&&i.push({line:a.startLine??1,column:a.startColumn??1,severity:"error",code:"ST-NOTE-GLUED",message:"'Note' must start on a new line (not glued to the previous statement).",hint:"Put 'Note \u2026' on its own line: Note right of Auth: \u2026",length:a.image?.length??4})}}return i},postParse:(r,n,i,o)=>{let s=[],a=(h,u)=>(o||[]).some(f=>f.code===h&&f.line===u&&f.severity==="error")||s.some(f=>f.code===h&&f.line===u),c=r.split(/\r?\n/),l=[];for(let h=0;h<c.length;h++){let u=c[h]||"",f=h+1;if(/^\s*state\b.*\{\s*$/.test(u)&&l.push(f),/^\s*Note\b/i.test(u)&&!/:/.test(u)){let m=u.length-u.trimStart().length;if(u.replace(/^\s*Note\s+(left|right)\s+of\s+[^:]+/i,"").replace(/^\s*Note\s+over\s+[^:]+/i,"")!==u){if(u.indexOf(":")===-1){let E=/(Note\s+(left|right)\s+of\s+[^:]+|Note\s+over\s+[^:]+)/i.exec(u),x=E?E.index+(E[0]?.length||0)+1:1;a("ST-NOTE-MALFORMED",f)||s.push({line:f,column:x,severity:"error",code:"ST-NOTE-MALFORMED",message:"Malformed note: missing colon before note text.",hint:"Example: Note right of A: message"})}}}}return l.length>0&&!c.some(u=>/\}/.test(u))&&!a("ST-BLOCK-MISSING-RBRACE",Math.max(1,c.length))&&s.push({line:Math.max(1,c.length),column:1,severity:"error",code:"ST-BLOCK-MISSING-RBRACE",message:"Missing '}' to close a state block.",hint:"Close the block: state Foo { ... }"}),s}})}function Wx(t){let e=t.split(/\r?\n/);for(let r of e){let n=r.trim();if(n&&!n.startsWith("%%"))return n}}function Hx(t){let e=Wx(t);return e?/^(flowchart|graph)\b/i.test(e)?"flowchart":/^pie\b/i.test(e)?"pie":/^sequenceDiagram\b/i.test(e)?"sequence":/^classDiagram\b/.test(e)?"class":/^stateDiagram(?:-v2)?\b/.test(e)?"state":"unknown":"unknown"}function O1(t){if(!t)return!1;let r=/^(\w[\w-]*)/.exec(t)?.[1]||"";return new Set(["classDiagram","stateDiagram","stateDiagram-v2","erDiagram","journey","userJourney","gantt","gitGraph","mindmap","timeline","quadrantChart","xychart","xychart-beta","xyChart","sankey","sankey-beta","requirementDiagram","C4Context","C4Container","C4Component","C4Deployment","C4Dynamic","block","block-beta","blockDiagram","treemap","treemap-beta"]).has(r)}function cl(t,e={}){let r=Hx(t);switch(r){case"flowchart":return{type:r,errors:vx(t,e)};case"pie":return{type:r,errors:Ix(t,e)};case"sequence":return{type:r,errors:Mx(t,e)};case"class":return{type:r,errors:Fx(t,e)};case"state":return{type:r,errors:jx(t,e)};default:let n=Wx(t);return O1(n)?{type:r,errors:[]}:{type:r,errors:[{line:1,column:1,message:'Diagram must start with "graph", "flowchart", "pie", "sequenceDiagram", "classDiagram" or "stateDiagram[-v2]"',severity:"error",code:"GEN-HEADER-INVALID",hint:"Start with: flowchart TD | pie | sequenceDiagram | classDiagram | stateDiagram-v2."}]}}}function Vx(t){return t.split(/\r?\n/)}function zx(t,e){let r=Vx(t),n=Math.max(0,Math.min(r.length-1,e.line-1)),i=r[n]??"",o=Math.max(1,e.column),s=0;for(let a=0;a<n;a++)s+=(r[a]?.length??0)+1;return s+=Math.min(i.length,o-1),s}function Oh(t,e){if(!e||e.length===0)return t;let r=e.map(i=>{let o=zx(t,i.start),s=i.end?zx(t,i.end):o;return{startOff:o,endOff:s,newText:i.newText}}).sort((i,o)=>o.startOff-i.startOff),n=t;for(let i of r)n=n.slice(0,i.startOff)+i.newText+n.slice(i.endOff);return n}function Ze(t,e,r,n){return{start:e,end:{line:e.line,column:e.column+Math.max(0,r)},newText:n}}function Ie(t,e,r){return{start:e,newText:r}}function be(t,e){let r=Vx(t);return r[Math.max(0,Math.min(r.length-1,e-1))]??""}function jr(t){let e=/^(\s*)/.exec(t);return e&&e[1]||""}function ut(t){return{line:t.line,column:t.column}}function z(t,e){return e.code===t}function Ah(t,e,r="safe"){let n=[],i=new Set,o=new Set,s=new Set;for(let l of e){let h=`${l.code}@${l.line}:${l.column}:${l.length??1}`;if(!o.has(h)){if(o.add(h),z("FL-ARROW-INVALID",l)){n.push(Ze(t,ut(l),l.length??2,"-->"));continue}if(z("CL-NAME-DOUBLE-QUOTED",l)){let u=be(t,l.line),f=u.indexOf("class"),m=f>=0?f+5:0,p=u.indexOf('"',m);if(p!==-1){let g=u.indexOf(" as ",p+1),E=g!==-1?u.lastIndexOf('"',g-1):u.lastIndexOf('"');if(E>p)if(g!==-1){let T='"'+u.slice(p+1,E).replace(/\"/g,'"').replace(/"/g,"&quot;")+'"',y=u.slice(g+4).trim(),A=`${u.slice(0,m).trimEnd()} ${y}[${T}]`;n.push({start:{line:l.line,column:1},end:{line:l.line,column:u.length+1},newText:A})}else n.push(Ze(t,{line:l.line,column:p+1},1,"`")),n.push(Ze(t,{line:l.line,column:E+1},1,"`"))}continue}if(z("FL-LABEL-ESCAPED-QUOTE",l)){let u=be(t,l.line),f=Math.max(0,l.column-1),p=[{tok:"[[",idx:u.lastIndexOf("[[",f),delta:2},{tok:"{",idx:u.lastIndexOf("{",f),delta:1},{tok:"[",idx:u.lastIndexOf("[",f),delta:1},{tok:"((",idx:u.lastIndexOf("((",f),delta:2}].filter(g=>g.idx!==-1).sort((g,E)=>g.idx-E.idx).pop();if(p){let g=[u.indexOf("]]",f),u.indexOf("}",f),u.indexOf("]",f),u.indexOf("))",f)].filter(x=>x!==-1).sort((x,T)=>x-T),E=g.length?g[0]:-1;if(E!==-1){let x=u.indexOf('"',p.idx+p.delta),T=u.lastIndexOf('"',E-1);if(x!==-1&&T!==-1&&T>x){let y=u.slice(x+1,T);if(y.includes('\\"')){let O=y.split('\\"').join("&quot;");n.push({start:{line:l.line,column:x+2},end:{line:l.line,column:T+1},newText:O});continue}}}}n.push(Ze(t,ut(l),l.length??2,"&quot;"));continue}if(z("FL-LABEL-DOUBLE-IN-DOUBLE",l)){let u=be(t,l.line),f=Math.max(0,l.column-1),p=[{tok:"[[",idx:u.lastIndexOf("[[",f)},{tok:"((",idx:u.lastIndexOf("((",f)},{tok:"{",idx:u.lastIndexOf("{",f)},{tok:"(",idx:u.lastIndexOf("(",f)},{tok:"[",idx:u.lastIndexOf("[",f)}].sort((E,x)=>(E.idx||-1)-(x.idx||-1)).pop(),g=p&&p.idx>=0?p.idx:-1;if(g>=0){let x=[{tok:"]]",idx:u.indexOf("]]",f)},{tok:"))",idx:u.indexOf("))",f)},{tok:"}",idx:u.indexOf("}",f)},{tok:")",idx:u.indexOf(")",f)},{tok:"]",idx:u.indexOf("]",f)}].filter(A=>A.idx!==-1).sort((A,L)=>A.idx-L.idx)[0],T=x?x.idx:u.length,y=u.indexOf('"',g+1),O=u.lastIndexOf('"',T-1);if(y!==-1&&O!==-1&&O>y){let A=u.slice(y+1,O),L=A.split("&quot;").join("\0").split('"').join("&quot;").split("\0").join("&quot;");if(L!==A){let b={line:l.line,column:y+2},v={line:l.line,column:O+1};n.push({start:b,end:v,newText:L});continue}}}n.push(Ze(t,ut(l),l.length??1,"&quot;"));continue}if(z("FL-LABEL-DOUBLE-IN-SINGLE",l)){let u=be(t,l.line),f=Math.max(0,l.column-1),m=u.lastIndexOf("'",f),p=u.indexOf("'",Math.max(f+1,m+1));if(m!==-1&&p!==-1&&p>m){let g=u.slice(m+1,p),E=g.split("&quot;").join("\0").split('"').join("&quot;").split("\0").join("&quot;");if(E!==g){let x={line:l.line,column:m+2},T={line:l.line,column:p+1};n.push({start:x,end:T,newText:E}),i.add(l.line);continue}}if(i.has(l.line))continue;n.push(Ze(t,ut(l),l.length??1,"&quot;"));continue}if(z("FL-NODE-MIXED-BRACKETS",l)){let u=l.message||"",f=be(t,l.line),m=Math.max(0,l.column-1);if(u.includes("opened '('")&&u.includes("closed with ']'")){let g=f.lastIndexOf("(",m);if(g!==-1){n.push({start:{line:l.line,column:g+1},end:{line:l.line,column:g+2},newText:"["});continue}}let p=")";u.includes("opened '['")?p="]":u.includes("opened '('")?p=")":u.includes("opened '{'")?p="}":u.includes("opened '[[ '")?p="]]":u.includes("opened '(( '")&&(p="))"),n.push(Ze(t,ut(l),l.length??1,p));continue}if(z("FL-NODE-EMPTY",l)){let u=be(t,l.line),f=Math.max(0,l.column-1),m=u[f]==="["?f:u.lastIndexOf("[",f);if(m>=0){let p=u.indexOf("]",Math.max(m+1,f));if(p!==-1){let g={line:l.line,column:m+1},E=p-m+1;n.push(Ze(t,g,E,""))}}continue}if(z("FL-DIR-KW-INVALID",l)){n.push(Ze(t,ut(l),l.length??0,"direction"));continue}if(z("FL-DIR-MISSING",l)){(r==="safe"||r==="all")&&n.push(Ie(t,ut(l)," TD"));continue}if(z("FL-LINK-MISSING",l)){r==="all"&&n.push(Ie(t,ut(l)," --> "));continue}if(z("FL-NODE-UNCLOSED-BRACKET",l)){if(r==="safe"||r==="all"){let u=be(t,l.line),f=Math.max(0,l.column-1),m=u.lastIndexOf("[",f),p=u.indexOf("]",f);if(m!==-1&&p!==-1&&p>m){let O=u.slice(m+1,p);if(O.includes('"')){let A=O.match(/^\s*/)?.[0]??"",L=O.match(/\s*$/)?.[0]??"",b=O.slice(A.length,O.length-L.length),v=b.slice(0,1),P=b.slice(-1),M=(U,w)=>U==="/"&&w==="/"||U==="\\"&&w==="\\"||U==="/"&&w==="\\"||U==="\\"&&w==="/",k;if(b.length>=2&&M(v,P)){let w=b.slice(1,-1).split("&quot;").join("\0").split('"').join("&quot;").split("\0").join("&quot;");k=A+v+w+P+L}else k='"'+O.split("&quot;").join("\0").split('"').join("&quot;").split("\0").join("&quot;")+'"';n.push({start:{line:l.line,column:m+2},end:{line:l.line,column:p+1},newText:k}),i.add(l.line);continue}}if(i.has(l.line))continue;let E=[{open:"{{",close:"}}",idx:u.lastIndexOf("{{",f),len:2},{open:"[[",close:"]]",idx:u.lastIndexOf("[[",f),len:2},{open:"([",close:"])",idx:u.lastIndexOf("([",f),len:2},{open:"[(",close:")]",idx:u.lastIndexOf("[(",f),len:2},{open:"{",close:"}",idx:u.lastIndexOf("{",f),len:1},{open:"(",close:")",idx:u.lastIndexOf("(",f),len:1},{open:"[",close:"]",idx:u.lastIndexOf("[",f),len:1}].filter(O=>O.idx!==-1).sort((O,A)=>O.idx-A.idx).pop();if(E){if(E.open==="{"){let O=u.lastIndexOf("{{",f);O!==-1&&O+1===E.idx&&(E={open:"{{",close:"}}",idx:O,len:2})}else if(E.open==="["){let O=u.lastIndexOf("[[",f),A=u.lastIndexOf("[(",f);O!==-1&&O===E.idx?E={open:"[[",close:"]]",idx:O,len:2}:A!==-1&&A===E.idx&&(E={open:"[(",close:")]",idx:A,len:2})}else if(E.open==="("){let O=u.lastIndexOf("((",f),A=u.lastIndexOf("([",f),L=u.lastIndexOf("[(",f);O!==-1&&O===E.idx?E={open:"((",close:"))",idx:O,len:2}:A!==-1&&A===E.idx-1?E={open:"([",close:"])",idx:A,len:2}:L!==-1&&L===E.idx-1&&(E={open:"[(",close:")]",idx:L,len:2})}}let x="]";E&&(x=E.close);let T=u.slice(f),y=Math.min(x.length,Math.max(1,T.length));n.push({start:{line:l.line,column:f+1},end:{line:l.line,column:f+1+y},newText:x})}continue}if(z("FL-QUOTE-UNCLOSED",l)){if(r==="all"){let u=be(t,l.line),f=Math.max(0,l.column-1);if((u.replace(/\\\"/g,"").match(/\"/g)||[]).length%2===1){let g=[],E=x=>{x>=0&&g.push({idx:x})};if(E(u.indexOf("]]",f)),E(u.indexOf("))",f)),E(u.indexOf("}",f)),E(u.indexOf("]",f)),E(u.indexOf(")",f)),g.length){let x=g.reduce((y,O)=>y.idx!==-1&&y.idx<=O.idx?y:O),T=(x.idx>=0?x.idx:u.length)+1;n.push(Ie(t,{line:l.line,column:T},'"'))}}}continue}if(z("FL-LABEL-QUOTE-IN-UNQUOTED",l)){if(r==="safe"||r==="all"){let u=be(t,l.line),f=Math.max(0,l.column-1),p=[{open:"[[",close:"]]",idx:u.lastIndexOf("[[",f),delta:2},{open:"((",close:"))",idx:u.lastIndexOf("((",f),delta:2},{open:"{",close:"}",idx:u.lastIndexOf("{",f),delta:1},{open:"[",close:"]",idx:u.lastIndexOf("[",f),delta:1}].filter(g=>g.idx!==-1).sort((g,E)=>g.idx-E.idx).pop();if(p){let g=p.idx+p.delta,E=u.indexOf(p.close,Math.max(f,g));if(E!==-1){let x=u.slice(g,E),T=x.match(/^\s*/)?.[0]??"",y=x.match(/\s*$/)?.[0]??"",O=x.slice(T.length,x.length-y.length),A=O.slice(0,1),L=O.slice(-1),b=(P,M)=>P==="/"&&M==="/"||P==="\\"&&M==="\\"||P==="/"&&M==="\\"||P==="\\"&&M==="/",v;if(O.length>=2&&b(A,L)){let M=O.slice(1,-1).split("&quot;").join("\0").split('"').join("&quot;").split("\0").join("&quot;");v=T+A+M+L+y}else v='"'+x.split("&quot;").join("\0").split('"').join("&quot;").split("\0").join("&quot;")+'"';n.push({start:{line:l.line,column:g+1},end:{line:l.line,column:E+1},newText:v}),i.add(l.line)}}}continue}if(z("PI-LABEL-ESCAPED-QUOTE",l)){n.push(Ze(t,ut(l),l.length??1,"&quot;"));continue}if(z("PI-MISSING-COLON",l)){n.push(Ie(t,ut(l)," : "));continue}if(z("PI-LABEL-DOUBLE-IN-DOUBLE",l)){let u=be(t,l.line),f=u.indexOf('"'),m=u.indexOf(":"),p=m!==-1?u.lastIndexOf('"',m-1):u.lastIndexOf('"');if(f!==-1&&p!==-1&&p>f){let g=u.slice(f+1,p),E=g.split("&quot;").join("\0").split('"').join("&quot;").split("\0").join("&quot;");E!==g&&n.push({start:{line:l.line,column:f+2},end:{line:l.line,column:p+1},newText:E})}continue}if(z("PI-LABEL-REQUIRES-QUOTES",l)){let u=be(t,l.line),f=u.indexOf(":");if(f>0){let m=u.slice(0,f),p=m.search(/\S/),g=m.replace(/\s+$/,"").length;p>=0&&g>p&&(n.push(Ie(t,{line:l.line,column:p+1},'"')),n.push(Ie(t,{line:l.line,column:g+1},'"')))}continue}if(z("PI-QUOTE-UNCLOSED",l)){if(r==="all"){if(s.has(l.line))continue;let u=be(t,l.line),f=u.indexOf(":"),m=f>0?f+1:u.length+1;n.push(Ie(t,{line:l.line,column:m},'"')),s.add(l.line)}continue}if(z("SE-MSG-COLON-MISSING",l)){let u=be(t,l.line),f=["<<-->>","<<->>","-->>","->>","-->","->","--x","-x","--)","-)"],m=-1,p=0;for(let g of f){let E=u.indexOf(g);E!==-1&&(m===-1||E<m)&&(m=E,p=g.length)}if(m!==-1){let g=m+p;for((u[g]==="+"||u[g]==="-")&&g++;g<u.length&&/\s/.test(u[g]);)g++;let E=g;if(u[g]==='"'||u[g]==="'"){let y=u[g];for(E=g+1;E<u.length;){if(u[E]==="\\"){E+=2;continue}if(u[E]===y){E++;break}E++}}else for(;E<u.length&&!/\s/.test(u[E])&&u[E]!==":";)E++;let x=E+1;(u[E]||"")===" "?n.push(Ze(t,{line:l.line,column:x},1," : ")):n.push(Ie(t,{line:l.line,column:x}," : "))}else n.push(Ie(t,ut(l),": "));continue}if(z("SE-NOTE-MALFORMED",l)){let u=be(t,l.line),f=/^(\s*)Note\s+(left|right)\s+of\s+(.+?)\s+(.+)$/.exec(u),m=/^(\s*)Note\s+over\s+(.+?)\s+(.+)$/.exec(u),p=l.column;f?p=`${f[1]||""}Note ${f[2]} of ${f[3]}`.length+1:m&&(p=`${m[1]||""}Note over ${m[2]}`.length+1);let g=Math.max(0,p-1);(u[g]||"")===" "?n.push(Ze(t,{line:l.line,column:p},1," : ")):n.push(Ie(t,{line:l.line,column:p}," : "));continue}if(z("SE-ELSE-IN-CRITICAL",l)){n.push(Ze(t,ut(l),l.length??4,"option"));continue}if(z("SE-BLOCK-MISSING-END",l)){let u=t.split(/\r?\n/),f=Math.max(0,l.line-1),m=/^(\s*)(alt\b|opt\b|loop\b|par\b|rect\b|critical\b|break\b|box\b)/,p=-1,g="";for(let T=f;T>=0;T--){let y=m.exec(u[T]||"");if(y){p=T,g=y[1]||"";break}}if(p===-1){let T=jr(u[f]||"");n.push(Ie(t,{line:f+1,column:1},`${T}end
`));continue}let E=u.length;for(let T=p+1;T<u.length;T++){let y=u[T]||"";if(y.trim()==="")continue;if(jr(y).length<=g.length){E=T;break}}let x=E;n.push(Ie(t,{line:x+1,column:1},`${g}end
`));continue}if(z("SE-AUTONUMBER-EXTRANEOUS",l)){let u=be(t,l.line),f=u.length,m=jr(u),p=l.column,x=u.slice(0,Math.max(0,p-1)).replace(/\s+$/,"").length+1,T=u.slice(Math.max(0,p-1)).replace(/^\s+/,"");n.push({start:{line:l.line,column:x},end:{line:l.line,column:f+1},newText:`
${m}${T}`});continue}if(z("SE-AUTONUMBER-MALFORMED",l)||z("SE-AUTONUMBER-NON-NUMERIC",l)){if(r==="all"){let u=be(t,l.line),f=u.indexOf("autonumber");f>=0&&n.push({start:{line:l.line,column:f+1},end:{line:l.line,column:u.length+1},newText:"autonumber"})}continue}if(z("SE-LABEL-ESCAPED-QUOTE",l)){n.push(Ze(t,ut(l),l.length??1,"&quot;"));continue}if(z("SE-LABEL-DOUBLE-IN-DOUBLE",l)){let u=be(t,l.line),f=u.trimStart();if(/^(participant|actor)\b/.test(f)){let m=u.indexOf("participant"),p=m===-1?u.indexOf("actor"):m,g=p>=0?p:0,E=u.indexOf('"',g);if(E!==-1){let x=u.indexOf(" as ",E+1),T=x!==-1?u.lastIndexOf('"',x-1):u.lastIndexOf('"');if(T>E){let y=u.slice(E+1,T),O=y.split("&quot;").join("\0").split('"').join("&quot;").split("\0").join("&quot;");if(O!==y){let A={line:l.line,column:E+2},L={line:l.line,column:T+1};n.push({start:A,end:L,newText:O})}}}}continue}if(z("SE-QUOTE-UNCLOSED",l)){if(r==="all"){let f=be(t,l.line).length+1;n.push(Ie(t,{line:l.line,column:f},'"'))}continue}if(z("ST-ARROW-INVALID",l)){n.push(Ze(t,ut(l),l.length??2,"-->"));continue}if(z("ST-NOTE-MALFORMED",l)){let u=t.split(/\r?\n/),f=be(t,l.line),m=/^(\s*)Note\s+(left|right)\s+of\s+([^:]+?)\s+(.+)$/.exec(f),p=/^(\s*)Note\s+over\s+([^:]+?)\s+(.+)$/.exec(f),g="",E="right",x="",T="";if(m?(g=m[1]||"",E=(m[2]||"right").toLowerCase(),x=(m[3]||"").trim(),T=(m[4]||"").trim()):p&&(g=p[1]||"",E="right",x=(p[2]||"").split(",").map(O=>O.trim()).filter(Boolean)[0]||"",T=(p[3]||"").trim()),x){let y=`${g}Note ${E} of ${x} : ${T}`,O=u.slice(0,Math.max(0,l.line-1)).join(`
`);if(new RegExp(`(^|
|\b)${x}(\b)`).test(O))n.push({start:{line:l.line,column:1},end:{line:l.line,column:f.length+1},newText:y});else{let L=u.length+1;for(let b=l.line;b<u.length;b++){let v=u[b]||"";if(new RegExp(`(^|\\b)${x}(\\b)`).test(v)){L=b+2;break}}n.push({start:{line:l.line,column:1},end:{line:l.line+1,column:1},newText:""}),n.push(Ie(t,{line:L,column:1},y+`
`))}}else{let y=/^(\s*Note\s+(?:left|right)\s+of\s+[^:]+|\s*Note\s+over\s+[^:]+)/i.exec(f),O=y?(y[0]||"").length+1:l.column;n.push(Ie(t,{line:l.line,column:O}," : "))}continue}if(z("ST-BLOCK-MISSING-RBRACE",l)){let u=t.split(/\r?\n/),f=Math.max(0,l.line-1),m=/^(\s*)state\b/,p=-1,g="";for(let x=f;x>=0;x--){let T=m.exec(u[x]||"");if(T){p=x,g=T[1]||"";break}}if(p===-1){let x=jr(u[f]||"");n.push(Ie(t,{line:f+1,column:1},`${x}}
`));continue}let E=u.length;for(let x=p+1;x<u.length;x++){let T=u[x]||"";if(T.trim()==="")continue;if(jr(T).length<=g.length){E=x;break}}n.push(Ie(t,{line:E+1,column:1},`${g}}
`));continue}if(z("CL-REL-INVALID",l)){let f=be(t,l.line).indexOf("->");f>=0&&n.push({start:{line:l.line,column:f+1},end:{line:l.line,column:f+3},newText:"--"});continue}if(z("CL-BLOCK-MISSING-RBRACE",l)){let u=t.split(/\r?\n/),f=Math.max(0,l.line-1),m=/^(\s*)class\b.*\{\s*$/,p=-1,g="";for(let x=f;x>=0;x--){let T=m.exec(u[x]||"");if(T){p=x,g=T[1]||"";break}}if(p===-1){let x=jr(u[f]||"");n.push(Ie(t,{line:f+1,column:1},`${x}}
`));continue}let E=u.length;for(let x=p+1;x<u.length;x++){let T=u[x]||"";if(T.trim()==="")continue;if(jr(T).length<=g.length){E=x;break}}n.push(Ie(t,{line:E+1,column:1},`${g}}
`));continue}if(z("CL-LABEL-DOUBLE-IN-DOUBLE",l)){let u=be(t,l.line),f=u.indexOf('"');if(f!==-1){let m=u.indexOf(" as ",f+1),p=m!==-1?u.lastIndexOf('"',m-1):u.lastIndexOf('"');if(p>f){let g=u.slice(f+1,p),E=g.split("&quot;").join("\0").split('"').join("&quot;").split("\0").join("&quot;");E!==g&&n.push({start:{line:l.line,column:f+2},end:{line:l.line,column:p+1},newText:E})}}else n.push(Ze(t,ut(l),l.length??1,"&quot;"));continue}if(z("FL-STRICT-LABEL-QUOTES-REQUIRED",l)){if(r==="all"){let u=be(t,l.line),f=Math.max(0,l.column-1),m=u.slice(0,f),p=u.slice(f),g=Math.max(m.lastIndexOf("["),m.lastIndexOf("("),m.lastIndexOf("{"));if(g>=0){let E=m[g],x=E==="["?"]":E==="("?")":"}",T=u.indexOf(x,f);T>g&&(n.push(Ie(t,{line:l.line,column:g+2},'"')),n.push(Ie(t,{line:l.line,column:T+1},'"')))}}continue}}}let a=[],c=new Set;for(let l of n){let h=`${l.start.line}:${l.start.column}:${l.end?.line??0}:${l.end?.column??0}:${l.newText}`;c.has(h)||(c.add(h),a.push(l))}return a}var ul=class{constructor(){this.nodes=new Map,this.edges=[],this.nodeCounter=0,this.edgeCounter=0,this.subgraphs=[],this.currentSubgraphStack=[],this.classStyles=new Map,this.nodeStyles=new Map,this.nodeClasses=new Map}build(e){if(this.reset(),!e||!e.children)return{nodes:[],edges:[],direction:"TD",subgraphs:[]};let r=this.extractDirection(e);return this.processStatements(e),{nodes:Array.from(this.nodes.values()),edges:this.edges,direction:r,subgraphs:this.subgraphs}}reset(){this.nodes.clear(),this.edges=[],this.nodeCounter=0,this.edgeCounter=0,this.subgraphs=[],this.currentSubgraphStack=[],this.classStyles.clear(),this.nodeStyles.clear(),this.nodeClasses.clear()}extractDirection(e){switch(e.children?.Direction?.[0]?.image?.toUpperCase()){case"TB":case"TD":return"TD";case"BT":return"BT";case"LR":return"LR";case"RL":return"RL";default:return"TD"}}processStatements(e){let r=e.children?.statement;if(r)for(let n of r)n.children?.nodeStatement?this.processNodeStatement(n.children.nodeStatement[0]):n.children?.subgraph?this.processSubgraph(n.children.subgraph[0]):n.children?.classDefStatement?this.processClassDef(n.children.classDefStatement[0]):n.children?.classStatement?this.processClassAssign(n.children.classStatement[0]):n.children?.styleStatement&&this.processStyle(n.children.styleStatement[0])}processNodeStatement(e){let r=e.children?.nodeOrParallelGroup,n=e.children?.link;if(!r||r.length===0)return;let i=this.processNodeGroup(r[0]);if(r.length>1&&n&&n.length>0){let o=this.processNodeGroup(r[1]),s=this.extractLinkInfo(n[0]);for(let a of i)for(let c of o)this.edges.push({id:`e${this.edgeCounter++}`,source:a,target:c,label:s.label,type:s.type,markerStart:s.markerStart,markerEnd:s.markerEnd});for(let a=2;a<r.length;a++){let c=this.processNodeGroup(r[a]),l=n[a-1]?this.extractLinkInfo(n[a-1]):s;for(let h of o)for(let u of c)this.edges.push({id:`e${this.edgeCounter++}`,source:h,target:u,label:l.label,type:l.type,markerStart:l.markerStart,markerEnd:l.markerEnd});o.length=0,o.push(...c)}}}processNodeGroup(e){let r=e.children?.node;if(!r)return[];let n=[];for(let i of r){let o=this.extractNodeInfo(i);if(o){if(!this.subgraphs.some(a=>a.id===o.id)){if(!this.nodes.has(o.id))o.style=this.computeNodeStyle(o.id),this.nodes.set(o.id,o);else{let a=this.nodes.get(o.id);(o.shape!=="rectangle"||o.label!==o.id)&&(o.label!==o.id&&(a.label=o.label),o.shape!=="rectangle"&&(a.shape=o.shape));let c=this.computeNodeStyle(o.id);Object.keys(c).length&&(a.style={...a.style||{},...c})}if(this.currentSubgraphStack.length)for(let a of this.currentSubgraphStack){let c=this.subgraphs.find(l=>l.id===a);c&&!c.nodes.includes(o.id)&&c.nodes.push(o.id)}}n.push(o.id)}}return n}extractNodeInfo(e){let r=e.children;if(!r)return null;let n;if(r.nodeId)n=r.nodeId[0].image,r.nodeIdSuffix&&(n+=r.nodeIdSuffix[0].image);else if(r.nodeIdNum)n=r.nodeIdNum[0].image;else if(r.Identifier)n=r.Identifier[0].image;else return null;let i="rectangle",o=n,s=r.nodeShape?.[0];if(s?.children){let c=this.extractShapeAndLabel(s);i=c.shape,c.label&&(o=c.label)}let a=r.nodeClass?.[0];if(a){let c=this.nodeClasses.get(n)||new Set;c.add(a.image),this.nodeClasses.set(n,c)}return{id:n,label:o,shape:i}}extractShapeAndLabel(e){let r=e.children,n="rectangle",i="",o=r?.nodeContent;if(o&&o.length>0&&(i=this.extractTextContent(o[0])),r?.SquareOpen){n="rectangle";let s=r.nodeContent?.[0];if(s){let a=s.children,c=["ForwardSlash","Backslash","Identifier","Text","NumberLiteral","RoundOpen","RoundClose","AngleLess","AngleOpen","Comma","Colon","Ampersand","Semicolon","TwoDashes","Line","ThickLine","DottedLine"],l=[];for(let h of c)a[h]?.forEach(f=>l.push({type:h,t:f,start:f.startOffset??0}));if(l.length>=2){l.sort((f,m)=>f.start-m.start);let h=l[0].type,u=l[l.length-1].type;h==="ForwardSlash"&&u==="ForwardSlash"||h==="Backslash"&&u==="Backslash"?n="parallelogram":h==="ForwardSlash"&&u==="Backslash"?n="trapezoid":h==="Backslash"&&u==="ForwardSlash"&&(n="trapezoidAlt")}}}else r?.RoundOpen?n="round":r?.DiamondOpen?n="diamond":r?.DoubleRoundOpen?n="circle":r?.StadiumOpen?n="stadium":r?.HexagonOpen?n="hexagon":r?.DoubleSquareOpen?n="subroutine":r?.CylinderOpen?n="cylinder":r?.TrapezoidOpen?n="trapezoid":r?.ParallelogramOpen&&(n="parallelogram");return{shape:n,label:i}}extractTextContent(e){let r=e.children;if(!r)return"";let n=["Text","Identifier","QuotedString","NumberLiteral","Ampersand","Comma","Colon","Semicolon","Dot","Underscore","Dash","ForwardSlash","Backslash","AngleLess","AngleOpen"],i=[];for(let s of n){let a=r[s];if(a)for(let c of a){let l=c.image;s==="QuotedString"&&l.startsWith('"')&&l.endsWith('"')&&(l=l.slice(1,-1)),!((s==="ForwardSlash"||s==="Backslash")&&i.length===0)&&i.push({text:l,startOffset:c.startOffset??0,type:s})}}if(i.sort((s,a)=>s.startOffset-a.startOffset),i.length){let s=i[0];(s.type==="ForwardSlash"||s.type==="Backslash")&&i.shift();let a=i[i.length-1];(a.type==="ForwardSlash"||a.type==="Backslash")&&i.pop()}let o=i.map(s=>s.text);return r.Space?o.join(""):o.join(" ").trim()}extractLinkInfo(e){let r=e.children,n="arrow",i,o="none",s="none";r.BiDirectionalArrow?(n="arrow",o="arrow",s="arrow"):r.CircleEndLine?(n="open",o="circle",s="circle"):r.CrossEndLine?(n="open",o="cross",s="cross"):r?.ArrowRight?(n="arrow",s="arrow"):r?.ArrowLeft?(n="arrow",o="arrow"):r?.DottedArrowRight?(n="dotted",s="arrow"):r?.DottedArrowLeft?(n="dotted",o="arrow"):r?.ThickArrowRight?(n="thick",s="arrow"):r?.ThickArrowLeft?(n="thick",o="arrow"):r?.LinkRight||r?.LinkLeft||r?.Line||r?.TwoDashes||r?.DottedLine||r?.ThickLine?r?.DottedLine?n="dotted":r?.ThickLine?n="thick":n="open":r?.InvisibleLink&&(n="invisible"),s==="none"&&(r?.ArrowRight||r.ThickArrowRight||r.DottedArrowRight)&&(s="arrow"),o==="none"&&(r?.ArrowLeft||r.ThickArrowLeft||r.DottedArrowLeft)&&(o="arrow");let a=r?.linkText?.[0];if(a)i=this.extractTextContent(a);else if(r.linkTextInline?.[0])i=this.extractTextContent(r.linkTextInline[0]);else if(r.inlineCarrier?.[0]){let l=r.inlineCarrier[0].image.trim();l.startsWith("-.")&&l.endsWith(".-")?n="dotted":l.startsWith("==")&&l.endsWith("==")?n="thick":l.startsWith("--")&&l.endsWith("--"),(r.ArrowRight||r.DottedArrowRight||r.ThickArrowRight)&&(s="arrow"),(r.ArrowLeft||r.DottedArrowLeft||r.ThickArrowLeft)&&(o="arrow"),i=(u=>u.startsWith("-.")&&u.endsWith(".-")||u.startsWith("==")&&u.endsWith("==")||u.startsWith("--")&&u.endsWith("--")?u.slice(2,-2).trim():u)(l)}return{type:n,label:i,markerStart:o,markerEnd:s}}processSubgraph(e){let r=e.children,n=`subgraph_${this.subgraphs.length}`,i,o=r?.subgraphId?.[0]||r?.Identifier?.[0];if(o&&(n=o.image),r?.SquareOpen&&r?.nodeContent)i=this.extractTextContent(r.nodeContent[0]);else if(r.subgraphTitleQ?.[0]){let h=r.subgraphTitleQ[0].image;i=h&&h.length>=2&&(h.startsWith('"')||h.startsWith("'"))?h.slice(1,-1):h}else r?.subgraphLabel&&(i=this.extractTextContent(r.subgraphLabel[0]));!i&&n!==`subgraph_${this.subgraphs.length}`&&(i=n);let s=this.currentSubgraphStack.length?this.currentSubgraphStack[this.currentSubgraphStack.length-1]:void 0,a={id:n,label:i,nodes:[],parent:s};this.subgraphs.push(a),this.currentSubgraphStack.push(n);let c=r?.subgraphStatement;if(c)for(let l of c)l.children?.nodeStatement?this.processNodeStatement(l.children.nodeStatement[0]):l.children?.subgraph&&this.processSubgraph(l.children.subgraph[0]);this.currentSubgraphStack.pop()}processClassDef(e){let r=e.children?.Identifier?.[0];if(!r)return;let n=r.image,i=this.collectStyleProps(e,{skipFirstIdentifier:!0});if(Object.keys(i).length){this.classStyles.set(n,i);for(let[o,s]of this.nodeClasses.entries())if(s.has(n)){let a=this.nodes.get(o);a&&(a.style={...a.style||{},...this.computeNodeStyle(o)})}}}processClassAssign(e){let r=e.children?.Identifier||[];if(!r.length)return;let n=e.children.className?.[0],i=n?.image||r[r.length-1].image,o=r.slice(0,-1);for(let s of o){let a=s.image,c=this.nodeClasses.get(a)||new Set;c.add(i),this.nodeClasses.set(a,c);let l=this.nodes.get(a);l&&(l.style={...l.style||{},...this.computeNodeStyle(a)})}}processStyle(e){let r=e.children?.Identifier?.[0];if(!r)return;let n=r.image,i=this.collectStyleProps(e,{skipFirstIdentifier:!0});if(Object.keys(i).length){this.nodeStyles.set(n,i);let o=this.nodes.get(n);o&&(o.style={...o.style||{},...this.computeNodeStyle(n)})}}collectStyleProps(e,r={}){let n=[],i=e.children||{},o=(c,l="t")=>c?.forEach(h=>n.push({text:h.image,startOffset:h.startOffset??0,type:l}));if(o(i.Text,"Text"),o(i.Identifier,"Identifier"),o(i.ColorValue,"Color"),o(i.Colon,"Colon"),o(i.Comma,"Comma"),o(i.NumberLiteral,"Number"),n.sort((c,l)=>c.startOffset-l.startOffset),r.skipFirstIdentifier){let c=n.findIndex(l=>l.type==="Identifier");c>=0&&n.splice(c,1)}let s=n.map(c=>c.text).join(""),a={};for(let c of s.split(",").map(l=>l.trim()).filter(Boolean)){let[l,h]=c.split(":");l&&h&&(a[l.trim()]=h.trim())}return a}computeNodeStyle(e){let r={},n=this.nodeClasses.get(e);if(n)for(let o of n){let s=this.classStyles.get(o);s&&Object.assign(r,this.normalizeStyle(s))}let i=this.nodeStyles.get(e);return i&&Object.assign(r,this.normalizeStyle(i)),r}normalizeStyle(e){let r={};for(let[n,i]of Object.entries(e)){let o=n.trim().toLowerCase(),s=i.trim();if(o==="stroke-width"){let a=parseFloat(s);Number.isNaN(a)||(r.strokeWidth=a)}else o==="stroke"?r.stroke=s:o==="fill"&&(r.fill=s)}return r}};var Zf=EI(WC(),1),Yo=class{constructor(){this.nodeWidth=120,this.nodeHeight=50,this.rankSep=50,this.nodeSep=50,this.edgeSep=10}layout(e){let r=new Zf.default.graphlib.Graph,n=!!(e.subgraphs&&e.subgraphs.length>0),i=this.mapDirection(e.direction),o=this.rankSep,s=this.nodeSep;n&&(i==="LR"||i==="RL"?(o+=20,s+=70):(o+=70,s+=20));let a={rankdir:i,ranksep:o,nodesep:s,edgesep:this.edgeSep,marginx:20,marginy:20};if(n&&(i==="LR"||i==="RL")&&(a.ranker="longest-path",a.acyclicer="greedy"),n&&(a.compound=!0),r.setGraph(a),r.setDefaultEdgeLabel(()=>({})),e.subgraphs&&e.subgraphs.length>0)for(let x of e.subgraphs)r.setNode(x.id,{label:x.label||x.id,clusterLabelPos:"top"});for(let x of e.nodes){let T=this.calculateNodeDimensions(x.label,x.shape);r.setNode(x.id,{width:T.width,height:T.height,label:x.label,shape:x.shape})}if(e.subgraphs&&e.subgraphs.length>0)for(let x of e.subgraphs){for(let T of x.nodes)if(r.hasNode(T))try{r.setParent(T,x.id)}catch{}if(x.parent&&r.hasNode(x.parent))try{r.setParent(x.id,x.parent)}catch{}}for(let x of e.edges)r.setEdge(x.source,x.target,{label:x.label,width:x.label?x.label.length*8:0,height:x.label?20:0});Zf.default.layout(r);let c=r.graph(),l=[],h=[];for(let x of e.nodes){let T=r.node(x.id);T&&l.push({...x,x:T.x-T.width/2,y:T.y-T.height/2,width:T.width,height:T.height})}let u=[];if(e.subgraphs&&e.subgraphs.length>0){for(let T of e.subgraphs){let y=l.filter(O=>T.nodes.includes(O.id));if(y.length){let O=Math.min(...y.map(P=>P.x)),A=Math.min(...y.map(P=>P.y)),L=Math.max(...y.map(P=>P.x+P.width)),b=Math.max(...y.map(P=>P.y+P.height)),v=30;u.push({id:T.id,label:T.label||T.id,x:O-v,y:A-v-18,width:L-O+v*2,height:b-A+v*2+18,parent:T.parent})}}let x=Object.fromEntries(u.map(T=>[T.id,T]));for(let T of u){if(!T.parent)continue;let y=x[T.parent];if(!y)continue;let O=Math.min(y.x,T.x),A=Math.min(y.y,T.y),L=Math.max(y.x+y.width,T.x+T.width),b=Math.max(y.y+y.height,T.y+T.height);y.x=O,y.y=A,y.width=L-O,y.height=b-A}}let f=Object.fromEntries(u.map(x=>[x.id,x]));for(let x of e.edges){let T=r.edge(x.source,x.target),y=T&&Array.isArray(T.points)?T.points.slice():[],O=y.some(v=>!Number.isFinite(v.x)||!Number.isFinite(v.y)),A=f[x.source],L=f[x.target],b=!1;if(!y.length||O||A||L){let v=this.mapDirection(e.direction),P=U=>{let w=r.node(U);if(w)return{id:U,label:w.label||U,shape:w.shape||"rectangle",x:w.x-w.width/2,y:w.y-w.height/2,width:w.width,height:w.height,style:{}}},M=A?this.clusterAnchor(A,v,"out"):this.nodeAnchor(P(x.source),v,"out"),k=L?this.clusterAnchor(L,v,"in"):this.nodeAnchor(P(x.target),v,"in");if(M&&k){let V=A&&L&&Math.abs(A.x-L.x)>Math.abs(A.y-L.y);if(v==="LR"||v==="RL"){let X=M.x+(v==="LR"?20:-20),re=k.x+(v==="LR"?-20:20),j={x:A?X:M.x,y:M.y},Z={x:L?re:k.x,y:k.y},Ue=j.x+(Z.x-j.x)*.68,Pe={x:Ue,y:j.y},He={x:Ue,y:Z.y};y=L?[M,j,Pe,He,Z]:[M,j,Pe,He,Z,k]}else if(V&&A&&L){let X=(A.y+A.height/2+L.y+L.height/2)/2;if(A.x<L.x){let re=A.x+A.width,j=L.x;y=[{x:re,y:X},{x:j,y:X}]}else{let re=A.x,j=L.x+L.width;y=[{x:re,y:X},{x:j,y:X}]}}else{let X=M.y+(v==="TD"?20:-20),re=k.y+(v==="TD"?-20:20),j={x:M.x,y:A?X:M.y},Z={x:k.x,y:L?re:k.y},Ue=j.y+(Z.y-j.y)*.68,Pe={x:j.x,y:Ue},He={x:Z.x,y:Ue};y=L?[M,j,Pe,He,Z]:[M,j,Pe,He,Z,k]}b=!0}}y.length&&h.push({...x,points:y,pathMode:b?"orthogonal":"smooth"})}let m=c.width,p=c.height,g=Number.isFinite(m)&&m>0?m:800,E=Number.isFinite(p)&&p>0?p:600;return{nodes:l,edges:h,width:g,height:E,subgraphs:u}}mapDirection(e){switch(e){case"TB":case"TD":return"TB";case"BT":return"BT";case"LR":return"LR";case"RL":return"RL";default:return"TB"}}calculateNodeDimensions(e,r){let l=e.split(/<\s*br\s*\/?\s*>/i),h=l.length>1,u,f;if(h){let p=Math.max(...l.map(g=>g.length));u=Math.min(Math.max(p*7+40,80),240),f=l.length}else{u=Math.min(Math.max(e.length*7+40,80),240);let p=Math.max(1,Math.floor((u-40)/7));f=Math.ceil(e.length/p)}let m=Math.max(f*18+20,40);switch(r){case"circle":let p=Math.max(u,m);u=p,m=p;break;case"diamond":{let g=Math.max(u,m)*1.2;u=g,m=g;break}case"hexagon":u*=1.3,m*=1.2;break;case"stadium":u*=1.2;break;case"cylinder":m*=1.5;break;case"subroutine":case"double":u+=10,m+=10;break;case"parallelogram":case"trapezoid":u*=1.3;break}return{width:Math.round(u),height:Math.round(m)}}clusterAnchor(e,r,n){switch(r){case"LR":return{x:n==="out"?e.x+e.width:e.x,y:e.y+e.height/2};case"RL":return{x:n==="out"?e.x:e.x+e.width,y:e.y+e.height/2};case"BT":return{x:e.x+e.width/2,y:n==="out"?e.y:e.y+e.height};case"TB":default:return{x:e.x+e.width/2,y:n==="out"?e.y+e.height:e.y}}}nodeAnchor(e,r,n){if(!e)return{x:0,y:0};switch(r){case"LR":return{x:n==="in"?e.x:e.x+e.width,y:e.y+e.height/2};case"RL":return{x:n==="in"?e.x+e.width:e.x,y:e.y+e.height/2};case"BT":return{x:e.x+e.width/2,y:n==="in"?e.y+e.height:e.y};case"TB":default:return{x:e.x+e.width/2,y:n==="in"?e.y:e.y+e.height}}}};var Xo=class{constructor(){this.padding=20,this.fontSize=14,this.fontFamily="Arial, sans-serif",this.defaultStroke="#3f3f3f",this.defaultFill="#eef0ff",this.arrowStroke="#555555",this.arrowMarkerSize=9}render(e){let r=1/0,n=1/0,i=-1/0,o=-1/0;for(let y of e.nodes)r=Math.min(r,y.x),n=Math.min(n,y.y),i=Math.max(i,y.x+y.width),o=Math.max(o,y.y+y.height);if(e.subgraphs)for(let y of e.subgraphs)r=Math.min(r,y.x),n=Math.min(n,y.y),i=Math.max(i,y.x+y.width),o=Math.max(o,y.y+y.height);for(let y of e.edges)if(y.points)for(let O of y.points)r=Math.min(r,O.x),n=Math.min(n,O.y),i=Math.max(i,O.x),o=Math.max(o,O.y);isFinite(r)||(r=0),isFinite(n)||(n=0),isFinite(i)||(i=e.width),isFinite(o)||(o=e.height);let s=Math.max(0,-Math.floor(r)+1),a=Math.max(0,-Math.floor(n)+1),c=this.padding+s,l=this.padding+a,h=Math.ceil(i)-Math.min(0,Math.floor(r)),u=Math.ceil(o)-Math.min(0,Math.floor(n)),f=h+this.padding*2+s,m=u+this.padding*2+a,p=[],g=[];if(p.push(this.generateDefs()),e.subgraphs&&e.subgraphs.length){let O=e.subgraphs.slice().sort((w,V)=>(w.parent?1:0)-(V.parent?1:0)),A=[],L=[],b=[],v=[],P=w=>{let V=0,X=w.parent,re=new Map(O.map(j=>[j.id,j]));for(;X;)V++,X=re.get(X)?.parent;return V};for(let w of O){let V=w.x+c,X=w.y+l,re=w.width,j=w.height;if(A.push(`<rect class="cluster-bg" x="${V}" y="${X}" width="${re}" height="${j}" rx="4" ry="4" />`),L.push(`<rect class="cluster-border" x="${V}" y="${X}" width="${re}" height="${j}" rx="4" ry="4" />`),w.label){let Z=P(w),_t=18+Z*12,Ue=this.escapeXml(w.label),Pe=Math.max(40,Math.min(220,Ue.length*7+12)),He=V+re/2-Pe/2,Ft=X+_t-10;b.push(`<rect class="cluster-title-bg" x="${He}" y="${Ft}" width="${Pe}" height="16" rx="3" ry="3" />`),v.push({depth:Z,svg:`<text class="cluster-label-text" x="${V+re/2}" y="${X+_t}" text-anchor="middle">${Ue}</text>`})}}p.push(`<g class="subgraph-bg">${A.join("")}</g>`);let M=`<g class="subgraph-borders">${L.join("")}</g>`,k=`<g class="subgraph-title-bg">${b.join("")}</g>`,U=`<g class="subgraph-titles">${v.sort((w,V)=>w.depth-V.depth).map(w=>w.svg).join("")}</g>`;g.push(M),g.push(k),g.push(U)}let E={};for(let y of e.nodes)E[y.id]={x:y.x+c,y:y.y+l,width:y.width,height:y.height,shape:y.shape};if(e.subgraphs&&e.subgraphs.length)for(let y of e.subgraphs)E[y.id]={x:y.x+c,y:y.y+l,width:y.width,height:y.height,shape:"rectangle"};for(let y of e.nodes)p.push(this.generateNodeWithPad(y,c,l));for(let y of e.edges){let{path:O,overlay:A}=this.generateEdge(y,c,l,E);p.push(O),A&&g.push(A)}let x=`<rect x="0" y="0" width="${f}" height="${m}" fill="#ffffff" />`,T=`<style>
      .node-shape { fill: ${this.defaultFill}; stroke: ${this.defaultStroke}; stroke-width: 1px; }
      .node-label { fill: #333; font-family: ${this.fontFamily}; font-size: ${this.fontSize}px; }
      .edge-path { stroke: ${this.arrowStroke}; stroke-width: 2px; fill: none; }
      .edge-label-bg { fill: rgba(232,232,232, 0.8); opacity: 0.5; }
      .edge-label-text { fill: #333; font-family: ${this.fontFamily}; font-size: ${Math.max(10,this.fontSize-2)}px; }
      /* Subgraph (cluster) styling */
      .cluster-bg { fill: #ffffde; }
      .cluster-border { fill: none; stroke: #aaaa33; stroke-width: 1px; }
      .cluster-title-bg { fill: rgba(255,255,255,0.8); }
      .cluster-label-text { fill: #333; font-family: ${this.fontFamily}; font-size: 12px; }
    </style>`;return`<svg xmlns="http://www.w3.org/2000/svg" width="${f}" height="${m}" viewBox="0 0 ${f} ${m}">
  ${x}
  ${T}
  ${p.join(`
  `)}
  ${g.join(`
  `)}
</svg>`}buildNodeStyleAttrs(e){let r=[];return e.fill&&r.push(`fill:${e.fill}`),e.stroke&&r.push(`stroke:${e.stroke}`),e.strokeWidth!=null&&r.push(`stroke-width:${e.strokeWidth}`),r.length?`style="${r.join(";")}"`:""}buildNodeStrokeStyle(e){let r=[];return e.stroke&&r.push(`stroke:${e.stroke}`),e.strokeWidth!=null&&r.push(`stroke-width:${e.strokeWidth}`),r.length?`style="${r.join(";")}"`:""}generateDefs(){let e=Math.max(8,this.arrowMarkerSize+2),r=Math.max(8,this.arrowMarkerSize+2),n=Math.max(6,e),i=Math.max(4,Math.round(r/2));return`<defs>
    <marker id="arrow" viewBox="0 0 ${e} ${r}" markerWidth="${e}" markerHeight="${r}" refX="${n}" refY="${i}" orient="auto" markerUnits="userSpaceOnUse">
      <path d="M0,0 L0,${r} L${e},${i} z" fill="${this.arrowStroke}" />
    </marker>
    <marker id="circle-marker" viewBox="0 0 9 9" markerWidth="9" markerHeight="9" refX="4.5" refY="4.5" orient="auto" markerUnits="userSpaceOnUse">
      <circle cx="4.5" cy="4.5" r="4.5" fill="${this.arrowStroke}" />
    </marker>
    <marker id="cross-marker" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" refX="6" refY="6" orient="auto" markerUnits="userSpaceOnUse">
      <path d="M1.5,1.5 L10.5,10.5 M10.5,1.5 L1.5,10.5" stroke="${this.arrowStroke}" stroke-width="2.25" />
    </marker>
  </defs>`}generateNodeWithPad(e,r,n){let i=e.x+r,o=e.y+n,s=i+e.width/2,a=o+e.height/2,c="",l=a,h=e.style?.strokeWidth??void 0,u=e.style?.stroke??void 0,f=e.style?.fill??void 0,m=this.buildNodeStyleAttrs({stroke:u,strokeWidth:h,fill:f});switch(e.shape){case"rectangle":c=`<rect class="node-shape" ${m} x="${i}" y="${o}" width="${e.width}" height="${e.height}" rx="0" ry="0" />`;break;case"round":c=`<rect class="node-shape" ${m} x="${i}" y="${o}" width="${e.width}" height="${e.height}" rx="5" ry="5" />`;break;case"stadium":let g=e.height/2;c=`<rect class="node-shape" ${m} x="${i}" y="${o}" width="${e.width}" height="${e.height}" rx="${g}" ry="${g}" />`;break;case"circle":let E=Math.min(e.width,e.height)/2;c=`<circle class="node-shape" ${m} cx="${s}" cy="${a}" r="${E}" />`;break;case"diamond":{let L=[`${s},${o}`,`${i+e.width},${a}`,`${s},${o+e.height}`,`${i},${a}`].join(" ");c=`<polygon class="node-shape" ${m} points="${L}" />`;break}case"hexagon":{let L=e.width*.25,b=[`${i+L},${o}`,`${i+e.width-L},${o}`,`${i+e.width},${a}`,`${i+e.width-L},${o+e.height}`,`${i+L},${o+e.height}`,`${i},${a}`].join(" ");c=`<polygon class="node-shape" ${m} points="${b}" />`;break}case"parallelogram":{let L=e.width*.15,b=[`${i+L},${o}`,`${i+e.width},${o}`,`${i+e.width-L},${o+e.height}`,`${i},${o+e.height}`].join(" ");c=`<polygon class="node-shape" ${m} points="${b}" />`;break}case"trapezoid":{let L=e.width*.15,b=[`${i+L},${o}`,`${i+e.width-L},${o}`,`${i+e.width},${o+e.height}`,`${i},${o+e.height}`].join(" ");c=`<polygon class="node-shape" ${m} points="${b}" />`;break}case"trapezoidAlt":{let L=e.width*.15,b=[`${i},${o}`,`${i+e.width},${o}`,`${i+e.width-L},${o+e.height}`,`${i+L},${o+e.height}`].join(" ");c=`<polygon class="node-shape" ${m} points="${b}" />`;break}case"cylinder":{let L=Math.max(8,e.width/2),b=Math.max(6,Math.min(e.height*.22,e.width*.25)),v=o+b,P=o+e.height-b,M=Math.max(0,e.height-b*2),k=this.buildNodeStrokeStyle({stroke:u,strokeWidth:h});c=`<g>
          <rect class="node-shape" ${m} x="${i}" y="${v}" width="${e.width}" height="${M}" />
          <ellipse class="node-shape" ${m} cx="${s}" cy="${v}" rx="${e.width/2}" ry="${b}" />
          <path class="node-shape" ${k} d="M${i},${v} L${i},${P} A${e.width/2},${b} 0 0,0 ${i+e.width},${P} L${i+e.width},${v}" fill="none" />
        </g>`,l=v+M/2;break}case"subroutine":let x=5,T=this.buildNodeStrokeStyle({stroke:u,strokeWidth:h});c=`<g>
          <rect class="node-shape" ${m} x="${i}" y="${o}" width="${e.width}" height="${e.height}" rx="0" ry="0" />
          <line class="node-shape" ${T} x1="${i+x}" y1="${o}" x2="${i+x}" y2="${o+e.height}" />
          <line class="node-shape" ${T} x1="${i+e.width-x}" y1="${o}" x2="${i+e.width-x}" y2="${o+e.height}" />
        </g>`;break;case"double":let y=4,O=this.buildNodeStrokeStyle({stroke:u,strokeWidth:h});c=`<g>
          <rect class="node-shape" ${m} x="${i}" y="${o}" width="${e.width}" height="${e.height}" rx="0" ry="0" />
          <rect class="node-shape" ${O} x="${i+y}" y="${o+y}" width="${e.width-y*2}" height="${e.height-y*2}" rx="0" ry="0" fill="none" />
        </g>`;break;default:c=`<rect ${this.buildNodeStyleAttrs({stroke:u,strokeWidth:h,fill:f})} x="${i}" y="${o}" width="${e.width}" height="${e.height}" rx="0" ry="0" />`}let p=this.generateWrappedText(e.label,s,l,e.width-20);return`<g id="${e.id}">
    ${c}
    ${p}
  </g>`}generateWrappedText(e,r,n,i){if(e.includes("<"))return this.generateRichText(e,r,n,i);let s=Math.floor(i/7);if(s<=0||e.length<=s){let p=this.fontSize*.35;return`<text class="node-label" x="${r}" y="${n+p}" text-anchor="middle">${this.escapeXml(e)}</text>`}let a=e.split(" "),c=[],l="";for(let p of a){let g=l?`${l} ${p}`:p;g.length>s&&l?(c.push(l),l=p):l=g}l&&c.push(l);let h=18,u=(c.length-1)*h,f=n-u/2+this.fontSize*.35;return`<text class="node-label">
    ${c.map((p,g)=>{let E=f+g*h;return`<tspan x="${r}" y="${E}" text-anchor="middle">${this.escapeXml(p)}</tspan>`}).join(`
    `)}
  </text>`}generateRichText(e,r,n,i){e=this.normalizeHtml(e);let o=[],s=/<\/?(br|b|strong|i|em|u)\s*\/?\s*>/gi,a=0,c={bold:!1,italic:!1,underline:!1},l=L=>{L&&o.push({text:this.htmlDecode(L),bold:c.bold,italic:c.italic,underline:c.underline})},h;for(;h=s.exec(e);){l(e.slice(a,h.index));let L=h[0].toLowerCase(),b=h[1].toLowerCase(),v=L.startsWith("</");b==="br"?o.push({text:"",br:!0}):b==="b"||b==="strong"?c.bold=!v:b==="i"||b==="em"?c.italic=!v:b==="u"&&(c.underline=!v),a=s.lastIndex}l(e.slice(a));let u=[],m=Math.max(1,Math.floor(i/7)),p=[],g=0,E=()=>{p.length&&(u.push(p),p=[],g=0)},x=L=>L.text?L.text.split(/(\s+)/).map(v=>({...L,text:v})):[L];for(let L of o){if(L.br){E();continue}for(let b of x(L)){let v=b.text.length;g+v>m&&g>0&&E(),p.push(b),g+=v}}E();let T=18,y=(u.length-1)*T,O=n-y/2+this.fontSize*.35,A=[];for(let L=0;L<u.length;L++){let b=O+L*T,v="",P=r,M=[],k="",U={bold:!1,italic:!1,underline:!1},w=()=>{if(!k)return;let V=`${U.bold?'font-weight="bold" ':""}${U.italic?'font-style="italic" ':""}${U.underline?'text-decoration="underline" ':""}`;M.push(`<tspan ${V}>${this.escapeXml(k)}</tspan>`),k=""};for(let V of u[L]){let X={bold:!!V.bold,italic:!!V.italic,underline:!!V.underline};(X.bold!==U.bold||X.italic!==U.italic||X.underline!==U.underline)&&(w(),U=X),k+=V.text}w(),A.push(`<tspan x="${r}" y="${b}" text-anchor="middle">${M.join("")}</tspan>`)}return`<text font-family="${this.fontFamily}" font-size="${this.fontSize}" fill="#333">${A.join(`
    `)}</text>`}normalizeHtml(e){return e.replace(/<\s+/g,"<").replace(/\s+>/g,">").replace(/<\s*\//g,"</").replace(/\s*\/\s*>/g,"/>").replace(/<\s*(br)\s*>/gi,"<$1/>")}htmlDecode(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'")}generateEdge(e,r,n,i){if(!e.points||e.points.length<2)return{path:""};let o=e.points.map(q=>({x:q.x+r,y:q.y+n})),s=this.buildSmoothSegments(o),a="",c=1.5,l="",h="";switch(e.type){case"open":l="";break;case"dotted":a="3,3";break;case"thick":c=3;break;case"invisible":a="0,100000",l="";break}let u=e.markerStart,f=e.markerEnd,m=i[e.source],p=i[e.target],g=o[0],E=o[o.length-1];if(m&&o.length>=2){let q={start:o[0],segs:[{c1:o[1],c2:o[Math.max(0,o.length-2)],to:o[o.length-1]}]};g=this.intersectSegmentsStart(q,m).start}if(p&&o.length>=2){let q={start:o[0],segs:[{c1:o[1],c2:o[Math.max(0,o.length-2)],to:o[o.length-1]}]},W=this.intersectSegmentsEnd(q,p);E=W.segs.length?W.segs[W.segs.length-1].to:E}let x=[];x.push(`M${g.x},${g.y}`);let T=o.length>=2?o[1]:g;if(o.length>=2){let q=o[1].x-g.x,W=o[1].y-g.y,ne=Math.hypot(q,W)||1,ge=Math.min(22,Math.max(10,ne*.15));T={x:g.x+q/ne*ge,y:g.y+W/ne*ge},x.push(`L${T.x},${T.y}`)}let y=e.pathMode==="orthogonal";if(o.length>=4&&!y){let q=[o[0],...o,o[o.length-1]];for(let W=1;W<q.length-3;W++){let ne=q[W-1],ge=q[W],xe=q[W+1],Ee=q[W+2],Ke=ge.x+(xe.x-ne.x)/6,nt=ge.y+(xe.y-ne.y)/6,At=xe.x-(Ee.x-ge.x)/6,ar=xe.y-(Ee.y-ge.y)/6;x.push(`C${Ke},${nt} ${At},${ar} ${xe.x},${xe.y}`)}x.push(`L${E.x},${E.y}`)}else if(o.length===3&&!y){let q=g,W=o[1],ne=E,ge=E.x-W.x,xe=E.y-W.y,Ee=Math.hypot(ge,xe)||1,Ke=Math.min(20,Math.max(10,Ee*.15)),nt={x:E.x-ge/Ee*Ke,y:E.y-xe/Ee*Ke},At=T.x-g.x,ar=T.y-g.y,lr=At===0&&ar===0?W.x-q.x:At,Sr=At===0&&ar===0?W.y-q.y:ar,Or=Math.hypot(lr,Sr)||1,Jr=Math.min(40,Math.max(12,Or*1.2)),On=T.x+lr/Or*Jr,An=T.y+Sr/Or*Jr,Qo=(E.x-W.x)/Ee,Zo=(E.y-W.y)/Ee,Jo=nt.x-Qo*(Ke*.6),Ln=nt.y-Zo*(Ke*.6);x.push(`C${On},${An} ${Jo},${Ln} ${nt.x},${nt.y}`),x.push(`L${E.x},${E.y}`)}else x.push(`L${E.x},${E.y}`);if(y){x.length=0,x.push(`M${g.x},${g.y}`);for(let q of o.slice(1,-1))x.push(`L${q.x},${q.y}`);x.push(`L${E.x},${E.y}`)}let A=`<path class="edge-path" d="${x.join(" ")}" stroke-linecap="round" stroke-linejoin="round"`;a&&(A+=` stroke-dasharray="${a}"`);let L=u==="arrow"?"url(#arrow)":u==="circle"?"url(#circle-marker)":u==="cross"?"url(#cross-marker)":"",b=f==="arrow"?"url(#arrow)":f==="circle"?"url(#circle-marker)":f==="cross"?"url(#cross-marker)":l||"";if(L&&u!=="arrow"&&(A+=` marker-start="${L}"`),b&&f!=="arrow"&&(A+=` marker-end="${b}"`),A+=" />",e.label){let q=this.pointAtRatio(o,.55),W=this.escapeXml(e.label),ne=4,ge=this.fontSize-3,xe=Math.max(18,Math.min(220,W.length*6+ne*2)),Ee=14,Ke=q.x-xe/2,nt=q.y-Ee/2,At=`<rect class="edge-label-bg" x="${Ke}" y="${nt}" width="${xe}" height="${Ee}" rx="3" />`,ar=`<text class="edge-label-text" x="${q.x}" y="${q.y}" text-anchor="middle" dominant-baseline="middle">${W}</text>`,lr="",Sr=o.length>=2?o[o.length-2]:E,Or=E.x-Sr.x,Jr=E.y-Sr.y,On=Math.hypot(Or,Jr)||1,An=Or/On,Qo=Jr/On,Zo=-Qo,Jo=An,Ln=8,Ar=6,JC=E.x,eI=E.y,id=E.x-An*Ln,od=E.y-Qo*Ln,tI=id+Zo*(Ar/2),rI=od+Jo*(Ar/2),nI=id-Zo*(Ar/2),iI=od-Jo*(Ar/2),oI=`<path d="M${JC},${eI} L${tI},${rI} L${nI},${iI} Z" fill="${this.arrowStroke}" />`;if(lr+=oI,u==="arrow"&&o.length>=2){let sd=o[1],ad=g.x-sd.x,ld=g.y-sd.y,cd=Math.hypot(ad,ld)||1,ud=ad/cd,hd=ld/cd,fd=-hd,dd=ud,pd=g.x-ud*Ln,md=g.y-hd*Ln,sI=g.x,aI=g.y,lI=pd+fd*(Ar/2),cI=md+dd*(Ar/2),uI=pd-fd*(Ar/2),hI=md-dd*(Ar/2);lr+=`<path d="M${sI},${aI} L${lI},${cI} L${uI},${hI} Z" fill="${this.arrowStroke}" />`}return{path:`<g>
    ${A}
    ${At}
    ${ar}
    ${lr}
  </g>`}}let v="",P=o.length>=2?o[o.length-2]:E,M=E.x-P.x,k=E.y-P.y,U=Math.hypot(M,k)||1,w=M/U,V=k/U,X=-V,re=w,j=8,Z=6,_t=E.x,Ue=E.y,Pe=E.x-w*j,He=E.y-V*j,Ft=Pe+X*(Z/2),Ot=He+re*(Z/2),Xe=Pe-X*(Z/2),Bt=He-re*(Z/2),ve=`<path d="M${_t},${Ue} L${Ft},${Ot} L${Xe},${Bt} Z" fill="${this.arrowStroke}" />`;if(f==="arrow"&&(v+=ve),u==="arrow"&&o.length>=2){let q=o[1],W=g.x-q.x,ne=g.y-q.y,ge=Math.hypot(W,ne)||1,xe=W/ge,Ee=ne/ge,Ke=-Ee,nt=xe,At=g.x-xe*j,ar=g.y-Ee*j,lr=g.x,Sr=g.y,Or=lr+Ke*(Z/2),Jr=Sr+nt*(Z/2),On=lr-Ke*(Z/2),An=Sr-nt*(Z/2);v+=`<path d="M${At},${ar} L${Or},${Jr} L${On},${An} Z" fill="${this.arrowStroke}" />`}return{path:A,overlay:v||void 0}}buildSmoothSegments(e){if(e.length<2)return{start:e[0]||{x:0,y:0},segs:[]};if(e.length===2){let l=e[0],h=e[1],u={x:l.x+(h.x-l.x)/3,y:l.y+(h.y-l.y)/3},f={x:l.x+2*(h.x-l.x)/3,y:l.y+2*(h.y-l.y)/3};return{start:l,segs:[{c1:u,c2:f,to:h}]}}let r=[e[0],...e,e[e.length-1]],n=[],i=1,o=r.length-3,s=1,a=.35,c=28;for(let l=1;l<r.length-2;l++){let h=r[l-1],u=r[l],f=r[l+1],m=r[l+2],p=l===i?a:s,g=l===o?a:s,E={x:u.x+(f.x-h.x)/6*p,y:u.y+(f.y-h.y)/6*p},x={x:f.x-(m.x-u.x)/6*g,y:f.y-(m.y-u.y)/6*g};if(l===i){let T=f.x-u.x,y=f.y-u.y,O=Math.hypot(T,y)||1,A=Math.min(c,O*.5);E={x:u.x+T/O*A,y:u.y+y/O*A}}if(l===o){let T=f.x-u.x,y=f.y-u.y,O=Math.hypot(T,y)||1,A=Math.min(c,O*.5);x={x:f.x-T/O*A,y:f.y-y/O*A}}n.push({c1:E,c2:x,to:{x:f.x,y:f.y}})}return{start:r[1],segs:n}}pathFromSegments(e){let r=`M${e.start.x},${e.start.y}`;for(let n of e.segs)r+=` C${n.c1.x},${n.c1.y} ${n.c2.x},${n.c2.y} ${n.to.x},${n.to.y}`;return r}trimSegmentsEnd(e,r){let n=e.segs.slice();if(!n.length)return e;let i={...n[n.length-1]},o=i.to.x-i.c2.x,s=i.to.y-i.c2.y,a=Math.hypot(o,s)||1,c=Math.max(.1,Math.min(r,Math.max(0,a-.2))),l=o/a,h=s/a,u={x:i.to.x-l*c,y:i.to.y-h*c};return i.to=u,n[n.length-1]=i,{start:e.start,segs:n}}trimSegmentsStart(e,r){let n=e.segs.slice();if(!n.length)return e;let i={...n[0]},o=i.c1.x-e.start.x,s=i.c1.y-e.start.y,a=Math.hypot(o,s)||1,c=Math.max(.1,Math.min(r,Math.max(0,a-.2))),l=o/a,h=s/a;return{start:{x:e.start.x+l*c,y:e.start.y+h*c},segs:n}}intersectSegmentsEnd(e,r){if(!e.segs.length)return e;let n=e.segs[e.segs.length-1],i=n.c2,o=n.to,s=this.intersectLineWithNode(i,o,r);if(s){let a=e.segs.slice();return a[a.length-1]={...n,to:s},{start:e.start,segs:a}}return e}intersectSegmentsStart(e,r){if(!e.segs.length)return e;let n=e.segs[0],i=e.start,o=n.c1,s=this.intersectLineWithNode(i,o,r);return s?{start:s,segs:e.segs}:e}intersectLineWithNode(e,r,n){let i=n.shape,o=()=>[{x:n.x,y:n.y},{x:n.x+n.width,y:n.y},{x:n.x+n.width,y:n.y+n.height},{x:n.x,y:n.y+n.height}];switch(i){case"circle":{let s=n.x+n.width/2,a=n.y+n.height/2,c=Math.min(n.width,n.height)/2;return this.lineCircleIntersection(e,r,{cx:s,cy:a,r:c})}case"diamond":{let s=n.x+n.width/2,a=n.y+n.height/2,c=[{x:s,y:n.y},{x:n.x+n.width,y:a},{x:s,y:n.y+n.height},{x:n.x,y:a}];return this.linePolygonIntersection(e,r,c)}case"hexagon":{let s=Math.max(10,n.width*.2),a=[{x:n.x+s,y:n.y},{x:n.x+n.width-s,y:n.y},{x:n.x+n.width,y:n.y+n.height/2},{x:n.x+n.width-s,y:n.y+n.height},{x:n.x+s,y:n.y+n.height},{x:n.x,y:n.y+n.height/2}];return this.linePolygonIntersection(e,r,a)}case"parallelogram":{let s=Math.min(n.width*.25,n.height*.6),a=[{x:n.x+s,y:n.y},{x:n.x+n.width,y:n.y},{x:n.x+n.width-s,y:n.y+n.height},{x:n.x,y:n.y+n.height}];return this.linePolygonIntersection(e,r,a)}case"trapezoid":{let s=Math.min(n.width*.2,n.height*.5),a=[{x:n.x+s,y:n.y},{x:n.x+n.width-s,y:n.y},{x:n.x+n.width,y:n.y+n.height},{x:n.x,y:n.y+n.height}];return this.linePolygonIntersection(e,r,a)}case"trapezoidAlt":{let s=Math.min(n.width*.2,n.height*.5),a=[{x:n.x,y:n.y},{x:n.x+n.width,y:n.y},{x:n.x+n.width-s,y:n.y+n.height},{x:n.x+s,y:n.y+n.height}];return this.linePolygonIntersection(e,r,a)}case"stadium":{let s=Math.min(n.height/2,n.width/2),a=[{x:n.x+s,y:n.y},{x:n.x+n.width-s,y:n.y},{x:n.x+n.width-s,y:n.y+n.height},{x:n.x+s,y:n.y+n.height}],c=this.linePolygonIntersection(e,r,a);if(c)return c;let l=this.lineCircleIntersection(e,r,{cx:n.x+s,cy:n.y+n.height/2,r:s}),h=this.lineCircleIntersection(e,r,{cx:n.x+n.width-s,cy:n.y+n.height/2,r:s});return((...f)=>{let m=null,p=-1/0;for(let g of f)if(g){let E=-((g.x-r.x)**2+(g.y-r.y)**2);E>p&&(p=E,m=g)}return m})(l,h)}default:return this.linePolygonIntersection(e,r,o())}}lineCircleIntersection(e,r,n){let i=r.x-e.x,o=r.y-e.y,s=e.x-n.cx,a=e.y-n.cy,c=i*i+o*o,l=2*(s*i+a*o),h=s*s+a*a-n.r*n.r,u=l*l-4*c*h;if(u<0)return null;let f=Math.sqrt(u),m=(-l-f)/(2*c),p=(-l+f)/(2*c),g=[m,p].filter(x=>x>=0&&x<=1);if(!g.length)return null;let E=Math.max(...g);return{x:e.x+i*E,y:e.y+o*E}}linePolygonIntersection(e,r,n){let i=-1/0,o=null;for(let s=0;s<n.length;s++){let a=n[s],c=n[(s+1)%n.length],l=this.segmentIntersection(e,r,a,c);l&&l.t>=0&&l.t<=1&&l.u>=0&&l.u<=1&&l.t>i&&(i=l.t,o={x:l.x,y:l.y})}return o}segmentIntersection(e,r,n,i){let o={x:r.x-e.x,y:r.y-e.y},s={x:i.x-n.x,y:i.y-n.y},a=o.x*s.y-o.y*s.x;if(Math.abs(a)<1e-6)return null;let c={x:n.x-e.x,y:n.y-e.y},l=(c.x*s.y-c.y*s.x)/a,h=(c.x*o.y-c.y*o.x)/a,u=e.x+l*o.x,f=e.y+l*o.y;return{x:u,y:f,t:l,u:h}}pointAtRatio(e,r){let n=Math.max(0,Math.min(1,r)),i=0,o=[];for(let a=0;a<e.length-1;a++){let c=e[a+1].x-e[a].x,l=e[a+1].y-e[a].y,h=Math.hypot(c,l);o.push(h),i+=h}if(i===0)return e[Math.floor(e.length/2)];let s=i*n;for(let a=0;a<o.length;a++){if(s<=o[a]){let c=o[a]===0?0:s/o[a];return{x:e[a].x+(e[a+1].x-e[a].x)*c,y:e[a].y+(e[a+1].y-e[a].y)*c}}s-=o[a]}return e[e.length-1]}escapeXml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};function HC(t){if(!t)return t;let e=t.charAt(0),r=t.charAt(t.length-1);return e==='"'&&r==='"'||e==="'"&&r==="'"?t.slice(1,-1).replace(/\\(["'])/g,"$1"):t}function zC(t){let e=[],r=Ca(t);for(let s of r.errors)e.push({line:s.line??1,column:s.column??1,message:s.message,code:"PIE_LEX",severity:"error"});er.reset(),er.input=r.tokens;let n=er.diagram();for(let s of er.errors){let a=s.token;e.push({line:a?.startLine??1,column:a?.startColumn??1,message:s.message,code:"PIE_PARSE",severity:"error"})}let i={title:void 0,showData:!1,slices:[]};if(!n||!n.children)return{model:i,errors:e};n.children.ShowDataKeyword&&n.children.ShowDataKeyword.length>0&&(i.showData=!0);let o=n.children.statement??[];for(let s of o)if(s.children?.titleStmt){let a=s.children.titleStmt[0],c=[],l=u=>{let f=a.children?.[u]??[];for(let m of f)c.push(HC(m.image))};l("QuotedString"),l("Text"),l("NumberLiteral");let h=c.join(" ").trim();h&&(i.title=h)}else if(s.children?.sliceStmt){let a=s.children.sliceStmt[0],c=a.children?.sliceLabel?.[0]?.children?.QuotedString?.[0],l=a.children?.NumberLiteral?.[0];if(c&&l){let h=HC(c.image).trim(),u=Number(l.image);Number.isNaN(u)||i.slices.push({label:h,value:u})}}return{model:i,errors:e}}function Kl(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/'/g,"&apos;")}function ed(t,e=12){let r=.6*e;return Math.max(0,Math.round(t.length*r))}var Jf=["#ECECFF","#ffffde","hsl(80, 100%, 56.2745098039%)","hsl(240, 100%, 86.2745098039%)","hsl(60, 100%, 63.5294117647%)","hsl(80, 100%, 76.2745098039%)","hsl(300, 100%, 76.2745098039%)","hsl(180, 100%, 56.2745098039%)","hsl(0, 100%, 56.2745098039%)","hsl(300, 100%, 56.2745098039%)","hsl(150, 100%, 56.2745098039%)","hsl(0, 100%, 66.2745098039%)"];function td(t){return t<Jf.length?Jf[t]:`hsl(${(t-Jf.length)*47%360} 60% 55%)`}function rd(t){return Number.isInteger(t)?String(t):(Math.round(t*100)/100).toString()}function VC(t,e){if(!(e>0))return"0%";let r=t/e*100;return`${Math.round(r)}%`}function Gl(t,e,r,n){return{x:t+r*Math.cos(n),y:e+r*Math.sin(n)}}function YC(t,e={}){let r=Math.max(320,Math.floor(e.width??640)),n=Math.max(240,Math.floor(e.height??400)),i=24,o=t.title?28:0,s=r/2,a=(n+o)/2+(t.title?8:0),c=Math.max(40,Math.min(r,n-o)/2-i),l=t.slices.filter(b=>Math.max(0,b.value)>0),h=l.reduce((b,v)=>b+Math.max(0,v.value),0),u=12,f=8,m=18,p=l.map(b=>`${b.label}${t.showData?` ${rd(Number(b.value))}`:""}`),g=p.length?Math.max(...p.map(b=>ed(b,12))):0,E=p.length?u+f+g+i:0;if(p.length){let b=i+c*2+E+i;b>r&&(r=Math.ceil(b))}let x=c;p.length&&(s=Math.max(i,(r-E-x*2)/2)+x);let T=-Math.PI/2,y=`<svg xmlns="http://www.w3.org/2000/svg" width="${r}" height="${n}" viewBox="0 0 ${r} ${n}">`;y+=`
  <style>
    .pie-title { font-family: Arial, sans-serif; font-size: 16px; font-weight: 600; fill: #222; }
    .slice-label { font-family: Arial, sans-serif; font-size: 12px; fill: #222; dominant-baseline: middle; }
    .leader { stroke: #444; stroke-width: 1; fill: none; }
    .pieCircle { stroke: black; stroke-width: 2px; opacity: 0.7; }
    .pieOuterCircle { stroke: black; stroke-width: 2px; fill: none; }
  </style>`,t.title&&(y+=`
  <text class="pie-title" x="${s}" y="${i+8}" text-anchor="middle">${Kl(t.title)}</text>`),y+=`
  <g class="pie" aria-label="pie">`;let O=.35;l.forEach((b,v)=>{let P=h>0?Math.max(0,b.value)/h:0,M=2*Math.PI*P,k=T+M,U=M>Math.PI?1:0,w=Gl(s,a,x,T),V=Gl(s,a,x,k),X=[`M ${s} ${a}`,`L ${w.x.toFixed(2)} ${w.y.toFixed(2)}`,`A ${x} ${x} 0 ${U} 1 ${V.x.toFixed(2)} ${V.y.toFixed(2)}`,"Z"].join(" "),re=b.color||td(v);y+=`
    <path d="${X}" class="pieCircle" fill="${re}" />`;let j=(T+k)/2,Z=Math.cos(j),_t=Math.sin(j),Ue=Kl(VC(b.value,h));if(M<O){let Pe=x*.9,He=x*1.06,Ft=Gl(s,a,Pe,j),Ot=Gl(s,a,He,j),Xe=12,Bt=Z<0,ve=Bt?Ot.x-Xe:Ot.x+Xe,q=Ot.y;y+=`
    <path class="leader" d="M ${Ft.x.toFixed(2)} ${Ft.y.toFixed(2)} L ${Ot.x.toFixed(2)} ${Ot.y.toFixed(2)} L ${ve.toFixed(2)} ${q.toFixed(2)}" />`;let W=Bt?ve-2:ve+2,ne=Bt?"end":"start";y+=`
    <text class="slice-label" x="${W.toFixed(2)}" y="${q.toFixed(2)}" text-anchor="${ne}">${Ue}</text>`}else{let Pe=x*.62,He={x:s+Pe*Z,y:a+Pe*_t},Ft=Math.abs(Z)<.2?"middle":Z>0?"start":"end",Ot=Pe,Bt=ed(Ue,12)>Ot*1.2?"middle":Ft;y+=`
    <text class="slice-label" x="${He.x.toFixed(2)}" y="${He.y.toFixed(2)}" text-anchor="${Bt}">${Ue}</text>`}T=k});let A=e.rimStroke||"black",L=e.rimStrokeWidth!=null?String(e.rimStrokeWidth):"2px";if(y+=`
  </g>
  <circle class="pie-rim pieOuterCircle" cx="${s}" cy="${a}" r="${x}" stroke="${A}" stroke-width="${L}" fill="none" />`,p.length){let b=s+x+i/2,v=p.length*m,P=a-v/2+10;y+=`
  <g class="legend">`,l.forEach((M,k)=>{let U=P+k*m,w=M.color||td(k),V=Kl(`${M.label}${t.showData?` ${rd(Number(M.value))}`:""}`);y+=`
    <rect x="${b}" y="${U-u+6}" width="${u}" height="${u}" fill="${w}" stroke="${w}" stroke-width="1" />`,y+=`
    <text class="slice-label legend-text" x="${b+u+f}" y="${U}" text-anchor="start">${V}</text>`}),y+=`
  </g>`}return y+=`
</svg>`,y}function QC(t){let r=(t.startsWith("\uFEFF")?t.slice(1):t).split(/\r?\n/);if(r.length<3||r[0].trim()!=="---")return null;let n=1,i=[];for(;n<r.length&&r[n].trim()!=="---";)i.push(r[n]),n++;if(n>=r.length)return null;let o=r.slice(n+1).join(`
`),s=i.join(`
`),a={},c={},l=!1,h="root";for(let u of i){if(!u.trim())continue;let f=u.match(/^\s*/)?.[0].length??0,m=u.match(/^\s*([A-Za-z0-9_\-]+):\s*(.*)$/);if(!m)continue;let p=m[1],g=m[2]||"";if(f===0){if(p==="config"){h="config";continue}if(p==="themeVariables"){h="theme";continue}h="root";continue}if(h==="config"){if(f<=2&&p!=="pie"&&p!=="themeVariables")continue;if(p==="pie"){h="config.pie",nd(a,"pie",{});continue}if(p==="themeVariables"){h="theme",l=!0;continue}continue}if(h==="config.pie"){if(f<4){if(p==="pie"){h="config.pie",nd(a,"pie",{});continue}if(p==="themeVariables"){h="theme",l=!0;continue}h="config";continue}XC(a.pie,p,g);continue}if(h==="theme"){if(f<2){h="root";continue}XC(c,p,g);continue}}return l&&Object.keys(c).length&&(nd(a,"themeVariables",{}),Object.assign(a.themeVariables,c)),{raw:s,body:o,config:Object.keys(a).length?a:void 0,themeVariables:Object.keys(c).length?c:void 0}}function nd(t,e,r){t[e]==null&&(t[e]=r)}function P8(t){let e=t.trim();return e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1):e}function XC(t,e,r){let n=P8(r);if(n===""){t[e]="";return}let i=Number(n);if(!Number.isNaN(i)&&/^-?[0-9]+(\.[0-9]+)?$/.test(n)){t[e]=i;return}if(/^(true|false)$/i.test(n)){t[e]=/^true$/i.test(n);return}t[e]=n}var jl=class{constructor(e,r){this.graphBuilder=new ul,this.layoutEngine=e||new Yo,this.renderer=r||new Xo}render(e,r={}){let n=[],i=r.layoutEngine||this.layoutEngine,o=r.renderer||this.renderer;try{let s=ba(e);if(s.errors&&s.errors.length>0)for(let u of s.errors)n.push({line:u.line||1,column:u.column||1,message:u.message,severity:"error",code:"LEXER_ERROR"});Ct.reset(),Ct.input=s.tokens;let a=Ct.diagram();if(Ct.errors&&Ct.errors.length>0)for(let u of Ct.errors){let f=u.token;n.push({line:f?.startLine||1,column:f?.startColumn||1,message:u.message,severity:"error",code:"PARSER_ERROR"})}let c=this.graphBuilder.build(a),l;try{l=i.layout(c)}catch(u){return n.push({line:1,column:1,message:u.message||"Layout calculation failed",severity:"error",code:"LAYOUT_ERROR"}),{svg:this.generateErrorSvg(u.message||"Layout calculation failed"),graph:c,errors:n}}let h=o.render(l);return r.showErrors&&n.length>0&&(h=this.addErrorOverlays(h,n)),{svg:h,graph:c,errors:n}}catch(s){let a=this.generateErrorSvg(s.message||"Unknown error occurred");return n.push({line:1,column:1,message:s.message||"Unknown error occurred",severity:"error",code:"RENDER_ERROR"}),{svg:a,graph:{nodes:[],edges:[],direction:"TD"},errors:n}}}renderAny(e,r={}){let n=e,i;if(e.trimStart().startsWith("---")){let a=QC(e);a&&(n=a.body,i=a.themeVariables||a.config&&a.config.themeVariables||void 0)}let o=n.trim().split(`
`)[0];if(/^(flowchart|graph)\s+/i.test(o)){let a=this.render(n,r);return{svg:i?D8(a.svg,i):a.svg,graph:a.graph,errors:a.errors}}if(/^pie\b/i.test(o))try{let{model:a,errors:c}=zC(n),l=YC(a,{width:r.width,height:r.height,rimStroke:i?.pieStrokeColor,rimStrokeWidth:i?.pieOuterStrokeWidth});return{svg:q8(l,i),graph:{nodes:[],edges:[],direction:"TD"},errors:c}}catch(a){let c=a?.message||"Pie render error",l=[{line:1,column:1,message:c,severity:"error",code:"PIE_RENDER"}];return{svg:this.generateErrorSvg(c),graph:{nodes:[],edges:[],direction:"TD"},errors:l}}return{svg:this.generateErrorSvg("Unsupported diagram type. Rendering supports flowchart and pie for now."),graph:{nodes:[],edges:[],direction:"TD"},errors:[{line:1,column:1,message:"Unsupported diagram type",severity:"error",code:"UNSUPPORTED_TYPE"}]}}addErrorOverlays(e,r){let n=`
    <style>
      .error-indicator {
        fill: #ff0000;
        opacity: 0.8;
      }
      .error-text {
        fill: white;
        font-family: Arial, sans-serif;
        font-size: 12px;
        font-weight: bold;
      }
    </style>`,i=`
    <g id="errors">
      <rect x="5" y="5" width="100" height="25" rx="3" class="error-indicator" />
      <text x="55" y="20" text-anchor="middle" class="error-text">${r.length} error${r.length!==1?"s":""}</text>
    </g>`;return e.replace("</svg>",`${n}${i}</svg>`)}generateErrorSvg(e){return`<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200">
  <rect width="400" height="200" fill="#fee" stroke="#c00" stroke-width="2" />
  <text x="${400/2}" y="${200/2-20}" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#c00">
    Render Error
  </text>
  <text x="${400/2}" y="${200/2+10}" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#666">
    ${this.wrapText(e,40).map((i,o)=>`<tspan x="${400/2}" dy="${o===0?0:15}">${this.escapeXml(i)}</tspan>`).join("")}
  </text>
</svg>`}wrapText(e,r){let n=e.split(" "),i=[],o="";for(let s of n)o.length+s.length+1<=r?o+=(o?" ":"")+s:(o&&i.push(o),o=s);return o&&i.push(o),i.slice(0,3)}escapeXml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};function q8(t,e){if(!e)return t;let r=t;if((e.pieOuterStrokeWidth!=null||e.pieStrokeColor)&&(r=r.replace(/\.pieOuterCircle\s*\{[^}]*\}/,i=>{let o=i;return e.pieStrokeColor&&(o=o.replace(/stroke:\s*[^;]+;/,`stroke: ${String(e.pieStrokeColor)};`)),e.pieOuterStrokeWidth!=null&&(o=o.replace(/stroke-width:\s*[^;]+;/,`stroke-width: ${String(e.pieOuterStrokeWidth)};`)),o}),e.pieStrokeColor&&(r=r.replace(/\.pieCircle\s*\{[^}]*\}/,i=>i.replace(/stroke:\s*[^;]+;/,`stroke: ${String(e.pieStrokeColor)};`)))),e.pieSectionTextColor){let i=String(e.pieSectionTextColor);r=r.replace(/\.slice-label \{[^}]*\}/,o=>o.replace(/fill:\s*#[0-9A-Fa-f]{3,8}|fill:\s*rgb\([^)]*\)/,`fill: ${i}`)),r=r.replace(/<text class="slice-label"([^>]*)>/g,`<text class="slice-label"$1 fill="${i}">`)}if(e.pieTitleTextColor){let i=String(e.pieTitleTextColor);r=r.replace(/<text class="pie-title"([^>]*)>/g,`<text class="pie-title"$1 fill="${i}">`)}if(e.pieSectionTextSize){let i=String(e.pieSectionTextSize);r=r.replace(/<text class="slice-label"([^>]*)>/g,`<text class="slice-label"$1 font-size="${i}">`)}if(e.pieTitleTextSize){let i=String(e.pieTitleTextSize);r=r.replace(/<text class="pie-title"([^>]*)>/g,`<text class="pie-title"$1 font-size="${i}">`)}let n=[];for(let i=1;i<=24;i++){let o="pie"+i;e[o]&&n.push(String(e[o]))}if(n.length){let i=0;r=r.replace(/<path[^>]*class="pieCircle"[^>]*\sfill="([^"]+)"/g,o=>{let s=n[i]??null;return i++,s?o.replace(/fill="([^"]+)"/,`fill="${s}"`):o})}return r}function D8(t,e){if(!e)return t;let r=t;return(e.nodeBkg||e.nodeBorder)&&(r=r.replace(/\.node-shape\s*\{[^}]*\}/,n=>{let i=n;return e.nodeBkg&&(i=i.replace(/fill:\s*[^;]+;/,`fill: ${String(e.nodeBkg)};`)),e.nodeBorder&&(i=i.replace(/stroke:\s*[^;]+;/,`stroke: ${String(e.nodeBorder)};`)),i})),e.nodeTextColor&&(r=r.replace(/\.node-label\s*\{[^}]*\}/,n=>n.replace(/fill:\s*[^;]+;/,`fill: ${String(e.nodeTextColor)};`))),e.lineColor&&(r=r.replace(/\.edge-path\s*\{[^}]*\}/,n=>n.replace(/stroke:\s*[^;]+;/,`stroke: ${String(e.lineColor)};`))),e.arrowheadColor&&(r=r.replace(/(<path d="M0,0 L0,[0-9.]+ L[0-9.]+,[0-9.]+ z"[^>]*)(fill="[^"]*")/g,(n,i)=>`${i}fill="${String(e.arrowheadColor)}"`),r=r.replace(/(<circle cx="4\.5" cy="4\.5" r="4\.5"[^>]*)(fill="[^"]*")/g,(n,i)=>`${i}fill="${String(e.arrowheadColor)}"`)),e.clusterBkg&&(r=r.replace(/\.cluster-bg\s*\{[^}]*\}/,n=>n.replace(/fill:\s*[^;]+;/,`fill: ${String(e.clusterBkg)};`))),e.clusterBorder&&(r=r.replace(/\.cluster-border\s*\{[^}]*\}/,n=>n.replace(/stroke:\s*[^;]+;/,`stroke: ${String(e.clusterBorder)};`))),e.clusterTextColor&&(r=r.replace(/\.cluster-label-text\s*\{[^}]*\}/,n=>n.replace(/fill:\s*[^;]+;/,`fill: ${String(e.clusterTextColor)};`))),e.fontFamily&&(r=r.replace(/\.node-label\s*\{[^}]*\}/,n=>n.replace(/font-family:\s*[^;]+;/,`font-family: ${String(e.fontFamily)};`))),e.fontSize&&(r=r.replace(/\.node-label\s*\{[^}]*\}/,n=>n.replace(/font-size:\s*[^;]+;/,`font-size: ${String(e.fontSize)};`))),r}function Wl(t,e={}){return new jl(e.layoutEngine,e.renderer).renderAny(t,e)}function ZC(){return{initialize(t){},async render(t,e,r){try{return{svg:Wl(e,r).svg}}catch(n){throw new Error(`Maid render failed: ${n.message||"Unknown error"}`)}},renderSync(t,e,r){try{return{svg:Wl(e,r).svg}}catch(n){throw new Error(`Maid render failed: ${n.message||"Unknown error"}`)}}}}var Xxe=ZC();function tEe(t,e={}){let{strict:r=!1,level:n="safe"}=e,i=t;for(let s=0;s<5;s++){let a=cl(i,{strict:r}),c=Ah(i,a.errors,n);if(c.length===0)return{fixed:i,errors:a.errors};let l=Oh(i,c);if(l===i)return{fixed:i,errors:a.errors};i=l}let o=cl(i,{strict:r});return{fixed:i,errors:o.errors}}export{jl as MermaidRenderer,Oh as applyEdits,Ah as computeFixes,ZC as createMermaidAPI,Hx as detectDiagramType,tEe as fixText,Wl as renderMermaid,cl as validate};
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
